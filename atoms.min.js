// License: https://github.com/neurospeech/atoms.js/blob/master/License.md
function mapLibrary(n,m,f){var t=n.indexOf(".");if(-1==t){var s=m[n];s||(s=f,m[n]=s);return s}s=mapLibrary(n.substr(0,t),m,{});return mapLibrary(n.substr(t+1),s,f)}function createProperty(n,m){return m?function(){return this[n]}:function(f){this[n]=f}}
function classCreator(n,m,f,t,s,C,E){var A=m?m.constructor:null,p=f||function(){};m=null;if(A){m=s?function(){for(var f in s)this["_"+f]=s[f];A.apply(this,arguments);this.__typeName=n;p.apply(this,arguments)}:function(){A.apply(this,arguments);this.__typeName=n;p.apply(this,arguments)};f=A.prototype;for(var q in f)t[q]||f.hasOwnProperty(q)&&(t[q]=f[q])}else m=s?function(){this.__typeName=n;for(var f in s)this["_"+f]=s[f];p.apply(this,arguments)}:function(){this.__typeName=n;p.apply(this,arguments)};
if(s)for(q in s)t["get_"+q]||(t["get_"+q]=createProperty("_"+q,!0)),t["set_"+q]||(t["set_"+q]=createProperty("_"+q));m.__typeName=n;A&&(m.__baseType=A);m.prototype=t;m.prototype.constructor=m;t.hasOwnProperty("toString")||(m.prototype.toString=function(){return n});mapLibrary(/\./.test(n)?n:"WebAtoms."+n,window,m);return m}function classCreatorEx(n){return classCreator(n.name,n.base,n.start,n.methods,n.properties)}var createClass=classCreatorEx,WebAtoms={};
(function(n){var m=this,f=m.$,t={jsonML:{}},s=m.document;m.Templates=t;t.jsonML["WebAtoms.AtomAutoCompleteBox.template"]=[["input",{"atom-presenter":"selectionBox",disabled:"disabled",type:"text","style-display":"[$owner.isPopupOpen ? '' : 'none']","atom-value":"[$owner.selectedText]"}],["input",{"atom-presenter":"inputBox","atom-placeholder":"[$owner.placeholder]",type:"text","atom-value":"$[owner.displayLabel](keyup)"}],["div",{"atom-presenter":"itemsPresenter","class":"atom-list-box",style:"position: absolute; z-index: 100;",
"style-left":"[($owner.offsetLeft + 2) + 'px']","style-top":"[($owner.offsetTop + 24) + 'px']","style-display":"[$owner.isPopupOpen ? 'block' : 'none']"},["div",{"atom-template":"itemTemplate",style:"min-width:100px;","atom-text":"{ $data[$owner.templateParent.labelPath] }"}]]];t.jsonML["WebAtoms.AtomCalendar.template"]=[["div",{},["div",{"class":"title"},["button",{"class":"atom-prev-button","atom-event-click":"{$owner.templateParent.prevMonthCommand}"},"Previous"],["span",{"atom-text":"[ AtomDate.monthList[$owner.templateParent.currentMonth-1].label + ' ' + $owner.templateParent.currentYear]"}],
["button",{"class":"atom-next-button","atom-event-click":"{$owner.templateParent.nextMonthCommand}"},"Next"]],["div",{"class":"day-headers"},["span",{"class":"weekend"},"Sunday"],["span",{},"Monday"],["span",{},"Tuesday"],["span",{},"Wednesday"],["span",{},"Thursday"],["span",{},"Friday"],["span",{"class":"weekend"},"Saturday"]],["div",{"class":"days","atom-presenter":"itemsPresenter"}]]];t.jsonML["WebAtoms.AtomCheckBoxList.itemTemplate"]=[["div",{"atom-template":"itemTemplate"},["input",{type:"checkbox",
"atom-checked":"$[scope.itemSelected]"}],["span",{"atom-text":"{$data[$owner.templateParent.labelPath]}"}]]];t.jsonML["WebAtoms.AtomDataPager.template"]=[["button",{"class":"atom-pager-first-button","atom-is-enabled":"[$owner.pages.length > 1 && $owner.currentPage]","event-click":"{$owner.goFirstCommand}",style:"float:left"},"\nFirst\n"],["span",{style:"text-align:left"},["button",{"class":"atom-pager-prev-button","event-click":"{$owner.goPrevCommand}","atom-is-enabled":"[$owner.currentPage]"},"\nPrev\n"],
["span",{},"Goto: Page"],["select",{"atom-type":"AtomComboBox","atom-items":"[$owner.atomParent.pages]","atom-value":"$[owner.atomParent.currentPage]"}],["button",{"class":"atom-pager-next-button","event-click":"{$owner.goNextCommand}","atom-is-enabled":"[$owner.currentPage < $owner.pages.length -1 ]"},"\nNext\n"]],["button",{"class":"atom-pager-last-button","event-click":"{$owner.goLastCommand}","atom-is-enabled":"[$owner.pages.length > 1 && $owner.currentPage < $owner.pages.length -1 ]",style:"float:right"},
"\nLast\n"]];t.jsonML["WebAtoms.AtomDateField.popupTemplate"]=[["div",{"class":"atom-date-field-popup","style-left":"[($owner.offsetLeft ) + 'px']","style-top":"[($owner.offsetTop + 25) + 'px']"},["div",{"class":"atom-date-list-box","atom-class":"[$owner.isOpen ? 'popup-open' : 'popup-closed' ]"},["div",{"class":"calendar","atom-presenter":"calendarPresenter"},["select",{"atom-type":"AtomComboBox","class":"month","atom-items":"{AtomDate.monthList}","atom-value":"$[owner.templateParent.month]"}],["select",
{"atom-type":"AtomNumberComboBox","class":"year","atom-start-number":"[ $owner.templateParent.currentYear + $owner.templateParent.startYear]","atom-end-number":"[ $owner.templateParent.currentYear + $owner.templateParent.endYear]","atom-value":"$[owner.templateParent.year]"}],["div",{"class":"days"},["span",{"class":"weekend-header"},"S"],["span",{},"M"],["span",{},"T"],["span",{},"W"],["span",{},"T"],["span",{},"F"],["span",{"class":"weekend-header"},"S"]],["div",{"class":"day-list","atom-type":"AtomItemsControl",
"atom-items":"[$owner.templateParent.items]","atom-presenter":"itemsPresenter"},["div",{"atom-event-click":"{ $owner.templateParent.templateParent.toggleDateCommand }","atom-class":"[ { 'list-item':true, 'weekend': $data.isWeekEnd, other: $data.isOtherMonth, today: $data.isToday, 'selected': Atom.query($owner.templateParent.templateParent.selectedItems).any({ value: $data.value}) } ]","atom-template":"itemTemplate"},["span",{"atom-text":"[$data.label]"}]]]]]]];t.jsonML["WebAtoms.AtomDateField.template"]=
[["div",{"class":"date-label","atom-class":"[$owner.isOpen ? 'date-label-open' : 'date-label-closed']","atom-event-click":"[ { owner: { isOpen: ! $owner.isOpen } } ]","atom-text":"[ $owner.selectedItem ? $owner.selectedItem.dateLabel : 'SELECT' ]"}]];t.jsonML["WebAtoms.AtomDateListBox.template"]=[["div",{"class":"atom-date-list-box"},["div",{"class":"calendar"},["select",{"atom-type":"AtomComboBox","class":"month","atom-items":"{AtomDate.monthList}","atom-value":"$[owner.templateParent.month]"}],
["select",{"atom-type":"AtomComboBox","class":"year","atom-items":"[ Atom.range( $owner.value + $owner.templateParent.startYear, $owner.value + $owner.templateParent.endYear) ]","atom-value":"$[owner.templateParent.year]"}],["div",{"class":"days"},["span",{"class":"weekend-header"},"S"],["span",{},"M"],["span",{},"T"],["span",{},"W"],["span",{},"T"],["span",{},"F"],["span",{"class":"weekend-header"},"S"]],["div",{"class":"day-list","atom-presenter":"itemsPresenter"},["div",{"event-click":"{ $owner.templateParent.toggleDateCommand }",
"atom-data":"[$owner.templateParent.items[$scope.itemIndex]]","atom-class":"[ { 'list-item':true, 'weekend': $data.isWeekEnd, other: $data.isOtherMonth, today: $data.isToday, 'selected': Atom.query($owner.templateParent.selectedItems).any({ value: $data.value}) } ]","atom-template":"itemTemplate"},["span",{"atom-text":"[$data.label]"}]]]],["div",{"class":"list","atom-type":"AtomListBox","atom-items":"[$owner.templateParent.selectedItems]","atom-label-path":"dateLabel","atom-value-path":"date","atom-value":"$[$owner.templateParent.visibleDate]"},
["div",{"atom-template":"itemTemplate","atom-text":"{$data.dateLabel}"}]]]];t.jsonML["WebAtoms.AtomItemsControl.itemTemplate"]=[["span",{"atom-text":"[$data[$owner.atomParent.labelPath]]"},"Item"]];t.jsonML["WebAtoms.AtomLinkBar.itemTemplate"]=[["a",{"atom-href":"{$data[$owner.atomParent.valuePath]}","atom-target":"{$data[$owner.atomParent.targetPath]}","atom-class":"{$data[$owner.templateParent.itemsPath] ? (($data[$owner.templateParent.itemsPath]).length ? 'atom-link-bar-down-image' : '' ) : '' }"},
["span",{"atom-text":"{$data[$owner.atomParent.labelPath]}"}]]];t.jsonML["WebAtoms.AtomLinkBar.menuTemplate"]=[["div",{"class":"menu","atom-type":"AtomLinkBar","atom-items":"[$data[$owner.templateParent.itemsPath]]","atom-menu-template":"{$owner.templateParent.menuTemplate}","atom-menu-direction":"vertical"},["div",{"atom-presenter":"itemsPresenter"},["div",{"atom-template":"itemTemplate"},["a",{"atom-href":"{$data[$owner.templateParent.valuePath]}","atom-text":"{$data[$owner.templateParent.labelPath]}",
"atom-target":"{$data.target}","atom-event-click":"{$data.action}"}]]]]];t.jsonML["WebAtoms.AtomNavigatorList.detailTemplate"]=[["iframe",{"class":"atom-navigator-list-iframe","atom-template":"detailTemplate","atom-src":"[$owner.templateParent.displayMode == 1 ?( $owner.templateParent.displayMode == 2 ? $owner.templateParent.newUrl : $owner.templateParent.detailUrl ): 'about:none']"}]];t.jsonML["WebAtoms.AtomNavigatorList.template"]=[["div",{"atom-type":"AtomViewStack","atom-selected-index":"[$owner.atomParent.displayMode]"},
["div",{"atom-type":"AtomDockPanel","atom-presenter":"gridPanel"},["div",{"atom-dock":"Fill","atom-presenter":"gridPresenter","class":"atom-navigator-list-grid"}]],["div",{"atom-data":"[$owner.templateParent.selectedItem]","atom-presenter":"detailView","atom-type":"AtomDockPanel"},["div",{"atom-dock":"Top","atom-presenter":"detailHeaderToolbar"},["input",{type:"button","event-click":"[$owner.templateParent.backCommand]",value:"Back",style:"float: left"}]]],["div",{"atom-data":"[$owner.templateParent.newItemCopy]",
"atom-presenter":"newView","atom-type":"AtomDockPanel"},["div",{"atom-dock":"Top","atom-presenter":"newHeaderToolbar"},["input",{type:"button","event-click":"[$owner.templateParent.cancelAddCommand]",value:"Back",style:"float: left"}]]]]];t.jsonML["WebAtoms.AtomSortableColumn.template"]=[["span",{"atom-text":"[$owner.label]"}]];t.jsonML["WebAtoms.AtomTabControl.template"]=[["div",{"atom-type":"AtomDockPanel"},["span",{"atom-dock":"Top","atom-type":"AtomToggleButtonBar","atom-label-path":"[$owner.templateParent.labelPath]",
"atom-items":"[$owner.templateParent.items]","atom-selected-index":"$[owner.templateParent.selectedIndex]",style:"height: 30px; text-align:center; display:inline-block"},["span",{"atom-template":"itemTemplate","atom-text":"[$data]"}]],["div",{"atom-dock":"Fill","atom-type":"AtomViewStack","atom-selected-index":"[$owner.templateParent.selectedIndex]","atom-presenter":"itemsPresenter"}]]];t.jsonML["WebAtoms.AtomToggleButtonBar.template"]=[["span",{"class":"items-presenter","atom-presenter":"itemsPresenter"}]];
t.jsonML["WebAtoms.AtomWizard.template"]=[["div",{"atom-dock":"Fill","atom-type":"AtomViewStack","atom-selected-index":"$[owner.templateParent.currentStep]","atom-presenter":"viewPresenter"}],["div",{"atom-dock":"Bottom","class":"atom-wizard-command-bar"},["button",{"class":"atom-wizard-back-button","atom-is-enabled":"[$owner.canMoveBack]","atom-event-click":"{$owner.goPrevCommand}","style-visibility":"[$owner.currentStep ? 'visible' : 'hidden']"},["span",{"atom-text":"[$owner.prevLabel]"}]],["button",
{"class":"atom-wizard-next-button","atom-class":"[$owner.nextClass || ($owner.isLastStep ? 'finish-button' : '')]","atom-event-click":"{$owner.nextCommand}","atom-is-enabled":"[$owner.nextCommand]"},["span",{"atom-text":"[$owner.isLastStep ? $owner.finishLabel : $owner.nextLabel]"}]]]];t.jsonML["WebAtoms.AtomYesNoCustom.template"]=[["span",{"atom-type":"AtomYesNoControl","atom-presenter":"yesNo","atom-value":"$[owner.templateParent.hasValue]"}],["input",{style:"vertical-align:top",type:"text","atom-is-enabled":"[$owner.hasValue]",
"atom-presenter":"input","atom-placeholder":"[$owner.placeholder]"}]];t.jsonML["WebAtoms.AtomApplication.busyTemplate"]=[["div",{style:"position:absolute;left:0px;top:0px;z-index:10000; display:none","style-width":"[$owner.appWidth + 'px']","style-height":"[$owner.appHeight + 'px']","style-display":"[$owner.isBusy ? 'block' : 'none']"},["div",{"class":"atom-busy-window",style:"position:absolute","style-left":"[(($owner.appWidth/2)-100) + 'px']","style-top":"[(($owner.appHeight/2)-25) + 'px']"},["div",
{"atom-abs-pos":"12,12,36,36","class":"atom-busy-image"}],["div",{"atom-abs-pos":"56,24,145,null","atom-text":"[$owner.busyMessage || 'Loading...']"}],["div",{"atom-abs-pos":"0,48",style:"height:3px; background-color:green","style-display":"[$owner.isBusy && $owner.progress ? 'block' : 'none']","style-width":"[$owner.progress + '%']"}]]]];t.jsonML["WebAtoms.AtomFormGridLayout.fieldTemplate"]=[["table",{"class":"atom-form-grid-row","atom-type":"AtomFormField","atom-class":"[$owner.fieldClass]","style-display":"[$owner.fieldVisible ? '' : 'none']"},
["tbody",{},["tr",{},["td",{"class":"atom-form-grid-label","atom-text":"[$owner.label]","style-min-width":"[$owner.atomParent.minLabelWidth ? ($owner.atomParent.minLabelWidth + 'px') : undefined]"}],["td",{"class":"atom-form-grid-required","atom-class":"[$owner.required ? 'atom-form-grid-required' : 'atom-form-grid-not-required']"},"*"],["td",{"class":"atom-form-grid-content","atom-class":"[$owner.error ? 'atom-data-error' : '']","atom-presenter":"contentPresenter"}],["td",{"atom-class":"[$owner.error ? 'atom-data-error' : '']",
"atom-text":"[$owner.error || '']","style-display":"[$owner.error ? '' : 'none']"}]]]]];t.jsonML["WebAtoms.AtomFormLayout.fieldTemplate"]=[["tr",{"atom-type":"AtomFormField","atom-class":"[$owner.fieldClass]","style-display":"[$owner.fieldVisible ? '' : 'none']"},["td",{"class":"atom-form-label","atom-text":"[$owner.label]","style-min-width":"[$owner.atomParent.minLabelWidth || undefined]"}],["td",{"class":"atom-form-required","atom-text":"[$owner.required ? '*' : '']"}],["td",{"class":"atom-form-content",
"atom-class":"[$owner.error ? 'atom-data-error' : '']","atom-presenter":"contentPresenter"},["span",{"class":"atom-form-error","atom-text":"[$owner.error || '']"}]]]];t.jsonML["WebAtoms.AtomFormVerticalLayout.fieldTemplate"]=[["tr",{"atom-type":"AtomFormField"},["td",{},["div",{},["span",{"class":"atom-form-label","atom-text":"[$owner.label]"}],["span",{"class":"atom-form-required","atom-text":"[$owner.required ? '*' : '']"}]],["div",{"class":"atom-form-content","atom-class":"[$owner.error ? 'atom-data-error' : '']",
"atom-presenter":"contentPresenter"}],["div",{"class":"atom-form-error","atom-text":"[$owner.error || '']"}]]]];t.jsonML["WebAtoms.AtomWindow.alertTemplate"]=[["div",{"class":"atom-alert","atom-dock":"Fill"},["pre",{"atom-text":"{$data.Message}"}],["div",{"class":"buttons","atom-class":"{ $data.Confirm ? 'confirm-buttons' : 'alert-buttons' }"},["button",{"class":"ok","atom-event-click":"{$owner.templateParent.closeCommand}"},"Ok"],["button",{"class":"yes","atom-event-click":"{ [ { data: { ConfirmValue: true } } , $owner.templateParent.closeCommand ] }"},
"Yes"],["button",{"class":"no","atom-event-click":"{$owner.templateParent.closeCommand}"},"No"]]]];t.jsonML["WebAtoms.AtomWindow.frameTemplate"]=[["div",{"class":"atom-window-background","style-width":"[$appScope.owner.bodyWidth + 'px']","style-height":"[$appScope.owner.appHeight + 'px']","style-display":"[$owner.isOpen ? 'block' : 'none']"},["div",{"class":"atom-window","atom-presenter":"windowDiv",style:"position:absolute","style-width":"[$owner.atomParent.windowWidth + 'px']","style-height":"[$owner.atomParent.windowHeight + 'px']",
"style-left":"[(($appScope.owner.bodyWidth-$owner.atomParent.windowWidth)/2) + 'px']","style-top":"[(($appScope.owner.bodyHeight-$owner.atomParent.windowHeight)/2) + 'px']","atom-type":"AtomDockPanel"},["div",{"class":"atom-window-title","atom-dock":"Top","atom-presenter":"windowTitleDiv","atom-text":"[$owner.atomParent.title]"}],["div",{"class":"atom-window-close-button","atom-presenter":"windowCloseButton","atom-event-click":"{$owner.atomParent.closeCommand}"}]]]];t.jsonML["WebAtoms.AtomWindow.windowTemplate"]=
[["iframe",{"class":"atom-window-frame","atom-presenter":"iframe","atom-src":"{$owner.templateParent.url}"}]];var C={debug:!1,baseUrl:"",log:"",ajax:{versionUrl:!0,versionKey:"__wav",version:(new Date).toDateString(),headers:{}}};m.AtomConfig=C;var E=function(a){m.console&&console.log(a);C.log+=a+"\r\n"};m.log=E;var A={browserName:"",version:"1.0",majorVersion:1,isMobile:!1,userAgent:"",detect:function(){var a=navigator.userAgent;this.userAgent=a;var c=navigator.appName,b=""+parseFloat(navigator.appVersion),
e=parseInt(navigator.appVersion,10),k,h;-1!=(k=a.indexOf("Opera"))?(c="Opera",b=a.substring(k+6),-1!=(k=a.indexOf("Version"))&&(b=a.substring(k+8))):-1!=(k=a.indexOf("MSIE"))?(c="Microsoft Internet Explorer",b=a.substring(k+5)):-1!=(k=a.indexOf("Chrome"))?(c="Chrome",b=a.substring(k+7)):-1!=(k=a.indexOf("Safari"))?(c="Safari",this.isMobile=-1!=a.indexOf("iPhone"),b=a.substring(k+7),-1!=(k=a.indexOf("Version"))&&(b=a.substring(k+8))):-1!=(k=a.indexOf("Firefox"))?(c="Firefox",b=a.substring(k+8)):(e=
a.lastIndexOf(" ")+1)<(k=a.lastIndexOf("/"))&&(c=a.substring(e,k),b=a.substring(k+1),c.toLowerCase()==c.toUpperCase()&&(c=navigator.appName));-1!=(h=b.indexOf(";"))&&(b=b.substring(0,h));-1!=(h=b.indexOf(" "))&&(b=b.substring(0,h));e=parseInt(""+b,10);isNaN(e)&&(parseFloat(navigator.appVersion),e=parseInt(navigator.appVersion,10));this.browserName=c;this.majorVersion=e;this.isMobile=/android|mobile|ios|iphone/gi.test(a)},isFF:!1,isChrome:!1,isIE:!1,isSafari:!1,isMac:!1,init:function(){this.isMac=
/mac os x/gi.test(this.userAgent)&&!/iphone|ipad/gi.test(this.userAgent);switch(this.browserName){case "Firefox":this.supportsUpload=4<=this.majorVersion;this.isFF=!0;break;case "Chrome":this.supportsUpload=6<=this.majorVersion;this.isChrome=!0;break;case "Microsoft Internet Explorer":this.supportsUpload=10<=this.majorVersion;this.isIE=!0;break;case "Safari":this.isSafari=!0,this.isMobile||(this.supportsUpload=5<=this.majorVersion)}this.supportsFlash=!this.isMobile}};m.AtomBrowser=A;A.detect();A.init();
var p=function(a,c){return classCreator(a,c,function(b){this._array=b;this.i=-1},{next:function(){this.i+=1;return this.i<this._array.length},current:function(){return this._array[this.i]},currentIndex:function(){return this.i},isFirst:function(){return 0==this.i},isLast:function(){return this.i==this._array.length-1},reset:function(){this.i=-1}})}("AtomEnumerator",null);m.AtomEnumerator=p;var q={refreshWindowCommand:function(){location.href=location.pathname+"?_v="+(new Date).getTime()+location.hash},
time:function(){return(new Date).getTime()},get:function(a,c){var b=c.indexOf(".");if(-1!=b){var e=c.substr(0,b);a=d.getValue(a,e);c=c.substr(b+1);return q.get(a,c)}return d.getValue(a,c)},set:function(a,c,b){var e=c.indexOf(".");if(-1!=e){var k=c.substr(0,e);a=d.getValue(a,k);c=c.substr(e+1);return q.set(a,c,b)}d.setValue(a,c,b)},csv:function(a,c,b){b||(b=", ");var e=[];for(a=new p(a);a.next();){var k=a.current();e.push(q.get(k,c))}return e.join(b)},range:function(a,c,b){var e=[];for(b=b||1;a<=c;a+=
b)e.push({label:a,value:a});return e},merge:function(a,c,b,e){if(a){c=e?d.getClone(c):c;if(b)for(var k in c)d.setValue(a,k,d.getValue(c,k));else for(k in c)a[k]=c[k];return a}},url:function(a,c,b){var e=[];if(c){for(var k in c)if(c.hasOwnProperty(k)){var h=c[k];void 0!==h&&null!==h&&(h&&h.constructor!=String&&"object"==typeof h&&(h=JSON.stringify(h)),e.push(k+"="+encodeURIComponent(h)))}e.length&&(a=-1==a.indexOf("?")?a+"?":a+"&");a+=e.join("&")}if(b){e=[];for(k in b)b.hasOwnProperty(k)&&(h=b[k],
void 0!==h&&null!==h&&e.push(k+"="+encodeURIComponent(h)));e.length&&(a+="#"+e.join("&"))}return a},encodeParameters:function(a){var c=[],b;for(b in a)if(0!=b.indexOf("_")){var e=a[b];if(void 0!==e&&null!==e){var k=typeof e;"string"!=k&&"number"!=k&&"boolean"!=k||c.push(b+"="+encodeURIComponent(e))}}return c.join("&")},tableLayout:function(a,c,b){return new n.AtomTableLayout(a,c,b)},toDash:function(a){return a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})},secureUrl:function(){for(var a=
"",c=0;c<arguments.length;c++){var b=arguments[c];if(null===b||void 0===b)return;a+=b}if(/^\/\//.test(a))return s.location.protocol+a;"https:"==s.location.protocol&&(a=a.replace(/http\:\/\//,"https://"));return a},resolve:function(a,c){var b=!c;if(!a)return a;b&&(c=new u,c.list=[],c.done=function(b){q.remove(c.list,b);0==c.list.length&&c.pushValue(a)});if("object"==typeof a)if("undefined"!=typeof a.length)for(var e=0;e<a.length;e++){var k=a[e];if(k){var h=a,g=e;k instanceof u||k.constructor==u?(c.list.push(k),
k.failed(function(b){c.done(b)}),k.then(function(b){h[g]=b.value();c.done(b)})):q.resolve(k,c)}}else for(e in a)if(k=a[e])k instanceof u||k.constructor==u?(c.list.push(k),k.failed(function(b){c.done(b)}),h=a,g=e,k.then(function(b){h[g]=b.value();c.done(b)})):q.resolve(k,c);if(c.list.length){if(b)c.onInvoke(function(){for(var b=new p(c.list);b.next();)b.current().invoke(c._invoker)});return c}return a}};m.Atom=q;(function(){for(var a,c=/\+/g,b=/([^&=]+)=?([^&]*)/g,e=m.location.search.substring(1),
k={};a=b.exec(e);)k[decodeURIComponent(a[1].replace(c," "))]=decodeURIComponent(a[2].replace(c," "));q.pageQuery=k})();var z={zoneOffset:6E4*(new Date).getTimezoneOffset(),toLocalTime:function(a){return a.toJSON()},m_names:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),setTime:function(a,c){if(!a||!c)return a;var b=c.split(":"),e=parseInt(b[0]),b=b[1].split(" "),k=parseInt(b[0]);"PM"==b[1]&&12!=e&&(e+=12);b=new Date(a.getFullYear(),a.getMonth(),a.getDate());b.setHours(e);b.setMinutes(k);
return b},toMMDDYY:function(a){var c=a.getMonth()+1,b=a.getFullYear();a=a.getDate();c=""+(9<c?c:"0"+c)+("/"+(9<a?a:"0"+a));return c+="/"+b},toShortDateString:function(a){if(!a)return"";if(a.constructor==String)if(/^\/date\(/gi.test(a))a=a.substr(6),a=new Date(parseInt(a,10));else throw Error("Invalid date format "+a);return this.m_names[a.getMonth()]+" "+a.getDate()+", "+a.getFullYear()},toDateTimeString:function(a){if(!a)return"";a.constructor==String&&(a=a.substr(6),a=new Date(parseInt(a,10)));
return z.toShortDateString(a)+" - "+z.toTimeString(a)},toTimeString:function(a){a=z.parse(a);if(!a)return"";var c=a.getHours(),b="AM";12==c?b="PM":12<c&&(c-=12,b="PM");a=a.getMinutes();10>a?a="0"+a:(a+="",1==a.length&&(a+="0"));return c+":"+a+" "+b},smartDate:function(a){if(!a)return null;a=z.parse(a);var c=new Date;if(c.getFullYear()===a.getFullYear()&&c.getMonth()===a.getMonth())switch(c.getDate()-a.getDate()){case -1:return"Tomorrow ("+z.toTimeString(a)+")";case 0:return"Today ("+z.toTimeString(a)+
")";case 1:return"Yesterday ("+z.toTimeString(a)+")"}return z.toDateTimeString(a)},smartDateUTC:function(a){return z.smartDate(a)},parse:function(a){if(!a)return null;if(a.constructor!==String)return a;if(/^\/date\([\-0-9]+\)\//gi.test(a))a=new Date(parseInt(a.substr(6),10));else{if(/^\/dateiso/gi.test(a)){a=a.substr(9);a=a.substr(0,a.length-1);var c=a.split("T");a=c[0];c=c[1];a=a.split("-");c=c.split(":");a=new Date(a[0],parseInt(a[1])-1,a[2],c[0],c[1],parseFloat(c[2]));return a=new Date(a.getTime()+
z.zoneOffset)}a=Date.parse(a)}return a}};m.AtomDate=z;z.monthList=[{label:"January",value:1},{label:"February",value:2},{label:"March",value:3},{label:"April",value:4},{label:"May",value:5},{label:"June",value:6},{label:"July",value:7},{label:"August",value:8},{label:"September",value:9},{label:"October",value:10},{label:"November",value:11},{label:"December",value:12}];m.AtomFileSize={toFileSize:function(a){if(!a)return"";a.constructor==String&&(a=parseInt(a,10));return 1073741824<a?Math.round(a/
1073741824)+" GB":1048576<a?Math.round(a/1048576)+" MB":1024<a?Math.round(a/1024)+" KB":a+" B"}};m.AtomPhone={toSmallPhoneString:function(a){if(!a)return"";var c=a.split(":",6);a=c[2];a="("+(/^\+/.test(a)?"":"+")+c[2]+") ";return(c=c[3])?a+c:""},toPhoneString:function(a){if(!a)return"";var c=a.split(":",6),b=c[3];a=c[4];var e=c[5];if(!b)return"";c="(+"+c[2]+") "+b;a&&(c+=" (ext: "+a+")");e&&(c+=" ("+e+")");return c}};var K={ecache:{},becache:{},parse:function(a){var c=this.becache[a];if(c)return c;
var b=[],e=[],c=a.replace(/(?:(\$)(window|appScope|scope|data|owner|localScope))(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*/gi,function(a){var c="v"+(b.length+1);a=0==a.indexOf("$owner.")?a.substr(7):0==a.indexOf("owner.")?a.substr(6):a.substr(1);b.push(a.split("."));e.push(c);return c}),k="return "+c+";",h=k;try{k=K.compile(e,k)}catch(g){throw q.alert("Error executing \n"+h+"\nOriginal: "+a),g;}c={length:e.length,method:k,path:b,original:c};return this.becache[a]=c},compile:function(a,c){var b=a.join("-")+":"+
c,e=this.ecache[b];if(e)return e;a.push("Atom");a.push("AtomPromise");e=new Function(a,c);return this.ecache[b]=e}};m.AtomEvaluator=K;var y=null;A.isIE&&9>A.majorVersion?(y=function(a){this.index=-1;this.nextItem=a.firstChild;this.findNext();this.item=null},y.prototype={findNext:function(){for(var a=this.nextItem;a&&1!==a.nodeType;)a=a.nextSibling;this.nextItem=a;this.index++},isFirst:function(){return 1===this.index},isLast:function(){return this.item&&!this.nextItem},next:function(){this.item=this.nextItem;
if(!this.item)return!1;this.nextItem=this.item.nextSibling;this.findNext();return this.item?!0:!1},current:function(){return this.item}}):(y=function(a){this.nextItem=a.firstElementChild;this.item=null;this.first=!0},y.prototype={isFirst:function(){return!this.item.previousElementSibling},isLast:function(){return this.item&&!this.nextItem},next:function(){this.item=this.nextItem;if(!this.item)return!1;this.nextItem=this.item.nextElementSibling;return this.item?!0:!1},current:function(){return this.item}});
m.ChildEnumerator=y;var I={stack:[],startOrder:2E3,show:function(a,c,b,e){c.style.zOrder=this.startOrder++;0==b&&(b=f(a).offset(),c.style.position="absolute",c.style.left=b.left+"px",c.style.top=b.top+f(a).outerHeight(!0)+"px");c.style.visibility="visible";this.stack.push({parent:a,element:c,removeHandler:e})},peek:function(){var a=null;0<this.stack.length&&(a=this.stack[this.stack.length-1]);return a},hide:function(a){var c=this.peek();c&&c.element===a&&(a.style.visibility="hidden",a=this.stack.pop(),
a.removeHandler&&a.removeHandler(a.element))},clicked:function(a){a=a.target;var c=I.peek();if(c){for(;a&&a!=c.element&&a!=c.parent;)a=a.parentNode;a!=c.element&&a!=c.parent&&(c.element.style.visibility="hidden",this.stack.pop(),c.removeHandler&&c.removeHandler(c.element))}}};m.AtomPopup=I;f(m).click(function(a){I.clicked(a)});var B={helpers:{any:function(a,c){return a?q.query(a).any(c):!1},between:function(a,c){if(!a&&!c)return!0;if(!c)return!1;var b=c[1];return c[0]<=a&&a<=b},"in":function(a,c){for(var b=
new p(c);b.next();)if(a==b.current())return!0;return!1},equals:function(a,c){return a?a.toLowerCase()==c.toLowerCase():c?!1:!0},contains:function(a,c){return a&&c?-1!=a.toLowerCase().indexOf(c.toLowerCase()):!1},startswith:function(a,c){return a&&c?0==a.toLowerCase().indexOf(c.toLowerCase()):!1},endswith:function(a,c){return a&&c?a.toLowerCase().lastIndexOf(c.toLowerCase())==a.length-c.length:!1},containscs:function(a,c){return a?-1!=a.indexOf(c):!1},startswithcs:function(a,c){return a?0==a.indexOf(c):
!1},endswithcs:function(a,c){return a?a.lastIndexOf(c)==a.length-c.length:!1}},compileList:function(a,c,b){b||(b=" && ");var e=[],k;for(k in a){var h=a[k];if(void 0!==h){h=JSON.stringify(h);switch(h){case "$and":e.push(B.compileList(h,c," && "));break;case "$or":e.push(B.compileList(h,c," || "));break;case "$not":e.push("!("+B.compileList(h,c,b)+")")}var g=k.indexOf(":");-1==g&&(g=k.lastIndexOf(" "));var f=k,d="==";-1!=g&&(f=k.substr(0,g),d=k.substr(g+1).toLowerCase());g="";/^\!/gi.test(d)&&(g="!",
d=d.substr(1));var f=JSON.stringify(f),w=null,w=B.helpers[d];if("any"===d){if("{}"==h)continue;w=g+" QueryCompiler.helpers.any(Atom.get(item, "+f+" ), "+h+")"}else w=w?g+"QueryCompiler.helpers['"+d+"'](Atom.get(item,"+f+"), "+h+")":"Atom.get(item,"+f+") "+g+d+" "+h+"";e.push(w)}}return 0<e.length?e:["true"]},compiled:{},compile:function(a){if(!a)return function(b){return!0};var c=JSON.stringify(a),b=B.compiled[c];if(b)return b;b=B.compileList(a,"item","q").join(" && ");E(b);var e=new Function(["item",
"q"]," return "+b+";"),b=function(b){return e(b,a)};return B.compiled[c]=b},selectCompiled:{},compileSelect:function(a){if(!a)return function(b){return b};if(a.constructor==String)return function(b){return q.get(b,a)};var c=JSON.stringify(a),b=B.selectCompiled[c];if(b)return b;var b=[],e;for(e in a){var k=a[e];e=JSON.stringify(e);k?(k=JSON.stringify(k),b.push(e+":Atom.get(item,"+k+")")):b.push(e+": Atom.get(item,"+e+")")}e="return {"+b.join(",")+"};";b=new Function("item",e);return B.selectCompiled[c]=
b}},F={firstOrDefault:function(a){for(a=B.compile(a);this.next();){var c=this.current();if(a(c))return c}return null},first:function(a){for(a=B.compile(a);this.next();){var c=this.current();if(a(c))return c}throw Error("Item not found in collection");},where:function(a){a=B.compile(a);for(var c=[];this.next();){var b=this.current();a(b)&&c.push(b)}return new p(c)},toArray:function(){for(var a=[];this.next();)a.push(this.current());return a},any:function(a){return this.firstOrDefault(a)?!0:!1},select:function(a){a=
B.compileSelect(a);for(var c=[];this.next();){var b=this.current();c.push(a(b))}return new p(c)},join:function(a){for(var c=[];this.next();)c.push(this.current());return c.join(a)},count:function(a){if(a)return this.where(a).count();for(a=0;this.next();)a++;return a},sum:function(a){for(var c=0;this.next();){var b=this.current();a&&(b=d.getValue(b,a));c+=+(b||0)}return c},groupBy:function(a){a=B.compileSelect(a);for(var c={},b=[];this.next();){var e=this.current(),k=a(e),h=c[k];h||(h=[],c[k]=h,b.push({key:k,
items:h}));h.push(e)}return q.query(b)}};m.AtomQuery=F;m.QueryCompiler=B;for(var M in F)p.prototype[M]=F[M];q.query=function(a){return void 0!==a.length?new p(a):a};var r={nodeValue:A.isIE&&9>A.majorVersion?"nodeValue":"value",attributeMap:function(a,c){var b,e={},k=new p(a.attributes);if(c){for(;k.next();)b=k.current(),c.test(b.nodeName)&&(c.lastIndex=0,e[b.nodeName]={value:b[r.nodeValue],node:b});return e}for(;k.next();)b=k.current(),e[b.nodeName]={value:b[r.nodeValue],node:b};return e},cloneNode:A.isIE&&
8>A.majorVersion?function(a){for(var c=m.document,b=c.createElement(a.nodeName),e=new p(a.attributes);e.next();){var k=e.current();try{var h=k.nodeName,g=k[r.nodeValue];g&&b.setAttribute(h,g)}catch(f){}}for(a=a.firstChild;a;)3==a.nodeType?(e=c.createTextNode(a.nodeValue),b.appendChild(e)):1==a.nodeType&&b.appendChild(r.cloneNode(a)),a=a.nextSibling;return b}:function(a){return a.cloneNode(!0)},findPresenter:function(a){for(a=new y(a);a.next();){var c=a.current();if(f(c).attr("atom-presenter")||(c=
r.findPresenter(c)))return c}return null},parseUrl:function(a){var c={};a=a.split("&");for(a=new p(a);a.next();){var b=a.current().split("="),e=b[0];(b=b[1])&&(b=decodeURIComponent(b));b=r.parseValue(b);c[e]=b}return c},parseValue:function(a){var c;if(/^[0-9]+$/.test(a))return c=parseInt(a,10),isNaN(c)||(a=c),a;if(/^[0-9]+\.[0-9]+/gi.test(a))return c=parseFloat(a),isNaN(c)||(a=c),a;if(/true/.test(a))return!0;/false/.test(a)&&(a=!1);return a},cancelEvent:function(a){var c=a.target;if(!(c&&/input/gi.test(c.nodeName)&&
/checkbox/gi.test(c.type)))return a.preventDefault?a.preventDefault():a.stop(),a.returnValue=!1,a.stopPropagation(),!1},assignID:function(a){a.id||(a.id="__waID"+r.getNewIndex());return a.id},atomParent:function(a){return a.atomControl?a.atomControl:a!==s&&a!==m&&a.parentNode?r.atomParent(a._logicalParent||a.parentNode):null},toNumber:function(a){return a?a.constructor==String?parseFloat(a):a:0},isNode:function(a){try{if(m.XMLHttpRequest&&a instanceof XMLHttpRequest)return!0}catch(c){}return a===
m||a===s?!0:"object"===typeof Node?a instanceof Node:"object"===typeof a&&"number"===typeof a.nodeType&&"string"===typeof a.nodeName},createDelegate:function(a,c){return this.getDelegate(a,c,!0)},getDelegate:function(a,c,b){if(c&&c.constructor!=String)throw Error("methodName has to be string");var e=a.__delegates;if(!e){if(!b)return null;e={};a.__delegates=e}var k=e[c];if(!k){if(!b)return null;var h=a[c];if(!h)throw Error("method "+c+" not found");k=function(){return h.apply(a,arguments)};e[c]=k}return k},
__index:1E3,getNewIndex:function(){return this.__index+=1},contains:function(a,c){for(var b=a.length,e=0,e=0;e<b;e++)if(a[e]==c)return!0;return!1},removeAllChildren:function(a){for(;a.hasChildNodes();){var c=a.lastChild;if(!c)break;c.atomControl&&(c.atomControl.dispose(),delete c.atomControl);f(c).remove()}},isWebkit:function(){return-1==m.navigator.userAgent.toLowerCase().indexOf("webkit")?!1:!0},isWeirdControl:function(a){return"BUTTON"==a.nodeName||"SELECT"==a.nodeName||"INPUT"==a.nodeName&&"submit"==
f(a).attr("type")},parseCSS:function(a,c){var b=parseInt(f(a).css(c),10);return isNaN(b)?0:b},setItemRect:function(a,c){var b=this.isWeirdControl(a);c.width&&(c.width-=this.parseCSS(a,"marginLeft")+this.parseCSS(a,"marginRight"),b||(c.width-=this.parseCSS(a,"borderLeftWidth")+this.parseCSS(a,"borderRightWidth"),c.width-=this.parseCSS(a,"paddingLeft")+this.parseCSS(a,"paddingRight")),0>c.width&&(c.width=0),a.style.width=c.width+"px");c.height&&(c.height-=this.parseCSS(a,"marginTop")+this.parseCSS(a,
"marginBottom"),b||(c.height-=this.parseCSS(a,"borderTopWidth")+this.parseCSS(a,"borderBottomWidth"),c.height-=this.parseCSS(a,"paddingTop")+this.parseCSS(a,"paddingBottom")),0>c.height&&(c.height=0),a.style.height=c.height+"px");c.left&&(a.style.left=c.left+"px");c.top&&(a.style.top=c.top+"px")},getPresenterOwner:function(a,c){if(a._presenters)for(var b=new p(a._presenters);b.next();)if(b.current()==c)return a;return this.getPresenterOwner(a.get_atomParent(),c)},createCss:function(a){if(!a)return"";
if(a.constructor==String)return a;var c=[],b;for(b in a)a[b]&&c.push(b);return c.join(" ")},createControl:function(a,c,b,e){if(!a.atomControl)return c?c.constructor==String&&(c=n[c]):(c=f(a).attr("atom-type"),c=n[c]),c?(a=new c(a),b&&(a._data=b),e&&(a._scope=e),a.createChildren(),b&&a.init(),a):null}};m.AtomUI=r;r.isIE7=-1!=m.navigator.userAgent.indexOf("MSIE 7.0");r.isIE8=-1!=m.navigator.userAgent.indexOf("MSIE 8.0");var d={getClone:function(a){var c={};if("object"==typeof a){"undefined"!=typeof a.length&&
(c=[]);for(var b in a){var e=a[b];if(void 0!==e)if(null===e)c[b]=null;else if(!/^\_\$\_/gi.test(b)){var k=typeof e;"object"==k?c[b]=e.constructor==Date?"/DateISO("+z.toLocalTime(e)+")/":d.getClone(e):"string"==k?c[b]=e:"number"==k?c[b]=e:"boolean"==k?!0==e?c[b]=!0:c[b]=!1:"date"==k&&(c[b]=e.getTime())}}}return c},setValue:function(a,c,b){if(a||void 0!==b){var e=d.getValue(a,c);if(e!==b){var k=a["set_"+c];k?k.apply(a,[b]):a[c]=b;d.refreshValue(a,c,e,b)}}},refreshValue:function(a,c){var b=d.get_WatchHandler(a,
c);if(void 0!=b&&null!=b){for(b=new p(b);b.next();)b.current()(a,c);a._$_watcher&&a._$_watcher._onRefreshValue(a,c)}},getValue:function(a,c){if(null==a)return null;var b=a["get_"+c];return b?b.apply(a):a[c]},add_WatchHandler:function(a,c,b){null!=a&&d.get_WatchHandler(a,c).push(b)},get_WatchHandler:function(a,c){if(null==a)return null;var b=a._$_handlers;b||(b={},a._$_handlers=b);var e=b[c];if(void 0==e||null==e)e=[],b[c]=e;return e},remove_WatchHandler:function(a,c,b){if(null!=a&&void 0!==a._$_handlers&&
null!==a._$_handlers&&(a=a._$_handlers[c],void 0!=a&&null!=a))for(c=new p(a);c.next();)if(c.current()==b){a.splice(c.currentIndex(),1);break}},invokeItemsEvent:function(a,c,b,e){var k=d.get_WatchHandler(a,"_items");if(k){for(k=new p(k);k.next();)k.current()(c,b,e);a._$_watcher&&a._$_watcher._onRefreshItems(a,c,b,e);d.refreshValue(a,"length")}},clear:function(a){a.length=0;d.invokeItemsEvent(a,"refresh",0,null)},addItem:function(a,c){var b=a.length;a.push(c);d.invokeItemsEvent(a,"add",b,c)},insertItem:function(a,
c,b){a.splice(c,0,b);d.invokeItemsEvent(a,"add",c,b)},addItems:function(a,c){for(var b=new p(c);b.next();)d.addItem(a,b.current())},removeItem:function(a,c){var b=a.indexOf(c);-1!=b&&(a.splice(b,1),d.invokeItemsEvent(a,"remove",b,c))},removeAtIndex:function(a,c){if(-1!=c){var b=a[c];a.splice(c,1);d.invokeItemsEvent(a,"remove",c,b)}},refreshItems:function(a){d.invokeItemsEvent(a,"refresh",-1,null)},add_CollectionChanged:function(a,c){null!=a&&d.get_WatchHandler(a,"_items").push(c)},remove_CollectionChanged:function(a,
c){if(null!=a&&a._$_handlers){var b=a._$_handlers._items;if(void 0!=b&&null!=b)for(var e=new p(b);e.next();)if(e.current()==c){b.splice(e.currentIndex(),1);break}}},setError:function(a,c,b){var e=d.getValue(a,"__errors");e||d.setValue(a,"__errors",{});d.setValue(e,c,b)}};m.AtomBinder=d;q.clone=d.getClone;q.add=d.addItem;q.insert=d.insertItem;q.remove=d.removeItem;q.refresh=d.refreshValue;q.refreshArray=d.refreshItems;q.clearArray=d.clear;Array.prototype.enumerator=function(){return new p(this)};Array.prototype.indexOf||
(Array.prototype.indexOf=function(a){for(var c=0,c=0;c<this.length;c++)if(a==this[c])return c;return-1});var G={split:function(a,c){c&&c.constructor==String&&(c=f.trim(c));for(var b=a.split(c),e=[],b=new p(b),k;b.next();)(k=b.current())&&k.constructor==String&&(k=f.trim(k)),e.push(k);return e},getValues:function(a,c){var b,e=a;if(c)for(var e=[],k=new p(a);k.next();)b=k.current(),e.push(b[c]);return e},intersect:function(a,c,b){var e=[];b=new p(b);for(var k;b.next();)k=b.current(),k=this.getMatch(a,
c,k),void 0!=k&&e.push(k);return e},getMatch:function(a,c,b){a=new p(a);for(var e,k;a.next();)if(k=e=a.current(),c&&(k=e[c]),k==b)return e},remove:function(a,c){for(var b=new p(a);b.next();)if(b.current()==c){a.splice(b.currentIndex(),1);break}}};m.AtomArray=G;var H=function(a,c,b){return classCreator(c,b,function(b,a,c){this.owner=b;this.parent=a;c&&(this.__application=c);this.__application==this.owner&&(this._v=0,this.refreshCommand=function(){appScope._v+=1;d.refreshValue(appScope,"_v")});this._refreshValue=
function(b){d.refreshValue(this,b);this.__application===this.owner&&this.__application._onRefreshValue(this,b)}},{setValue:function(b,a,c){d.getValue(this,b)==a?c&&this._refreshValue(b):((c=this["set_"+b])?c.apply(this,[a]):this[b]=a,this._refreshValue(b))}})}(m,"WebAtoms.AtomScope",null);(function(a,c,b){return classCreator(c,b,function(){this._eventHandlers=[]},{bindEvent:function(b,a,c,g,x){if(null!=b){"function"==typeof c&&(x=c);x=x||r.createDelegate(this,c);c={element:b,name:a,methodName:c,handler:x};
g&&(c.key=g);if(r.isNode(b))f(b).bind(a,null,x);else if(b.addEventListener)b.addEventListener(a,x,!1);else{var D=b["add_"+a];null==D?(D=d["add_"+a],g?D.apply(d,[b,g,x]):D.apply(d,[b,x])):D.apply(b,[x])}this._eventHandlers.push(c)}},unbindEvent:function(b,a,c,g){for(var x=new p(this._eventHandlers),D=[];x.next();){var w=x.current();if(!b||b===w.element)if(!a||a===w.name)if(!c||c===w.methodName)if(!g||g===w.key){if(r.isNode(w.element))f(w.element).unbind(w.name,w.handler);else if(w.element.removeEventListener)w.element.removeEventListener(a,
w.handler,!1);else{var n=w.element["remove_"+w.name];null==n?(n=d["remove_"+w.name],w.key?n.apply(d,[w.element,w.key,w.handler]):n.apply(d,[w.element,w.handler])):n.apply(w.element,[w.handler])}D.push(w)}}if(D.length==this._eventHandlers.length)this._eventHandlers.length=0;else for(x=new p(D);x.next();)w=x.current(),G.remove(this._eventHandlers,w)},init:function(){},dispose:function(){this.unbindEvent(null,null,null);this.__delegates&&(this.__delegates=null)}})})(this,"WebAtoms.AtomComponent",null);
var u=function(){this._success=[];this._failed=[];this._cached=!1;this._process=null;this._calls=0;this._showError=this._showProgress=!0;var a=this;this.success=function(){a.onSuccess.apply(a,arguments)};this.error=function(){a.onError.apply(a,arguments)}};m.AtomPromise=u;u.prototype={onSuccess:function(a){this._value=a;this._process&&(this._value=this._process(this._value));a=this._success;for(var c=0;c<a.length;c++)a[c](this)},onError:function(){this.errors=arguments;for(var a=this._failed,c=0;c<
a.length;c++)a[c](this)},then:function(a){this._success.push(a);return this},process:function(a){this._process=a;return this},failed:function(a){this._failed.push(a);return this},value:function(a){if(void 0!==a)this._value=a;else return this._value},onInvoke:function(a){this._invoke=a;return this},invoke:function(){if(!this._persist)return this.invokePromise(),this;var a=this;this.promiseTimeout=setTimeout(function(){a.invokePromise()},100);return this},invokePromise:function(){this.promiseTimeout=
null;if(this._showProgress&&(atomApplication.setBusy(!0),0===this._calls)){var a=function(){atomApplication.setBusy(!1)};this.then(a);this.failed(a)}this._calls++;this._invoke(this);return this},pushValue:function(a){var c=this;this._cached=!0;setTimeout(function(){c.onSuccess.apply(c,[a])},1)},showProgress:function(a){this._showProgress=a;return this},showError:function(a){this._showError=a;return this},persist:function(a){this._persist=void 0===a?!0:a;return this},abort:function(){this.promiseTimeout?
(clearTimeout(this.promiseTimeout),this.promiseTimeout=null):(this._failed.length=0,this._success.length=0,this._showProgress&&atomApplication.setBusy(!1),this.handle&&this.handle.abort())}};u.getUrl=function(a){var c=location.href,b=c.indexOf("#");-1!==b&&(c=c.substr(0,b));if(a){b=c.lastIndexOf("/");-1!==b&&(c=c.substr(0,b+1));if(/^(http|https)\:\/\//gi.test(a)||/^\//gi.test(a))return a;/^\./gi.test(a)&&(a=a.substr(1),/\/$/gi.test(c)&&/^\//gi.test(a)&&(a=a.substr(1)));return c+a}return c};u.parseDates=
function(a){if(!a)return a;if("object"===typeof a){if("undefined"!==typeof a.length){for(var c=0;c<a.length;c++)a[c]=u.parseDates(a[c]);return a}for(c in a){var b=a[c];b&&(a[c]=u.parseDates(b))}}return("string"===typeof a||a.constructor===String)&&/^\/date\(/gi.test(a)&&/\)\/$/gi.test(a)?z.parse(a):a};u.ajax=function(a,c,b,e){var k=new u;b||(b={type:"GET",dataType:"text",data:null});C.ajax.versionUrl&&void 0!==b.versionUrl&&b.versionUrl&&(c=c||{},c[C.ajax.versionKey]=C.ajax.version);b.success=k.success;
b.error=k.error;void 0===b.cache&&(b.cache=!1);var h=a,g=C.ajax.headers;if(g){b.headers||(b.headers={});for(var x in g)e=g[x],b.headers[x]=e,C.debug&&E("Header set: "+x+"="+e)}if(g=C.ajax.statusCode){var D=b.statusCode||{};for(x in g)e=g[x],D[x]||(D[x]=e);b.statusCode=D}var w=b;if(b=w.data)b=d.getClone(b),b=(e=C.ajax.jsonPostEncode)?e(b):{formModel:JSON.stringify(b)},w.data=b;if((g=w.attachments)&&g.length){e=new FormData;for(g=new p(g);g.next();)e.append("file"+g.currentIndex(),g.current());if(b)for(x in b)e.append(x,
b[x]);w.type="POST";w.xhr=function(){var b=f.ajaxSettings.xhr();b.upload&&b.upload.addEventListener("progress",function(b){b.lengthComputable&&(b=Math.round(100*b.loaded/b.total),d.setValue(atomApplication,"progress",b))},!1);return b};w.cache=!1;w.contentType=!1;w.processData=!1}if(c){b={};if(!w.sendRawQueryString)for(x in c){if((e=c[x])&&"object"===typeof e){e=JSON.stringify(d.getClone(e));if(void 0===e)continue;if(null===e)continue}b[x]=e}h=q.url(a,b)}if(a)k.onInvoke(function(){k.handle=f.ajax(h,
w)});k.failed(function(){var b=k.errors[0].responseText;b&&"Internal Server Error"===k.errors[2]||(b=k.errors[2]);k.error={msg:b};k._showError&&k.error.msg&&q.alert(k.error.msg)});k.then(function(b){var e=b.value();(e=u.parseDates(e))&&e.items&&e.merge&&(e.items.total=e.total,e=e.items,b.value(e))});k.showError(!0);k.showProgress(!0);return k};u.get=function(a,c,b){b=b||{};b.type=b.type||"get";b.dataType=b.dataType||"text";return u.ajax(a,c,b,"get")};u.plugins={};u.json=function(a,c,b){b=b||{};b.type=
b.type||"get";b.dataType=b.dataType||"json";var e=null,k=a.indexOf("://");if(-1!==k){var h=a.substr(0,k);/http|https/i.test(h)||(a=a.substr(k+3),e=u.plugins[h])}e=e||u.ajax;return e(a,c,b,"json")};u.cache={};u.cacheInProgress={};u.cachedPromise=function(a,c){var b=u.cache[a];!b&&m.sessionStorage&&(b=m.sessionStorage["__AP"+a])&&(b=JSON.parse(b),u.cache[a]=b);if(b)return c.onInvoke(function(){c.pushValue(b)}),c;c.then(function(b){u.cache[a]=b.value();m.sessionStorage&&(m.sessionStorage["__AP"+a]=JSON.stringify(b.value()))});
return c};u.cachedJson=function(a,c,b){var e=C.ajax.versionKey+"="+C.ajax.version;-1===a.indexOf("?")?e="?"+e:/\&$/.test(a)||(e="&"+e);a+=e;b=b||{};b.cache=!0;b.ifModified=!0;b.versionUrl=!1;c=u.ajax(a,c,b,"json");return u.cachedPromise(a,c)};u.configCache={};u.configLabel=function(a,c,b){if(null===c||void 0===c)return"";b=b||{};var e=b.valuePath||"value",k=b.labelPath||"label",h=b.isNumber||!1;h&&"number"!==typeof c&&(c=parseFloat(c));var g=new u;g.onInvoke(function(){var b=u.configCache[a];b?(b=
(b=b[c])?b[k]:"",g.pushValue(b)):(b=u.cachedJson(a),b.then(function(b){var f="",d={};for(b=new p(b.value());b.next();){var x=b.current(),f=x[e];h&&"number"!==typeof f&&(f=parseFloat(f));d[f]=x}u.configCache[a]=d;d=(d=d[c])?d[k]:"";g.pushValue(d)}),b.invoke())});return g};u.prototype.insertItem=function(a,c,b){return this.then(function(e){e=e.value();e._$_itemInserted||(b&&(e=e[b]),-1===a?e.push(c):e.splice(a||0,0,c),e._$_itemInserted=!0)})};var O={list:function(a,c){},add:function(a,c){},remove:function(a,
c){},clear:function(a){},set:function(a,c,b){},get:function(a,c){}};u.plugins["local-storage"]=function(a,c,b){a=a.split("/");var e=a[0],k=a[1];a=new u;a.onInvoke(function(a){var g=O[k](e,c,b.data);a.pushValue(g)});return a};(function(a,c){return classCreatorEx({name:"WebAtoms.AtomBinding",base:c,start:function(b,e,a,c,g,f,d,n){this.element=e;this.control=b;this.vf=d;this.key=a;this.events=n;if(c&&c.constructor!=String)for(this.pathList=[],this.path=null,b=new p(c);b.next();){e=new p(b.current());
for(a=[];e.next();)a.push({path:e.current(),value:null});this.pathList.push(a)}else for(b=new p(c.split(".")),this.path=[];b.next();)this.path.push({path:b.current(),value:null});this.twoWays=g;this.jq=f;this._isUpdating=!1},methods:{onPropChanged:function(b,e){if(null!=this.path&&0!=this.path.length){for(var a=new p(this.path),c=this.control,g=null;a.next();){g=a.current();g.value=c;if(!c)return;a.isLast()||(c=d.getValue(c,g.path))}a=null;if(this.jq)switch(this.key){case "valueAsDate":a=this.element.valueAsDate;
break;case "checked":a=this.element.checked?!0:!1;break;default:a=f(this.element).val()}else a=d.getValue(this.control,this.key);d.setValue(c,g.path,a)}},onDataChanged:function(b,e){if(!this._isUpdating&&void 0!==arguments&&0!=arguments.length){var a,c=this.control;if(this.pathList){var g=[];for(a=new p(this.pathList);a.next();)g.push(this.evaluate(c,a.current()));for(a=new p(g);a.next();)if(void 0===a.current())return;this.setValue(g)}else g=this.evaluate(c,this.path),void 0!==g&&this.setValue(g)}},
evaluate:function(b,e){for(var a=null,c=null,g=new p(e);b&&g.next();)c=g.current(),a=d.getValue(b,c.path),/scope|appScope|atomParent|templateParent|localScope/gi.test(c.path)||(c.value?c.value!=b&&(this.unbindEvent(c.value,"WatchHandler",null,c.path),this.bindEvent(b,"WatchHandler","onDataChanged",c.path)):this.bindEvent(b,"WatchHandler","onDataChanged",c.path)),c.value=b,b=a;void 0===a&&C.debug&&E("Undefined:"+this.control._element.id+" -> "+f.map(e,function(b){return b.path}).join("."));return a},
onValChanged:function(){this.onPropChanged(null,null)},setup:function(){if(this.twoWays)if(this.jq){if(this.bindEvent(this.element,"change","onValChanged"),this.events)for(var b=new p(this.events.split(","));b.next();)this.bindEvent(this.element,b.current(),"onValChanged")}else this.bindEvent(this.control,"WatchHandler","onPropChanged",this.key);this.onDataChanged(this,null)},setValue:function(b){!this.pathList&&this.vf&&(b=[b]);this.vf&&(b.push(q),b.push(u),b=this.vf.apply(this,b));b instanceof u&&
(b._persist=!0);this._lastValue=b;this._isUpdating=!0;this.control.setLocalValue(this.key,b,this.element,!0);this._isUpdating=!1}}})})(m,n.AtomComponent.prototype);var L={};m.allControls=L;(function(a,c){return classCreator(a,c,function(){this._paused=!1;this.queue=[];this.onTimeout=function(){if(!this._paused)if(0==this.queue.length){var b=atomApplication._element;if("hidden"==b.style.visibility||"hidden"==f(b).css("visibility"))b.style.visibility="visible",b.atomControl.updateUI()}else this.queue.shift()(),
m.setTimeout(this._onTimeout,1)};var b=this;this._onTimeout=function(){b.onTimeout()}},{pause:function(){this._paused=!0},start:function(){this._paused=!1;m.setTimeout(this._onTimeout,1)},callLater:function(b){this.queue.push(b);this._paused||this.start()},setupControls:function(){var b=f("[atom-type]").first()[0];if(void 0==b.atomControl||null==b.atomControl){var e=f(b).attr("atom-type");f(b).removeAttr("atom-type");(new n[e](b)).setup()}}})})("WebAtoms.AtomDispatcher",null);n.dispatcher=new n.AtomDispatcher;
(function(a,c,b){return classCreator(c,b,function(){},{get_owner:function(){return this},get_appScope:function(){return appScope},get_scope:function(){if(void 0===this._scope){var b=this.get_atomParent(this._element._logicalParent||this._element.parentNode);return b?b._localScope||b.get_scope():appScope}return this._scope},get_localScope:function(){if(void 0===this._localScope){var b=this.get_atomParent(this._element._logicalParent||this._element.parentNode);if(b)return b.get_localScope();throw Error("Local Scope does not exist");
}return this._localScope},set_scope:function(b){var a=this.get_scope(),c;for(c in b){if(/^(application|owner|app|parent)$/gi.test(c))throw Error("Invalid name for the scope property");a[c]||(a[c]=b[c])}},get_name:function(){return this._name},getTemplate:function(b){var a=this["_"+b];if(void 0!==a&&null!==a)return a;a=t.get(this.constructor,b);return a?this["_"+b]=a:null}},{next:null,value:void 0})})(m,"WebAtoms.AtomUIComponent",n.AtomComponent.prototype);t.compiled={};s=m.document;t.compileElement=
function(a){a=new p(a);a.next();var c=a.current(),b=s.createElement(c);if(!a.next())return b;if(c=a.current())for(var e in c)b.setAttribute(e,c[e]);for(;a.next();){c=a.current();if(!c)break;c.constructor==String?b.appendChild(s.createTextNode(c)):b.appendChild(t.compileElement(c))}return b};t.compileJsonML=function(a){if(1==a.length)return t.compileElement(a[0]);var c=[];for(a=new p(a);a.next();)c.push(t.compileElement(a.current()));return c};t.compile=function(a,c,b){a=s.createElement("div");a.innerHTML=
b;1==f(a).children().length&&(b=r.cloneNode(a.firstElementChild||a.children[0]));return b};t.get=function(a,c){var b=a.__typeName+"."+c,e=this.compiled[b];if(e)return e;(e=t.jsonML[b])?e=t.compileJsonML(e):a.__baseType&&(e=t.get(a.__baseType,c));return e?this.compiled[b]=e:null};t.compileType=function(a){var c=a.__typeName,b=c.split("."),b=b[b.length-1],e=this.compiled[c];if(e)return e;var e={},k=this[c]||this[b];if(k)for(var h in k)e[h]=this.compile(a,h,k[h]);if(a.__baseType){a=this.compileType(a.__baseType);
for(var g in a)e[g]||(e[g]=a[g])}this.compiled[c]=e;h=this;delete h[c];delete h[b];return e};var N={"{":function(a,c,b,e){b=b.substr(1,b.length-2);var k=K.parse(b);if(k.path){var h=new p(k.path);for(b=[];h.next();){for(var g=new p(h.current()),f=a;g.next();)f=d.getValue(f,g.current());b.push(f)}}else b=[b];b.push(q);b.push(u);b=k.method.apply(null,b);a.setLocalValue(c,b,e)},"[":function(a,c,b,e){b=b.substr(1,b.length-2);var k=K.parse(b);0==k.length?(b=eval(b),d.setValue(a,c,b)):1==k.length&&k.path[0]==
k.original?a.bind(e,c,b,!1):a.bind(e,c,k.path,!1,k.method)},"$[":function(a,c,b,e){var k=b.lastIndexOf("]"),h=null;k<b.length-1&&(h=b.substr(k+2),h=h.substr(0,h.length-1));b=b.substr(0,k);b=b.substr(2);/^(@|\$)/g.test(b)&&(b=b.substr(1));a.bind(e,c,b,!0,null,h)},"^[":function(a,c,b,e){b=b.substr(2,b.length-3);/^(@|\$)/g.test(b)&&(b=b.substr(1));a.bind(e,c,b,!0,null,"keyup,keydown,keypress,blur")}},J={any:function(a,c,b){a.setAttribute(b,c)},isEnabled:function(a,c){c?f(a).removeAttr("disabled"):f(a).attr("disabled",
"disabled")},checked:function(a,c){a.checked!=c&&(a.checked=c?!0:!1)},value:function(a,c){/date|datetime/gi.test(a.type)?a.valueAsDate=z.parse(c):f(a).val(c)},valueAsDate:function(a,c){a.valueAsDate=z.parse(c)},text:function(a,c){a.innerHTML="";var b=s.createTextNode(c);a.appendChild(b)},html:function(a,c){a.innerHTML=c},absPos:function(a,c){J.setPosition(!0,a,c)},relPos:function(a,c){J.setPosition(!1,a,c)},"class":function(a,c){a.atomClass&&f(a).removeClass(a.atomClass);c&&((c=r.createCss(c))&&f(a).addClass(c),
a.atomClass=c)},setPosition:function(a,c,b){b.constructor==String&&(b=eval("["+b+"]"));c.style.position=a?"absolute":"relative";a=b[0];var e=b[1];null!==a&&(c.style.left=a+"px");null!==e&&(c.style.top=e+"px");2<b.length&&(a=b[2],b=b[3],void 0!==a&&null!==a&&(c.style.width=a+"px"),void 0!==b&&null!==b&&(c.style.height=b+"px"))}};m.AtomProperties=J;(function(a,c,b){return classCreatorEx({name:c,base:b,start:function(b){b.atomControl=this;this._element=b;this.dispatcher=n.dispatcher;this.bindings=[];
this._isVisible=!0;b.id&&appScope&&(appScope[b.id]=this);r.assignID(b);L[b.id]=this},properties:{layout:null,loadNext:null,next:null,merge:void 0,value:void 0},methods:{set_merge:function(b){this._mergeData2=null;if(b){var a=b.data;a&&(q.merge(this.get_data(),a,!0),this._mergeData2=a);(a=b.scope)&&q.merge(this.get_scope(),a,!0);(a=b.appScope)&&q.merge(this.get_appScope(),a,!0);(a=b.localScope)&&q.merge(this.get_localScope(),a,!0);(a=b.owner)&&q.merge(this,a,!0)}},invokeAction:function(b,a){if(b)if(b.constructor==
String)location.href=b;else{var c=b;if(c.atomControl)c=c.atomControl,c.refresh?c.refresh(this.get_scope(),this):q.alert("no default action defined");else if(c._element)c.refresh(this.get_scope(),this);else if("function"==typeof c)c(this.get_scope(),this,a);else if(c.length)for(c=new p(c);c.next();)this.invokeAction(c.current(),a);else if(b=c.timeOut||c.timeout){var g=this,c=100;b.hasOwnProperty("length")&&1<b.length&&(c=b[0],b=b[1]);setTimeout(function(){g.invokeAction(b)},c)}else{this.set_merge(c);
if(b=c.confirm){var f="Are you sure?";b.hasOwnProperty("length")&&(1<b.length?(f=b[0],b=b[1]):b=b[0]);var g=this,d=b;q.confirm(f,function(){g.invokeAction(d,a)})}(b=c.alert)&&q.alert(b);(b=c.next)?this.invokeAction(b,a):(b=c.control)&&L[b].refresh()}}},refresh:function(){},get_element:function(){return this._element},clearBinding:function(b,a){for(var c=new p(this.bindings),g,f=[];c.next();)g=c.current(),b&&g.element!=b||a&&g.key!=a||(g.dispose(),f.push(g));for(c=new p(f);c.next();)G.remove(this.bindings,
c.current())},addBinding:function(b,a,c,g,f,d,w,m){this.clearBinding(a,c);b=new n.AtomBinding(b,a,c,g,f,d,w,m);this.bindings.push(b);b.setup()},get_atomParent:function(b){if(null==b)if(this._element._logicalParent||this._element.parentNode)b=this._element._logicalParent||this._element.parentNode;else return null;return b.atomControl?b.atomControl:b!==s&&b!==a&&b.parentNode?this.get_atomParent(b._logicalParent||b.parentNode):null},get_templateParent:function(b){b||(b=this._element);if(b._templateParent)return b._templateParent;
if(!b._logicalParent&&!b.parentNode)throw Error("Could not find templateParent");return this.get_templateParent(b._logicalParent||b.parentNode)},get_data:function(){if(void 0===this._data){var b=this.get_atomParent(this._element._logicalParent||this._element.parentNode);if(b)return b.get_data()}return this._data},set_data:function(b){this._data=b;this.mergeData();this.updateChildBindings(this._element)},mergeData:function(){this._mergeData2&&q.merge(this.get_data(),this._mergeData2,!0)},updateChildBindings:function(b){for(b=
new y(b);b.next();){var a=b.current();if(a.atomControl&&a.atomControl._created){var c=a.atomControl;if(void 0!==c._data)continue;d.refreshValue(c,"data");c.mergeData()}this.updateChildBindings(a)}},initProperties:function(){if(!this._disposed){var b=this.get_element();this.setProperties(b);this._created=!0;this.onCreated();this.onLoaded()}},createChildren:function(){this.onCreateChildren(this._element);var b=this.getTemplate("template");if(b&&0==f(this._element).children().length){if(b.constructor==
String){this._element.innerHTML=b;var a=this;f(this._element).children().each(function(){this._templateParent=a})}else if(r.isNode(b))b=r.cloneNode(b),b._templateParent=this,this._element.appendChild(b);else for(b=new p(b);b.next();){var c=b.current(),c=r.cloneNode(c);c._templateParent=this;this._element.appendChild(c)}this.onCreateChildren(this._element)}},onCreateChildren:function(b){for(var a=new y(b),c;a.next();){c=a.current();var g=r.attributeMap(c,/^atom\-(template|presenter|type|template\-name)$/gi),
f=g["atom-template"];if(f)c.removeAttributeNode(f.node),b.templateOwner=!0,this["_"+f.value]=c,b.removeChild(c);else if(f=g["atom-template-name"])c.removeAttributeNode(f.node),this._scopeTemplates=this._scopeTemplates||{},this._scopeTemplates[f.value]=c,b.removeChild(c);else if((f=g["atom-presenter"])&&(r.getPresenterOwner(this,f.value)["_"+f.value]=c),g=g["atom-type"])r.createControl(c,g.value);else this.onCreateChildren(c)}},onLoaded:function(){},onUpdateUI:function(){this._layout?this._layout.doLayout(this._element):
this.updateChildUI(this.get_element())},updateUI:function(){var b=this;this.dispatcher.callLater(function(){b.onUpdateUI()})},updateChildUI:function(b){b||(b=this._element);for(b=new y(b);b.next();){var a=b.current();a.atomControl?a.atomControl.updateUI():this.updateChildUI(a)}},onCreated:function(){this.updateUI()},setProperties:function(b){var a,c,g,d=new p(b.attributes),n=[],w="value";A.isIE&&9>A.majorVersion&&(w="nodeValue");for(var m={};d.next();)g=d.current(),a=g.nodeName,c=g[w],/^atomControl$/g.test(a)||
(/^atom\-type$/.test(a)?n.push(g):/^(atom|bind|style|event)\-/g.test(a)&&(/^(style|event)\-/g.test(a)||(a=a.substr(5)),c&&(/(^style$|dock)/.test(a)||n.push(g),a=f.camelCase(a),m[a]=c)));for(a in m)this.setValue(a,m[a],!0,b);for(d=new p(n);d.next();)b.removeAttributeNode(d.current());for(b=new y(b);b.next();)a=b.current(),a.atomControl||this.setProperties(a)},setValue:function(b,a,c,g){if(a&&a.constructor==String){c=a[0];var f=N[c];if(f){f(this,b,a,g);return}c+=a[1];if(f=N[c]){f(this,b,a,g);return}}this.setLocalValue(b,
a,g)},setLocalValue:function(b,a,c,g){if(void 0!==a)if(a&&a instanceof u){c._promisesQueue=c._promisesQueue||{};(g=c._promisesQueue[b])&&g.abort();c._promisesQueue[b]=a;a._persist&&(this._promises=this._promises||{},this._promises[b]=a);var f=this;a.then(function(a){c._promisesQueue[b]==a&&(c._promisesQueue[b]=null);c._promisesQueue[b]=null;f.setLocalValue(b,a.value(),c,!0);f._loadNext&&f.invokeAction(f._loadNext)});a.failed(function(a){c._promisesQueue[b]==a&&(c._promisesQueue[b]=null)});a.invoke()}else{if(this._element==
c){var n=this["set_"+b];if(null!=n){if(g&&d.getValue(this,b)==a)return;n.apply(this,[a]);g&&d.refreshValue(this,b);return}}if(/^style/g.test(b)&&5<b.length)g=b.substr(5),g=String.fromCharCode(g.charCodeAt(0)).toLowerCase()+g.substr(1),c.style[g]=a;else if(/^event/g.test(b)&&5<b.length){g=b.substr(5);g=String.fromCharCode(g.charCodeAt(0)).toLowerCase()+g.substr(1);var w=this;this.unbindEvent(c,g);this.bindEvent(c,g,null,null,function(b){w.invokeAction(a,b)})}else(g=J[b]||J.any)&&g(c||this._element,
a,b)}},bind:function(b,c,h,g,f,d){if(null==h)this.clearBinding(b,c);else{var n=this;h&&h.constructor==String&&/^window\./g.test(h)&&(n=a);var m=this.get_element()!=b;if(!m){var p=this["get_"+c];if(void 0==p||null==p)m=!0}switch(c){case "value":/input/gi.test(b.nodeName)&&(m=!0);this.addBinding(n,b,"value",h,g,m,f,d);break;case "text":this.addBinding(n,b,"text",h,!1,!0,f,d);break;default:this.addBinding(n,b,c,h,g,m,f,d)}}},onInitialized:function(){},init:function(){b.init.apply(this,arguments);var a=
this.get_element(),c=r.attributeMap(a,/^atom\-(name|local\-scope)$/gi),h=c["atom-name"];if(h){if(/^(app|window|owner|scope|localScope|parent)$/gi.test(h.value))throw Error("Invalid Control Name '"+h.value+"'");var g=this.get_scope();d.setValue(g,h.value,this);this._name=h.value;a.removeAttributeNode(h.node)}if(h=c["atom-local-scope"])this._scope=this._localScope=new H(this,this.get_scope(),atomApplication),this._name&&(this._localScope[this._name]=this),a.removeAttributeNode(h.node);if(a=this._scopeTemplates){var g=
this.get_scope(),f;for(f in a)d.setValue(g,f,a[f])}var m=this;n.dispatcher.callLater(function(){m.initProperties()});this.initChildren(this._element);n.dispatcher.callLater(function(){m.onInitialized()})},dispose:function(a){if(a){var c=a.atomControl;c?c.dispose():(this.clearBinding(a),this.disposeChildren(a));f(a).remove()}else this._disposed=!0,this.disposeChildren(this._element),this.clearBinding(),this.bindings.length=0,b.dispose.apply(this,arguments)},disposeChildren:function(b){for(var a=A.isIE&&
9>A.majorVersion,c=new y(b);c.next();){var g=c.current();g.atomControl?(g.atomControl.dispose(),a?g.atomControl=void 0:delete g.atomControl):(this.clearBinding(g),this.unbindEvent(g),this.disposeChildren(g))}try{b.innerHTML=""}catch(d){f(b).html("")}},get_innerTemplate:function(){return this._template},set_innerTemplate:function(b){if(this._template!==b||!this._created)if(this._created)this._template=b,this.disposeChildren(this._element),this.createChildren(),this.setProperties(this._element),this.initChildren(this._element),
this.updateUI();else{var a=this;n.dispatcher.callLater(function(){a.set_innerTemplate(b)})}},initChildren:function(b){for(var a=new y(b),c,g,d=[];a.next();)if(c=a.current(),"SCRIPT"==c.nodeName){g=f.trim(c.innerHTML);if(/^\(\{/.test(g)&&/\}\)$/.test(g))try{g=(new Function("return "+g+";"))();var n=this._localScope||this.get_scope(),m;for(m in g)n[m]||(n[m]=g[m])}catch(q){E(JSON.stringify(q)),alert(JSON.stringify(q))}d.push(c)}else(g=c.atomControl)?g.init():this.initChildren(c);for(a=new p(d);a.next();)b.removeChild(a.current())}}})})(m,
"WebAtoms.AtomControl",n.AtomUIComponent.prototype);(function(a,c){return classCreatorEx({name:"WebAtoms.AtomItemsControl",base:c,start:function(){this._selectedItems=[];this._selectedElements=[];this._onUIChanged=this._selectedIndexSet=!1;this._itemsPanel=this._itemsPresenter=null;this._presenters=["itemsPresenter"];this._childItemType=n.AtomControl},properties:{allowSelectFirst:!1,allowMultipleSelection:!1,uiVirtualize:!1,defaultValue:null,autoScrollToSelection:!1,selectAll:void 0,labelPath:"label",
valuePath:"value",sortPath:null,valueSeparator:null,postData:null,postUrl:null,confirm:!1,confirmMessage:null,filter:null,items:null,itemTemplate:null},methods:{get_postData:function(){return this._postData||this.get_selectedItem()},get_allValues:function(){if(this._valueSeparator&&this._valuePath){for(var b=[],a=this._valuePath,c=function(b){return b[a]},h=q.query(this.get_dataItems());h.next();)b.push(c(h.current()));return b.join(this._valueSeparator)}},get_value:function(){if(this._allowMultipleSelection){var b=
this._selectedItems;if(0==b.length)return void 0!==this._value?this._value:null;b=G.getValues(b,this._valuePath);this._valueSeparator&&(b=b.join(this._valueSeparator));return b}b=this.get_selectedItem();if(!b)return void 0!==this._value?this._value:null;this._valuePath&&(b=b[this._valuePath]);return b},set_value:function(b){this._value=b;if(void 0===b||null===b)d.clear(this._selectedItems);else{var a=this.get_dataItems();this._allowMultipleSelection&&this._valueSeparator?(b.constructor!=String&&(b=
""+b),b=G.split(b,this._valueSeparator)):b=[b];b=G.intersect(a,this._valuePath,b);this._selectedItems.length=0;for(b=new p(b);b.next();)this._selectedItems.push(b.current());d.refreshItems(this._selectedItems)}},set_sortPath:function(b){if(this._sortPath=b)this.onCollectionChangedInternal("refresh",-1,null)},set_selectAll:function(b){if(void 0!==b&&null!==b){this._selectedItems.length=0;var a=this.get_dataItems();if(b&&a)for(b=new p(a);b.next();)this._selectedItems.push(b.current());d.refreshItems(this._selectedItems)}},
refresh:function(){this._promises&&this._promises.items&&this._promises.items.invoke()},set_defaultValue:function(b){this.get_value()||d.setValue(this,"value",b)},invokePost:function(){if(this._onUIChanged&&(!this._confirm||confirm(this._confirmMessage)))if(this._postUrl){var b=this.get_postData();if(null!==b&&void 0!==b){var b=d.getClone(b),a=this,b=u.json(this._postUrl,null,{type:"POST",data:b});b.then(function(){a.invokeNext()});b.invoke()}}else this.invokeAction(this._next)},invokeNext:function(){this.invokeAction(this._next)},
set_filter:function(b){b!=this._filter&&(this._filter=b,this._filteredItems=null,this.applyFilter())},applyFilter:function(){if(this._filter&&this.hasItems())this.onCollectionChangedInternal("refresh",-1,null)},isSelected:function(b){for(var a=new p(this._selectedItems),c=null;a.next();)if(c=a.current(),c==b)return!0;return!1},get_dataItems:function(){var b=this._items;if(this.hasItems()){var a=this._filter;if(a){var c=[];if("object"==typeof a)c=q.query(b).where(a).toArray();else for(b=new p(b);b.next();){var h=
b.current();a(h,b.currentIndex())&&c.push(h)}b=this._filteredItems=c}var g=this._sortPath;g&&(g.constructor==String?(c=!1,a=g.indexOf(" "),-1!=a&&(c=g.substr(a+1),g=g.substr(0,a),c=/desc/gi.test(c)),a=c?function(b,a){return a[g].localeCompare(b[g])}:function(b,a){return b[g].localeCompare(a[g])},b=b.sort(a)):b=b.sort(g));return b}return f(this._itemsPresenter).children()},getIndexOfDataItem:function(b){if(null==b)return-1;for(var a=this.get_dataItems(),a=new p(a);a.next();)if(a.current()==b)return a.currentIndex();
return-1},getDataItemAtIndex:function(b){return-1==b?null:this.get_dataItems()[b]},get_childAtomControls:function(){for(var b=[],a=new y(this._itemsPresenter||this._element);a.next();){var c=a.current();(c=!c||c.atomControl)&&b.push(c)}return b},get_selectedChild:function(){var b=this.get_selectedItem();if(!this.hasItems())return b;for(var a=new y(this._itemsPresenter);a.next();){var c=a.current();if(c.atomControl.get_data()==b)return c}return null},set_allowSelectFirst:function(b){this._allowSelectFirst=
b?"false"!=b:b},get_selectedItem:function(){return 0<this._selectedItems.length?this._selectedItems[0]:null},set_selectedItem:function(b){b?(this._selectedItems.length=1,this._selectedItems[0]=b):this._selectedItems.length=0;d.refreshItems(this._selectedItems)},get_selectedItems:function(){return this._selectedItems},set_selectedItems:function(){throw Error("Not yet implemented");},get_selectedIndex:function(){var b=this.get_selectedItem();return this.getIndexOfDataItem(b)},set_selectedIndex:function(b){d.setValue(this,
"selectedItem",this.getDataItemAtIndex(b))},updateChildSelections:function(b,a,c){},bringSelectionIntoView:function(){if(!this._allowSelectFirst||0!=this.get_selectedIndex())for(var b=new y(this._itemsPresenter);b.next();){var a=b.current(),c=a.atomControl?a.atomControl.get_data():a;if(this.isSelected(c)){a.scrollIntoView();break}}},updateSelectionBindings:function(){d.refreshValue(this,"value");d.refreshValue(this,"selectedItem");d.refreshValue(this,"selectedItems");d.refreshValue(this,"selectedIndex")},
onSelectedItemsChanged:function(b,a,c){this._onUIChanged||(this.updateChildSelections(b,a,c),this._autoScrollToSelection&&this.bringSelectionIntoView());this.updateSelectionBindings();this.updateUI();this.invokePost()},hasItems:function(){return void 0!=this._items&&null!=this._items},get_items:function(){return this._items},set_items:function(b){var a=this;this._items&&this.unbindEvent(this._items,"CollectionChanged",null);this._items=b;this._filteredItems=null;null!=b&&(this.bindEvent(this._items,
"CollectionChanged",function(){a.onCollectionChangedInternal.apply(a,arguments)}),this.onCollectionChangedInternal("refresh",-1,null))},set_itemTemplate:function(b){this._itemTemplate=b;this.onCollectionChangedInternal("refresh",-1,null)},onCollectionChangedInternal:function(b,a,c){if(this._created){q.refresh(this,"allValues");var h=this.get_value();this.hasItems()&&(this.onCollectionChanged(b,a,c),h||this._allowSelectFirst||d.clear(this._selectedItems));if(null!=h&&(this.set_value(h),-1!=this.get_selectedIndex()))return;
this.selectDefault()}},selectDefault:function(){this._allowSelectFirst&&0<this.get_dataItems().length?this.set_selectedIndex(0):this.updateSelectionBindings()},onScroll:function(){this.scrollTimeout&&clearTimeout(this.scrollTimeout);var b=this;this.scrollTimeout=setTimeout(function(){b.scrollTimeout=0;b.onCollectionChangedInternal("refresh",-1,null)},1E3)},onCollectionChanged:function(b,a,c){var h;if(/remove/gi.test(b)){for(h=new y(this._itemsPresenter);h.next();){var g=h.current();if(g.atomControl&&
g.atomControl.get_data()==c){g.atomControl.dispose();f(g).remove();break}}this.updateUI()}else{var x=this.get_scope();if(h=this.getTemplate("itemTemplate"))if(h=f(h).attr("atom-type"))this._childItemType=h;if(/add/gi.test(b)){n.dispatcher.pause();b=new p(this._items);for(h=new y(this._itemsPresenter);b.next();){h.next();g=h.current();if(b.currentIndex()==a){x=this.createChildElement(x,this._itemsPresenter,c,b,g);this.applyItemStyle(x,c,b.isFirst(),b.isLast());break}if(b.isLast()){x=this.createChildElement(x,
this._itemsPresenter,c,b);this.applyItemStyle(x,c,b.isFirst(),b.isLast());break}}n.dispatcher.start();this.updateUI()}else{c=this._itemsPresenter;this.get_dataItems();this.disposeChildren(c);n.dispatcher.pause();b=this.get_dataItems(!0);for(b=new p(b);b.next();)h=b.current(),a=this.createChildElement(x,c,h,b),this.applyItemStyle(a,h,b.isFirst(),b.isLast());n.dispatcher.start();d.refreshValue(this,"childAtomControls")}}},set_innerTemplate:function(b){this._itemsPresenter=this._element;c.set_innerTemplate.apply(this,
arguments);this.onCollectionChangedInternal("mode",-1,null)},applyItemStyle:function(b,a,c,h){},createChildElement:function(b,a,c,h,g){this.getTemplate("itemTemplate");var f=r.cloneNode(this._itemTemplate);f._templateParent=this;g?a.insertBefore(f,g):a.appendChild(f);var d=new H(this,b,b.__application);h&&(d.itemIsFirst=h.isFirst(),d.itemIsLast=h.isLast(),d.itemIndex=h.currentIndex(),d.itemExpanded=!1,d.data=c,d.get_itemSelected=function(){return d.owner.isSelected(c)},d.set_itemSelected=function(b){d.owner.toggleSelection(c,
!0)});r.createControl(f,this._childItemType,c,d);return f},toggleSelection:function(b){this._onUIChanged=!0;this._value=void 0;this._allowMultipleSelection?r.contains(this._selectedItems,b)?d.removeItem(this._selectedItems,b):d.addItem(this._selectedItems,b):(this._selectedItems.length=1,this._selectedItems[0]=b,d.refreshItems(this._selectedItems));this._onUIChanged=!1},onUpdateUI:function(){c.onUpdateUI.call(this);for(var b=new y(this._itemsPresenter);b.next();){var a=b.current();if(a.atomControl){var k=
a.atomControl.get_data();d.refreshValue(a.atomControl.get_scope(),"itemSelected");this.applyItemStyle(a,k,b.isFirst(),b.isLast())}}},onCreated:function(){if(this._items)this.onCollectionChangedInternal("refresh",-1,null);var b=this;this.dispatcher.callLater(function(){b._autoScrollToSelection&&b.bringSelectionIntoView()})},init:function(){this.get_element();this._itemsPresenter||(this._itemsPresenter=this._element);var b=this;this.bindEvent(this._selectedItems,"CollectionChanged",function(){b.onSelectedItemsChanged.apply(b,
arguments)});c.init.apply(this,arguments);var a=this;this.removeItemCommand=function(b,c){if(c){var g=c.get_data();d.removeItem(a._items,g)}};this.removeSelectedCommand=function(b,c){for(var g=a.get_selectedItems().slice(0),g=new p(g);g.next();)d.removeItem(a.get_items(),g.current())};this.removeAllCommand=function(b,c){d.clear(a.get_items())}}}})})(m,n.AtomControl.prototype);(function(a,c){return classCreatorEx({name:"WebAtoms.AtomButton",base:c,start:function(b){this._sendData=!1;f(b).addClass("atom-button")},
properties:{sendData:!1},methods:{onClickHandler:function(b){r.cancelEvent(b);this._next&&(this._sendData&&this._next&&d.setValue(this._next,"data",this.get_data()),this.invokeAction(this._next));return!1},init:function(){this.bindEvent(this._element,"click","onClickHandler");c.init.apply(this)}}})})(m,n.AtomControl.prototype);(function(a,c){var b=a.AtomUI;return classCreatorEx({name:"WebAtoms.AtomDockPanel",base:c,start:function(b){f(b).addClass("atom-dock-panel")},properties:{resizeOnChildResized:!1,
contentWidth:0},methods:{resizeChild:function(b){b.atomControl?b.atomControl.updateUI():this.updateChildUI(b)},calculateSize:function(){var b=this.get_element(),a={width:f(b).width(),height:f(b).height()};if(!this._resizeOnChildResized)return a;for(var c=0,g=new y(b);g.next();){var d=g.current();switch(f(d).attr("atom-dock")){case "Bottom":case "Fill":case "Top":d=A.isIE&&10>A.majorVersion?d.offsetHeight:f(d).outerHeight(!0),c+=d}}a.height<c&&(a.height=c,f(b).height(a.height));return a},onUpdateUI:function(){var a=
this.get_element(),c=0,h=parseInt(f(a).css("paddingTop"),10),g=this.calculateSize(),d=g.height,g=g.width;this._contentWidth&&(c=(g-this._contentWidth)/2,g=this._contentWidth);var n,m,q;for(n=new p(f(a).children("[atom-dock='Top']"));n.next();)m=n.current(),q=f(m).outerHeight(!0),b.setItemRect(m,{top:h,left:c,width:g}),h+=q,d-=q,this.resizeChild(m);for(n=new p(f(a).children("[atom-dock='Bottom']").get().reverse());n.next();)m=n.current(),q=f(m).outerHeight(!0),d-=q,b.setItemRect(m,{left:c,top:h+d,
width:g}),this.resizeChild(m);for(n=new p(f(a).children("[atom-dock='Left']"));n.next();)m=n.current(),q=f(m).outerWidth(!0),g-=q,b.setItemRect(m,{top:h,left:c,height:d}),c+=q,this.resizeChild(m);for(n=new p(f(a).children("[atom-dock='Right']").get().reverse());n.next();)m=n.current(),q=f(m).outerWidth(!0),g-=q,b.setItemRect(m,{left:g+c,top:h,height:d}),this.resizeChild(m);for(n=new p(f(a).children("[atom-dock='Fill']"));n.next();){m=n.current();if(q=f(m).css("max-width"))q=parseFloat(q),0<q&&(g=
q);b.setItemRect(m,{left:c,top:h,width:g,height:d});this.resizeChild(m)}}}})})(m,n.AtomControl.prototype);(function(a,c){return classCreatorEx({name:"WebAtoms.AtomListBox",base:c,start:function(b){this._labelPath="label";this._valuePath="value";this._autoScrollToSelection=!1;f(b).addClass("atom-list-box")},properties:{autoSelectOnClick:!0},methods:{onClick:function(b){if(this._autoSelectOnClick)this.onSelectItem(null,null,b)},get_itemWidth:function(){return this._items&&this._items.length?f(this._element).innerWidth()/
this._items.length:0},applyItemStyle:function(b,a,c,h){f(b).removeClass("selected-item list-item first-item last-item");a&&(f(b).addClass("list-item"),c&&f(b).addClass("first-item"),h&&f(b).addClass("last-item"),this.isSelected(a)&&f(b).addClass("selected-item"))},onCreated:function(){this.bindEvent(this._itemsPresenter,"click","onClick");c.onCreated.call(this)},invokePost:function(){-1!=this.get_selectedIndex()&&c.invokePost.apply(this,arguments)},onSelectItem:function(b,a,c){b=this._itemsPresenter;
for(a=(c?c.target:null)||a._element;null!=a.parentNode&&a.parentNode!=b;)a=a.parentNode;a!=s&&(c=a,this.hasItems()&&(c=a.atomControl.get_data()),this.toggleSelection(c))},init:function(){c.init.call(this);var b=this;this.selectCommand=function(){b.onSelectItem.apply(b,arguments)};this.selectAllCommand=function(){b.set_selectAll(!0)};this.clearSelectionCommand=function(){b.set_selectedIndex(-1)}}}})})(m,n.AtomItemsControl.prototype);(function(a,c){return classCreatorEx({name:"WebAtoms.AtomAutoCompleteBox",
base:c,start:function(b){f(b).addClass("atom-auto-complete-box");this._presenters=["itemsPresenter","inputBox","selectionBox"];this._mouseCapture=0},properties:{isPopupOpen:!1,autoOpen:!1,selectedText:"",placeholder:void 0,keyPressed:void 0,displayLabel:void 0},methods:{get_offsetLeft:function(){return f(this._element).offset().left},get_offsetTop:function(){return f(this._element).offset().top},get_offsetWidth:function(){return f(this._inputBox).offset().width},set_itemsUrl:function(b){this.setValue("items",
"[ !$owner.keyPressed ? undefined : AtomPromise.json('"+b+"').showProgress(false) ]",!0,this._element)},set_isPopupOpen:function(b){if(this._isPopupOpen=b){d.refreshValue(this,"offsetTop");d.refreshValue(this,"offsetLeft");d.refreshValue(this,"offsetWidth");var c=this;this.trySelect();this.bindEvent(a,"click",function(){c.onWindowClick.apply(c,arguments)})}else this.unbindEvent(a,"click")},onSelectedItemsChanged:function(){this._onUIChanged&&0<this._selectedItems.length&&this.refreshLabel();c.onSelectedItemsChanged.apply(this,
arguments)},onClick:function(b){c.onClick.apply(this,arguments);this._backupValue=this.get_value();this.refreshLabel();this._backupLabel=this.get_displayLabel();d.setValue(this,"keyPressed",!1);d.setValue(this,"isPopupOpen",!1)},restoreSelection:function(){d.setValue(this,"isPopupOpen",!1);this._backupValue?(d.setValue(this,"value",this._backupValue),d.setValue(this,"displayLabel",this._backupLabel),this._backupValue=null):d.setValue(this,"selectedIndex",-1)},onKeyUp:function(b){d.setValue(this,"isPopupOpen",
!0);switch(b.keyCode){case 27:d.setValue(this,"keyPressed",!1);this.restoreSelection();return;case 13:return d.setValue(this,"keyPressed",!1),d.setValue(this,"isPopupOpen",!1),this._backupValue=this.get_value(),this.refreshLabel(),this._backupLabel=this.get_displayLabel(),r.cancelEvent(b);case 37:break;case 38:d.setValue(this,"keyPressed",!1);this.moveSelection(!0);return;case 39:break;case 40:d.setValue(this,"keyPressed",!1);this.moveSelection(!1);return;default:var a=this;this.dispatcher.callLater(function(){a.trySelect()})}this.oldTimeout&&
clearTimeout(this.oldTimeout);var c=this;this.oldTimeout=setTimeout(function(){d.setValue(c,"keyPressed",!0)},500)},trySelect:function(){if(this._items&&0!=this._items.length){var b=new p(this._items),a=this._labelPath,c=this._displayLabel;for(c&&(c=c.toLowerCase());b.next();){var h=b.current(),g=h;a&&(g=g[a]);if(0==g.toLowerCase().indexOf(c)){d.setValue(this,"selectedItem",h);d.setValue(this,"selectedText",g);this.bringSelectionIntoView();break}}}},moveSelection:function(b){if(this._items&&this._items.length){var a=
this.get_selectedIndex();-1==a&&(this.backupLabel=this.get_displayLabel());a=b?a-1:a+1;b&&-2==a&&(a=this._items.length-1);b||a!=this._items.length||(a=-1);d.setValue(this,"selectedIndex",a);-1==a?d.setValue(this,"displayLabel",this.backupLabel||""):this.refreshLabel()}},refreshLabel:function(){var b=this.get_selectedItem();b&&this._labelPath&&(b=b[this._labelPath]);d.setValue(this,"displayLabel",b||"")},onWindowClick:function(b){var a=this._element,c=this._itemsPresenter;for(b=b.target;null!=b.parentNode&&
b!=a&&b!=c;)b=b.parentNode;b!=a&&b!=c&&this.restoreSelection()},onInputFocus:function(){this._autoOpen&&(this._backupValue=this.get_value(),this._backupLabel=this.get_displayLabel(),d.setValue(this,"isPopupOpen",!0),f(this._inputBox).select())},onInputBlur:function(){if(!this._mouseCapture){var b=this;setTimeout(function(){b._isPopupOpen&&(d.setValue(b,"isPopupOpen",!1),b.restoreSelection())},10)}},onCreated:function(){this._itemsPresenter._logicalParent=this._element;f(this._itemsPresenter).remove();
s.body.appendChild(this._itemsPresenter);f(this._itemsPresenter).addClass("atom-auto-complete-popup");c.onCreated.apply(this,arguments);this.bindEvent(this._itemsPresenter,"mouseover","onMouseOver");this.bindEvent(this._itemsPresenter,"mouseout","onMouseOut")},onMouseOver:function(){this._mouseCapture++},onMouseOut:function(){var b=this;setTimeout(function(){b._mouseCapture--},1E3)},init:function(){c.init.apply(this,arguments);this.bindEvent(this._inputBox,"focus","onInputFocus");this.bindEvent(this._inputBox,
"blur","onInputBlur");this.bindEvent(this._inputBox,"keyup","onKeyUp")},dispose:function(){this._itemsPresenter&&(this.disposeChildren(this._itemsPresenter),f(this._itemsPresenter).remove(),this._itemsPresenter=null);c.dispose.call(this)}}})})(m,n.AtomListBox.prototype);(function(a,c){return classCreatorEx({name:"WebAtoms.AtomCheckBoxList",base:c,start:function(){this._allowMultipleSelection=!0;this._valueSeparator=", ";this._dataElements=[]},methods:{init:function(){c.init.call(this);f(this._element).addClass("atom-check-box-list")}}})})(m,
n.AtomItemsControl.prototype);(function(a,c){return classCreatorEx({name:"WebAtoms.AtomComboBox",base:c,start:function(){this._labelPath="label";this._valuePath="value";this._allowSelectFirst=!0},methods:{invokePost:function(){0<this.get_selectedIndex()&&c.invokePost.apply(this,arguments)},invokeNext:function(){c.invokeNext.apply(this,arguments);this._postUrl&&(d.setValue(this,"selectedIndex",0),this.updateChildSelections())},onSelectionChanged:function(){this._onUIChanged=!0;var b=this.get_element();
this.set_selectedIndex(b.selectedIndex);this._onUIChanged=!1},updateChildSelections:function(){this._element.selectedIndex=this.get_selectedIndex()},onCollectionChanged:function(b,a,c){b=this.get_element();a=this.get_dataItems();b.options.length=a.length;a=new p(a);c=this._labelPath;for(var h=this._valuePath,g=null,f=null,d=this.get_value();a.next();)g=f=a.current(),c&&(g=g[c]),h&&(f=f[h]),b.options[a.currentIndex()]=new Option(g,f,!1,f==d)},verifyTemplates:function(){},init:function(){var b=this.get_element();
this.bindEvent(b,"change","onSelectionChanged");c.init.apply(this,arguments)}}})})(m,n.AtomItemsControl.prototype);(function(a,c){return classCreatorEx({name:"WebAtoms.AtomDateListBox",base:c,start:function(b){this._monthList=z.monthList;b=new Date;this._month=b.getMonth()+1;this._year=b.getFullYear();this._selectedItems=[];this._presenters=["itemsPresenter"];this._startYear=-5;this._endYear=10;this._currentYear=(new Date).getFullYear();this._value=null},properties:{month:0,year:0,selectedItems:[],
startYear:-5,endYear:0,currentYear:0,monthList:null,items:void 0,month:null,visibleDate:void 0},methods:{set_month:function(b){this._month=b;this.updateList()},set_year:function(b){this._year=b;this.updateList()},set_visibleDate:function(b){b&&(this._visibleDate=b,this._year=b.getFullYear(),this._month=b.getMonth()+1,this.updateList(),d.refreshValue(this,"year"),d.refreshValue(this,"month"))},init:function(){c.init.apply(this);var b=this;this.toggleDateCommand=function(a,c){b.toggleDate.apply(b,arguments)}},
onLoaded:function(){var b=this.getTemplate("itemTemplate"),a=this.get_scope(),c=this._itemsPresenter,h=this.getTemplate("itemTemplate");h&&(h=f(h).attr("atom-type"),h||(h=n.AtomControl));this.updateList();if(b)for(var g=this._items,d=0;42>d;d++){var m=r.cloneNode(b);m._templateParent=this;var p=new H(this,a,atomApplication);p.itemIndex=d;f(c).append(m);r.createControl(m,h,g[d],p)}},toggleDate:function(b,a){var c=a.get_data(),h=f.inArray(c.value,f.map(this._selectedItems,function(b){return b.value}));
-1<h?d.removeAtIndex(this._selectedItems,h):d.addItem(this._selectedItems,c);d.refreshValue(this,"value");d.refreshValue(this,"selectedItems");this.invokeAction(this._next)},getItemClass:function(b,a){var c=-1<f.inArray(b.value,f.map(this._selectedItems,function(b){return b.value})),h=b.date.getDay(),c="atom-date-list-box-day-list-item "+(0==h||6==h?"atom-date-list-box-weekend ":"")+(c?"atom-date-list-box-selected ":"atom-date-list-box-item ");return c+=this._month==b.date.getMonth()+1?"":"atom-date-list-box-day-list-item-other"},
set_value:function(b){if(void 0!==b){this._selectedItems.length=0;if(null!==b){b=b.split(",");for(var a=0;a<b.length;a++){var c=b[a];if(c){var h=c.split("/"),h=new Date(parseInt(h[2],10),parseInt(h[0],10)-1,parseInt(h[1],10));this._selectedItems.push({date:h,dateLabel:z.toShortDateString(h),value:c,label:h.getDate()})}}}this._created&&(d.refreshItems(this._selectedItems),d.refreshValue(this,"value"),d.refreshValue(this,"selectedItems"))}},get_value:function(b){return f.map(this._selectedItems,function(b){return b.value}).join(",")},
updateList:function(){if(this._month&&this._year){var b=new Date,a=new Date(this._year,this._month-1,1);if(a.getDay()){var c=a.getDay()-1;a.setDate(-c)}for(var c=a.getMonth(),h=a.getFullYear(),g=[],f=0,n=this._month-1,f=0;42>f;f++){var m=f+a.getDate(),m=new Date(h,c,m),p=m.getDay(),p=0==p||6==p;g.push({label:m.getDate(),isWeekEnd:p,isToday:b.getDate()==m.getDate()&&b.getMonth()==m.getMonth()&&b.getFullYear()==m.getFullYear(),isOtherMonth:m.getMonth()!=n,dateLabel:z.toShortDateString(m),value:z.toMMDDYY(m),
date:m})}this._items=g;d.refreshValue(this,"items");d.refreshValue(this,"selectedItems");this._created&&d.refreshValue(this,"value")}}}})})(m,n.AtomControl.prototype);(function(a,c){return classCreatorEx({name:"WebAtoms.AtomPostButton",base:c,start:function(){},properties:{postData:null,postResult:null,postUrl:null,next:null,confirm:!1,confirmMessage:null,mergeData:null},methods:{get_postData:function(){return this._postData||this.get_data()},onClickHandler:function(b){if(this._confirm){var a=this;
q.confirm(this._confirmMessage,function(){a.onConfirmed(b)})}else this.onConfirmed(b)},onConfirmed:function(b){if(this._postUrl){var a=this.get_postData();if(null!==a&&void 0!==a){var k=this._mergeData;if(k)for(var h in k)a[h]=k[h];var g=this;u.json(this._postUrl,null,{type:"POST",data:a}).then(function(b){d.setValue(g,"postResult",b.value());g.invokeAction(g._next)}).invoke()}}else c.onClickHandler.apply(this,arguments)}}})})(m,n.AtomButton.prototype);(function(a,c){return classCreatorEx({name:"WebAtoms.AtomToggleButtonBar",
base:c,start:function(b){this._allowSelectFirst=!0;this._autoScrollToSelection=this._showTabs=this._allowMultipleSelection=!1;f(b).removeClass("atom-list-box")},properties:{showTabs:!1},methods:{init:function(){c.init.call(this);this.setValue("class","[$owner.showTabs ? 'atom-tab-button-bar' : 'atom-toggle-button-bar']",!0,this._element)}}})})(m,n.AtomListBox.prototype);(function(a,c){return classCreatorEx({name:"WebAtoms.AtomViewStack",base:c,start:function(b){this._swipeDirection="left-right"},
properties:{selectedIndex:-1,swipeDirection:"left-right"},methods:{bringSelectionIntoView:function(){},set_swipeDirection:function(b){var a=this._swipeDirection;a&&f(this._element).removeClass(a);(this._swipeDirection=b)&&f(this._element).addClass(b)},set_selectedIndex:function(b){this._previousIndex=this._selectedIndex;this._selectedIndex=b;this.updateUI()},onUpdateUI:function(){var b=this._element,a=new y(b),c=this.get_selectedIndex(),h=new n.AtomDispatcher;h.pause();for(var g=-1,d=this;a.next();){var g=
g+1,m=a.current();f(m).addClass("view-stack-child");g==c?(r.setItemRect(m,{width:f(b).width(),height:f(b).height()}),f(m).removeClass("hidden"),this._lastSelectedChild=m,h.callLater(function(){var b=d._lastSelectedChild.atomControl;b&&b.updateUI()})):f(m).addClass("hidden")}h.start()},init:function(){var b=this.get_element();f(b).addClass("atom-view-stack");c.init.call(this);b=this.get_element();b.parentNode.atomControl||f(b).addClass("atom-view-stack-fill");f(b).addClass(this._swipeDirection)}}})})(m,
n.AtomControl.prototype);this.atomApplication=this.appScope=null;(function(a,c,b){return classCreator(c,b,function(b){f(b).removeClass("atom-dock-panel");f(b).addClass("atom-application");this._scope=new H(this,null,this);a.appScope=this._scope;a.model&&(this._data=a.appScope.model=a.model);a.atomApplication=this;location.hash?(b=location.hash.substring(1),this._urlScope=r.parseUrl(b)):this._urlScope={};this.onHashChanged();this.busyCount=0},{get_title:function(){return a.document.title},set_title:function(b){a.document.title=
b},get_isBusy:function(){return this.busyCount},setBusy:function(b,a){b?this.busyCount++:this.busyCount--;void 0!==a?(a||(a=""),d.setValue(this,"busyMessage",a)):d.setValue(this,"busyMessage","Loading...");d.refreshValue(this,"isBusy")},updateUI:function(){b.updateUI.call(this);d.refreshValue(this,"appWidth");d.refreshValue(this,"appHeight");d.refreshValue(this,"bodyWidth");d.refreshValue(this,"bodyHeight")},onUpdateUI:function(){this._renderAsPage||b.onUpdateUI.call(this)},get_appWidth:function(){return f(this._element).width()},
get_appHeight:function(){return f(this._element).height()},get_bodyWidth:function(){return f(s.body).width()},get_bodyHeight:function(){return f(s.body).height()},onHashChanged:function(){if(!this._noHashRefresh){var b=this._scope,a=location.hash?location.hash:this._defaultScope;if(a){this._noHashRefresh=!0;a=a.substr(1);a=r.parseUrl(a);if(this._created)for(var c in a){var g=a[c];b[c]!=g&&d.setValue(b,c,g)}else q.merge(b,a);this._noHashRefresh=!1}}},invokeUpdateUI:function(){var b=this;a.setTimeout(function(){return b.updateUI()},
5)},onRefreshValue:function(b,a){if(!this._noHashRefresh&&0!=a.indexOf("_")){var c=this._scope[a];if(void 0!==c&&null!==c&&(c=typeof c,"string"==c||"number"==c||"boolean"==c)){var c={},g=this._scope,f=this._defaultScopeValues||{},d;for(d in g){var m=g[d];if(this._urlScope[d]||m!=f[d])c[d]=m}(d=q.encodeParameters(c))?(d="#"+d,location.hash!=d&&(this._noHashRefresh=!0,history&&history.pushState?history.pushState({},s.title,location.href.split("#")[0]+d):location.href=d,this._noHashRefresh=!1)):history&&
history.pushState?history.pushState({},s.title,location.href.split("#")[0]):location.hash=""}}},onInitialized:function(){var a={},c=this._scope,h;for(h in c)if(0!=h.indexOf("_")){var g=c[h];if(void 0!==g&&null!==g){var d=typeof g;if("string"==d||"number"==d||"boolean"==d)a[h]=g}}this._defaultScopeValues=a;if(a=q.encodeParameters(this._scope))this._defaultScope="#"+a;b.onInitialized.call(this)},createChildren:function(){b.createChildren.call(this);this.getTemplate("busyTemplate");this._busyTemplate&&
(this._element.appendChild(this._busyTemplate),this.onCreateChildren(this._busyTemplate))},onCreated:function(){b.onCreated.call(this);if(A.isIE&&8>A.majorVersion){var c=this;setInterval(function(){c.onCheckHash()},1E3);this._lastHash=location.hash}else this.bindEvent(a,a.onhashchange?"onhashchange":"hashchange","onHashChanged");this._next&&n.dispatcher.callLater(function(){a.atomApplication.invokeAction(a.atomApplication._next)})},onCheckHash:function(){this._lastHash!=location.hash&&(this.onHashChanged(),
this._lastHash=location.hash)},onCloseCommand:function(){if(parent){var b=frameElement.atomWindow;b._value=this._value;b.onCloseCommand()}},setup:function(){this.createChildren();this.init()},onInitialized:function(){b.onInitialized.apply(this,arguments);this._renderAsPage||f(this._element).addClass("atom-dock-application")},init:function(){this.bindEvent(a,"resize","invokeUpdateUI");var c=this;this._onRefreshValue=function(){c.onRefreshValue.apply(c,arguments)};this._scope._$_watcher=this;b.init.call(this);
this.closeCommand=function(){c.onCloseCommand.apply(c,arguments)}}},{renderAsPage:!1,busyMessage:"",progress:0})})(m,"WebAtoms.AtomApplication",n.AtomDockPanel.prototype);(function(a){return classCreatorEx({name:"WebAtoms.AtomForm",base:a,start:function(){this._attachments=this._error=this._submit=this._success=null},properties:{result:null,mergeData:null,mergeResult:!0,postUrl:null,postData:null,successMessage:null,clearData:!1},methods:{createFormLayout:function(){},preparePostData:function(){this.get_element();
var a=this._postData||this.get_data(),b=this._mergeData;if(b)for(var e in b)a[e]=b[e];return a},onSubmit:function(){if(this.isValid()){var a=this.preparePostData(),b=u.getUrl(this._postUrl);u.json(b,{_tv:q.time()},{type:"POST",data:a}).then(this._success).invoke()}},onSuccess:function(a){a=a.value();d.setValue(this,"result",a);if(this._mergeResult){var b=this.get_data(),e;for(e in a)d.setValue(b,e,a[e])}if(this._clearData)for(e in b=this.get_data(),this._clearData)d.setValue(b,e,a[e]);this._successMessage&&
q.alert(this._successMessage);this.invokeAction(this._next)},onKeyUp:function(a){if(!(a.target&&a.target.nodeName&&/textarea/gi.test(a.target.nodeName))&&13==a.keyCode){var b=this;/input/gi.test(a.target.nodeName)&&f(a.target).change();n.dispatcher.callLater(function(){b.onSubmit()})}},isValid:function(){for(var a=this.get_element(),a=new y(a),b=!0;a.next();){var e=a.current();this.validate(e)||(b=!1)}return b},validateField:function(a){this.validate(a.target)},validate:function(a,b){b||(b=f(a).data("field-error"));
var e=a.atomControl,k=null,h=!1;if(e){if(e.constructor==n.AtomFormField)return e.validate();k=d.getValue(e,"value")}else/input|select|textarea/i.test(a.nodeName)?k=f(a).val():h=!0;if(!h){if(f(a).attr("atom-required")&&!k)return f(b).text("Required"),f(a).addClass("atom-data-error"),!1;if(e=f(a).attr("atom-regex"))e=eval("("+e+")");else if(h=f(a).attr("atom-data-type"))switch(h){case "email":e=/^(([^<>()\[\]\\.,;:\s@\"]+(\.[^<>()\[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/}if(e&&
!e.test(k))return f(b).text("Invalid"),f(a).addClass("atom-data-error"),!1;f(b).text("");f(a).removeClass("atom-data-error")}k=new y(a);for(e=!0;k.next();)this.validate(k.current(),b)||(e=!1);return e},init:function(){a.init.call(this);var c=this;this._success=function(){c.onSuccess.apply(c,arguments)};this._submit=function(){c.onSubmit.apply(c,arguments)};var b=this.get_element();this.submitCommand=this._submit;this.bindEvent(b,"keyup","onKeyUp");f(b).find("input[type=submit]").bind("click",null,
this._submit);f(b).find("button[type=submit]").bind("click",null,this._submit);c=this;this._vh=function(){c.validateField.apply(c,arguments)};f(b).find("input,select,textarea").bind("blur",null,this._vh)}}})})(n.AtomControl.prototype);(function(a){return classCreatorEx({name:"WebAtoms.AtomFormLayout",base:a,start:function(){this._useTable=!0;this._errorItems=[];this._minLabelWidth=0},properties:{minLabelWidth:0},methods:{createField:function(a,b){var e=r.attributeMap(b,/^(atom\-(type|label|required|regex|data\-type|is\-valid|field\-(value|visible|class)|error))$/i),
k=e["atom-type"];if(k)switch(e["atom-type"]=null,k.value){case "AtomFormGridLayout":case "AtomFormTab":return a.appendChild(b),r.createControl(b,k.value)}var k=r.cloneNode(this._fieldTemplate),h=r.findPresenter(k);h?(h.appendChild(b),f(h).removeAttr("atom-presenter")):k.contentElement=b;a.appendChild(k);for(var g in e)if(h=e[g])b.removeAttributeNode(h.node),k.setAttributeNode(h.node);e=r.attributeMap(k,/^atom\-(field\-value|is\-valid)$/i);e["atom-field-value"]||e["atom-is-valid"]||(h=f(b).attr("atom-value"))&&
/^\$\[/gi.test(h)&&(h=h.substr(2),/^\$/gi.test(h)||(h="$"+h),h="["+h,e=h.indexOf("]"),h=h.substr(0,e+1),f(k).attr("atom-field-value",h));return r.createControl(k,n.AtomFieldType)},createChildren:function(){var a=this._element;f(a).addClass("atom-form");var b=new p(f(a).children()),e=s.createElement("TABLE");f(e).addClass("atom-form-table");var k=s.createElement("TBODY");r.removeAllChildren(a);a.appendChild(e);e.appendChild(k);for(this.getTemplate("fieldTemplate");b.next();)(a=b.current())&&this.createField(k,
a)}}})})(n.AtomControl.prototype);(function(){return classCreatorEx({name:"WebAtoms.AtomLayout",start:function(){},methods:{doLayout:function(){}}})})();(function(a){return classCreatorEx({name:"WebAtoms.AtomWindow",base:a,start:function(){this._presenters=["windowDiv","windowTitleDiv","windowCloseButton","iframe","windowPlaceholder"]},properties:{opener:null,openerData:null,windowTemplate:null,isOpen:!1,windowHeight:300,windowWidth:500,url:void 0,title:void 0},methods:{get_openerData:function(){var a=
this.get_opener();if(a)return a.get_data()},onCloseCommand:function(a,b){d.setValue(this,"isOpen",!1);var e=this._value,k=this;this._value=null;this.disposeChildren(this._element);setTimeout(function(){d.setValue(k,"value",e);k.invokeAction(k._next)},1)},refresh:function(a,b){this.openWindow(a,b)},openWindow:function(a,b){var e=this.getTemplate("frameTemplate"),e=r.cloneNode(e),k=f(e).find("[atom-presenter=windowDiv]").get(0);f(e).find("[atom-presenter=windowTitleDiv]").get(0);var h=this.getTemplate("windowTemplate");
f(h).addClass("atom-window-template");f(h).attr("atom-dock")||f(h).attr("atom-dock","Fill");if(h.length)for(var g=0;g<h.length;g++)k.appendChild(h[g]);else k.appendChild(h);if(h=this.getTemplate("commandTemplate"))h.setAttribute("atom-dock","Bottom"),h.setAttribute("class","atom-wizard-command-bar"),k.appendChild(h);this.set_innerTemplate(e);this._iframe&&(this._iframe.atomWindow=this);b&&(this._opener=b,d.refreshValue(this,"opener"),d.refreshValue(this,"openerData"));var m=this;n.dispatcher.callLater(function(){d.setValue(m,
"isOpen",!0);if(!m._url){var b=f(m._windowPlaceholder).find("input");if(0<b.length){b=b.get(0);try{b.focus()}catch(a){}}}})},init:function(){f(this._element).addClass("atom-window-placeholder");a.init.call(this);var c=this;this.closeCommand=function(){c.onCloseCommand.apply(c,arguments)};this.openCommand=function(){c.openWindow.apply(c,arguments)};n.dispatcher.callLater(function(){c._element._logicalParent=c._element.parentNode;f(c._element).remove();s.body.appendChild(c._element)})}}})})(n.AtomControl.prototype);
(function(a,c){return classCreatorEx({name:"WebAtoms.AtomCalendar",start:function(){},properties:{currentMonth:(new Date).getMonth()+1,currentYear:(new Date).getFullYear(),startDate:null,endDate:null},methods:{set_currentMonth:function(b){this._currentMonth=b;this.updateCalendar()},set_currentYear:function(b){this._currentYear=b;this.updateCalendar()},onCreated:function(){c.onCreated.call(this);this.updateCalendar()},applyItemStyle:function(b,a,c,h){f(b).removeClass("other weekend today");f(b).addClass("calendar-item");
a.IsOtherMonth&&f(b).addClass("other");a.IsWeekEnd&&f(b).addClass("weekend");a.IsToday&&f(b).addClass("today")},updateCalendar:function(){if(this._created){for(var b=this._currentMonth-1,a=new Date(this._currentYear,b,1);0<a.getDay();){var c=new Date(a.getTime());c.setDate(a.getDate()-1);a=c}var h=[],g=new Date(a.getTime());g.setDate(g.getDate()+42);for(var f=a;f.getTime()<g.getTime();)c=new Date(f.getTime()),c.setDate(f.getDate()+1),h.push({value:f,label:f.getDate(),next:c,IsOtherMonth:f.getMonth()!=
b,IsWeekEnd:0==f.getDay()||6==f.getDay(),IsToday:f.getDate()==now.getDate()&&f.getMonth()==now.getMonth()}),f=c;d.setValue(this,"items",h);d.setValue(this,"startDate",a);d.setValue(this,"endDate",g)}},changeMonth:function(b){var a=this._currentMonth,a=a+b;12<a&&(a=1,this._currentYear+=1);0==a&&(this._currentYear-=1,a=12);d.setValue(this,"currentMonth",a)},init:function(){c.init.call(this);var b=this;this.nextMonthCommand=function(){b.changeMonth(1)};this.prevMonthCommand=function(){b.changeMonth(-1)}}}})})(m,
n.AtomListBox.prototype);(function(a,c,b){return classCreatorEx({name:c,base:b,properties:{itemsPath:"items",totalPath:"total",pageSize:25,currentPage:0,items:null,total:0,pages:[]},start:function(){this._presenters=["pageList"];var b=this,a=d;this.goFirstCommand=function(){a.setValue(b,"currentPage",0)};this.goLastCommand=function(){a.setValue(b,"currentPage",b._pages.length-1)};this.goNextCommand=function(){a.setValue(b,"currentPage",b.get_currentPage()+1)};this.goPrevCommand=function(){a.setValue(b,
"currentPage",b.get_currentPage()-1)}},methods:{preparePages:function(){if(this._items&&this._total){var b=Math.ceil(this._total/this._pageSize);if(b!=this._pages.length){var a=[],c;for(c=0;c<b;c++)a.push({value:c,label:c+1});d.setValue(this,"pages",a)}}},set_items:function(b){b!=this._items&&this._items&&this.unbindEvent(this._items,"CollectionChanged","onCollectionChangedInternal");b&&(this._items=b,null!=b&&this._created&&(this.bindEvent(this._items,"CollectionChanged","onCollectionChangedInternal"),
this.onCollectionChangedInternal("refresh",-1,null)))},onCollectionChangedInternal:function(){var b=this._items;if(void 0===b.length){var a=b[this._itemsPath];d.setValue(this,"total",b[this._totalPath]);d.setValue(this,"value",a)}else b.total?d.setValue(this,"total",b.total):d.setValue(this,"pages",[]),d.setValue(this,"value",b);this.preparePages()},onCreated:function(){this._items&&(this.bindEvent(this._items,"CollectionChanged","onCollectionChangedInternal"),this.onCollectionChangedInternal("refresh",
-1,null))},set_currentPage:function(b){this._currentPage=b;d.refreshValue(this,"pageStart")},get_pageStart:function(){return this._currentPage*this._pageSize},set_pageSize:function(b){this._pageSize=b;this.preparePages()},set_total:function(b){this._total!=b&&(this._total=b)},init:function(){f(this._element).addClass("atom-data-pager");b.init.apply(this,arguments)}}})})(m,"WebAtoms.AtomDataPager",n.AtomControl.prototype);(function(a,c){return classCreatorEx({name:"WebAtoms.AtomDateControl",base:c,
start:function(){},properties:{startYear:-1,endYear:10},methods:{resetYears:function(){var b=this._year,a=new Date,c=a.getFullYear(),c=c+this._startYear,h=a.getFullYear()+this._endYear;b.options.length=0;var g=1;b.options[0]=new Option("Select","",!1,!1);for(a=(this._value||new Date).getFullYear();c<=h;c++)b.options[g]=new Option(c,c,!1,a==c),g++},set_value:function(b){b&&b.constructor==String&&(b=new Date(parseInt(b.substr(6))));this._value=b;this.setDate()},setDate:function(){if(this._value){var b=
this._value,a=b.getMonth()+1,c=b.getDate(),b=b.getFullYear();this.setComboValue(this._month,a);this.setComboValue(this._year,b);this.setComboValue(this._date,c)}},setComboValue:function(b,a){for(var c=new p(b.options);c.next();)if(c.current().value==a){b.selectedIndex=c.currentIndex();break}},set_startYear:function(b){this._startYear=b;this.resetYears()},set_endYear:function(b){this._endYear=b;this.resetYears()},onDataChange:function(){var b=f(this._year).val(),a=f(this._month).val(),c=f(this._date).val();
try{this._value=b&&a&&c?new Date(b,a-1,c,9,0,0):null}catch(h){q.alert(h)}d.refreshValue(this,"value")},setMonths:function(){var b=z.monthList,a=this._month.options;a.length=0;b=new p(b);for(a[0]=new Option("Select","",!1,!1);b.next();){var c=b.current();a[b.currentIndex()+1]=new Option(c.label,c.value,!1,!1)}this.setDate();d.refreshValue(this,"value")},init:function(){var b=this._element;this._date=s.createElement("SELECT");this._month=s.createElement("SELECT");this._year=s.createElement("SELECT");
b.style.height="25px";b.appendChild(this._date);b.appendChild(this._month);b.appendChild(this._year);var b=this._date.options,a;b[0]=new Option("Select","",!1,!1);for(a=1;32>a;a++)b[a]=new Option(a,a,!1,!1);this.resetYears();this.bindEvent(this._date,"change","onDataChange");this.bindEvent(this._month,"change","onDataChange");this.bindEvent(this._year,"change","onDataChange");this.setMonths();c.init.apply(this,arguments)}}})})(m,n.AtomControl.prototype);(function(a,c){return classCreatorEx({name:"WebAtoms.AtomDateField",
base:c,start:function(b){this._presenters=["calendarPresenter","itemsPresenter"];f(b).addClass("atom-date-field")},properties:{isOpen:!1,time:"9:00 AM"},methods:{get_offsetLeft:function(){return f(this._element).offset().left},get_offsetTop:function(){return f(this._element).offset().top},onPopupRemoved:function(b){d.setValue(this,"isOpen",!1)},set_isOpen:function(b){if(this._isOpen=b){this.getTemplate("popupTemplate");this.popup=r.cloneNode(this._popupTemplate);this.popup._logicalParent=this._element;
this.popup._templateParent=this;s.body.appendChild(this.popup);this.onCreateChildren(this.popup);this.setProperties(this.popup);this.initChildren(this.popup);var a=this;this._refreshInterval=setInterval(function(){d.refreshValue(a,"offsetLeft");d.refreshValue(a,"offsetTop")})}else this._refreshInterval&&clearInterval(this._refreshInterval),this.popup&&(this.disposeChildren(this.popup),f(this.popup).remove(),this.popup=null)},dispose:function(){this.set_isOpen(!1);c.dispose.call(this)},get_isOpen:function(){return this._isOpen},
get_selectedItem:function(){return this._selectedItems.length?this._selectedItems[0]:null},set_time:function(b){this._set_timeCalled||(this._set_timeCalled=!0,b&&(this._time=b,b=z.setTime(this.get_value(),b),d.setValue(this,"value",b)),this._set_timeCalled=!1)},set_value:function(b){this._value=b=z.parse(b);d.setValue(this,"time",z.toTimeString(b));this._selectedItems.length=0;b&&(this._selectedItems.push({date:b,dateLabel:z.toShortDateString(b),value:z.toMMDDYY(b),label:b.getDate()}),this.set_visibleDate(b));
this._created&&(d.refreshItems(this._selectedItems),d.refreshValue(this,"value"),d.refreshValue(this,"selectedItem"),d.refreshValue(this,"selectedItems"))},get_value:function(b){return this._selectedItems.length?this._selectedItems[0].date:this._value},toggleDate:function(b,a){var c=a.get_data();this._selectedItems.length=0;d.addItem(this._selectedItems,c);d.refreshValue(this,"value");d.refreshValue(this,"selectedItem");d.refreshValue(this,"selectedItems");d.setValue(this,"isOpen",!1)}}})})(m,n.AtomDateListBox.prototype);
(function(a,c){return classCreatorEx({name:"WebAtoms.AtomDeleteButton",base:c,start:function(){this._confirm=!0;this._confirmMessage="Are you sure you want to delete this item?"},methods:{},properties:{}})})(m,n.AtomPostButton.prototype);(function(a,c){return createClass({name:"WebAtoms.AtomFrameView",base:c,start:function(b){var a=this;f(b).addClass("atom-frame-view");this._items=[];this._layout=n.AtomViewBoxLayout.defaultInstance;this.backCommand=function(){a.onBackCommand.apply(a,arguments)}},
properties:{url:"",layout:null,items:[],removeOnBack:!0},methods:{set_url:function(b){if(b){var a=b.indexOf("?"),c=b,h="";-1!==a&&(c=b.substr(0,a),h=b.substr(a+1));b=this._items;a=q.query(b).firstOrDefault({url:c});if(!a){var g=q.get(this,"scope")[c];if(!g){console&&console.error&&console.error("Page Template "+g+" not found");return}g=r.cloneNode(g);a={url:c,index:b.length,element:g};q.add(b,a);this._element.appendChild(g);var f=r.createControl(g,n.AtomControl);a.control=f;n.dispatcher.callLater(function(){f.init()})}q.set(this,
"selectedIndex",a.index);h&&n.dispatcher.callLater(function(){location.hash=h})}},onBackCommand:function(){var b=this._selectedIndex;if(b){var a=q.query(this._items).firstOrDefault({index:b});if(a){var c=this;this._selectedIndex=b-1;q.refresh(this,"selectedIndex");n.dispatcher.callLater(function(){if(c._removeOnBack){a.control.dispose();f(a.element).remove();q.remove(c._items,a);for(var b=q.query(c._items),g=0;b.next();)b.current().index=g++}c.updateUI()})}}},init:function(){c.init.call(this);var b=
this,a=this._url;a&&n.dispatcher.callLater(function(){b.set_url(a)})}}})})(m,n.AtomViewStack.prototype);(function(a,c){return classCreatorEx({name:"WebAtoms.AtomLinkBar",base:c,start:function(){this._allowSelectFirst=!1;var b=this;this.openMenuCommand=function(){b.openMenu.apply(b,arguments)}},properties:{itemsPath:"items",selectCurrent:!0,targetPath:"",menuTemplate:null,menuDirection:"horizontal"},methods:{onClick:function(){},openMenu:function(b){var a=this.get_atomParent(b.target);if(null!=a){var c=
a.get_data();if(c[this._itemsPath]){var h=this._subMenu;if(h)I.hide(h._element);else{var g=this.getTemplate("menuTemplate"),h=r.cloneNode(g);h._templateParent=this;h.style.position="absolute";s.body.appendChild(h);g=f(h).attr("atom-type")||n.AtomControl;this._subMenu=h=r.createControl(h,g,c)}d.setValue(h,"data",c);I.show(a._element,h._element,0);r.cancelEvent(b)}}},selectDefault:function(){this._items&&this._selectCurrent&&!this._value&&(d.setValue(this,"value",location.pathname),-1==this.get_selectedIndex()&&
this.selectItem(this._items),this.updateSelectionBindings())},selectItem:function(b,a){for(var c=new p(b),h=this._valuePath,g=location.pathname.toLowerCase();c.next();){var f=c.current(),m=f;h&&(m=m[h]);if(m){if(g==m.toLowerCase())return a||d.setValue(this,"selectedItem",f),!0;if(f.links&&this.selectItem(f.links,!0))return d.setValue(this,"selectedItem",f),!0}}return!1},dispose:function(){this._subMenu&&(this._subMenu.dispose(),this._subMenu=null);c.dispose.apply(this,arguments)},init:function(){c.init.apply(this,
arguments);this.bindEvent(this._element,"click","openMenuCommand");this.setValue("class","[$owner.showTabs ? 'atom-tab-button-bar' : 'atom-link-bar']",!0,this._element)}}})})(m,n.AtomToggleButtonBar.prototype);(function(a,c){return classCreatorEx({name:"WebAtoms.AtomMultiButtonList",base:c,start:function(){this._dataElements=[]},properties:{labelPath:"label",valuePath:"value",options:null,isRadio:!1,items:null},methods:{set_options:function(b){if(this._options=b)this.onCollectionChangedInternal("refresh",
-1,null)},set_value:function(b){this._value=b;this.updateSelections()},set_items:function(b){this._items&&this.unbindEvent(this._items,"CollectionChanged","onCollectionChangedInternal");this._items=b;null!=b&&(this.bindEvent(this._items,"CollectionChanged","onCollectionChangedInternal"),this.onCollectionChangedInternal("refresh",-1,null))},onCollectionChangedInternal:function(b,a,c){var h=this.get_value();this.onCollectionChanged(b,a,c);this.set_value(h)},onCollectionChanged:function(b,a,c){if(this._items&&
this._options){this._dataElements=[];this.unbindEvent(null,"change","onDataChange");b=new p(this._items);for(a=this.get_scope();b.next();)c=b.current(),this.createChildElement(a,this._element,c);this.updateUI()}},updateSelections:function(){if(this._dataElements&&0!=this._dataElements.length){for(a=new p(this._dataElements);a.next();)f(a.current()).attr("checked",!1);if(this._value){var b,a,c,h=this._value.split(",");a.reset();for(var g;a.next();)for(g=a.current(),b=new p(h);b.next();)c=b.current(),
c=f.trim(c),f(g).val()==c&&f(g).attr("checked","true")}}},onDataChange:function(){for(var b=new p(this._dataElements),a=[];b.next();){var c=b.current(),h=f(c).val();f(c).attr("checked")&&a.push(h)}this._value=a.join(", ");d.refreshValue(this,"value")},createChildElement:function(b,a,c){b=s.createElement("SPAN");a.appendChild(b);a=b;b=s.createElement("SPAN");var h=this.get_labelPath(),g=this.get_valuePath();v=l=c;h&&(l=c[h]);g&&(v=c[g]);c=null;this._isRadio&&(c="_g"+r.getNewIndex());a.appendChild(b);
for(h=new p(this._options);h.next();){var d=h.current();g&&(d=d[g]);var d=v+"."+d,m=s.createElement("INPUT");this._isRadio?(f(m).attr("type","radio"),f(m).attr("name",c)):f(m).attr("type","checkbox");f(m).val(d);b.appendChild(m);this.bindEvent(m,"change","onDataChange");this._dataElements.push(m)}b=s.createElement("SPAN");a.appendChild(b);a=s.createTextNode(l);b.appendChild(a)}}})})(m,n.AtomControl.prototype);(function(a,c){return classCreatorEx({name:"WebAtoms.AtomNavigatorList",base:c,start:function(){this._displayMode=
0;this._presenters="gridPanel gridPresenter itemsPresenter detailHeaderPresenter newHeaderPresenter detailPresenter newPresenter newView detailView newHeaderToolbar detailHeaderToolbar".split(" ");this._layout=new n.AtomViewBoxLayout;this._newItem={}},properties:{autoShowDetail:!0,currentPage:null,pageSize:void 0,newItem:null,newUrl:null,detailUrl:null,displayMode:null},methods:{get_newItemCopy:function(){return this._newItemCopy},onBackCommand:function(){d.setValue(this,"displayMode",0);this.updateDisplayMode();
d.setValue(this,"selectedIndex",-1)},onCancelAddNewCommand:function(){this.onBackCommand();d.refreshValue(this,"newItemCopy");this.refresh()},onAddCommand:function(){d.setValue(this,"selectedIndex",-1);d.setValue(this,"displayMode",2);this._newItemCopy=d.getClone(this._newItem||{});d.refreshValue(this,"newItemCopy");this.updateDisplayMode()},onSelectedItemsChanged:function(){c.onSelectedItemsChanged.apply(this,arguments);this._autoShowDetail&&this.showDetailCommand()},addTemplate:function(b,a,c){c?
(b.appendChild(a),a._templateParent=this,this.onCreateChildren(b),this.initChildren(b)):(b.appendChild(a),a._templateParent=this,this.onCreateChildren(b))},updateDisplayMode:function(){var b=this._displayMode;if(0==b)this._detailPresenter&&(this._detailView.atomControl.dispose(this._detailPresenter),this._detailPresenter=null),this._newPresenter&&(this._newView.atomControl.dispose(this._newPresenter),this._newPresenter=null),this._detailHeaderPresenter&&(this._detailView.atomControl.dispose(this._detailHeaderPresenter),
this._detailHeaderPresenter=null),this._newHeaderPresenter&&(this._newView.atomControl.dispose(this._newHeaderPresenter),this._newHeaderPresenter=null);else{var a=null,c=this.getTemplate("detailTemplate"),h=null,g="";1==b?(a=this._detailView,h=this._detailHeaderToolbar,b=this.getTemplate("detailHeaderTemplate"),g="_detail"):(a=this._newView,h=this._newHeaderToolbar,b=this.getTemplate("newHeaderTemplate"),g="_new");h&&b&&(b=r.cloneNode(b),this.addTemplate(h,b,!0),this[g+"HeaderPresenter"]=b);a&&c&&
(c=r.cloneNode(c),this.addTemplate(a,c,!0),this[g+"Presenter"]=c)}},createChildren:function(){c.createChildren.call(this);this.getTemplate("gridTemplate");this.getTemplate("detailTemplate");this.getTemplate("searchTemplate");this.getTemplate("detailHeaderTemplate");this.getTemplate("newHeaderTemplate");this.getTemplate("headerTemplate");this.getTemplate("footerTemplate");var b=this.get_scope();this._newView.atomControl._scope=new H(this,b);this._detailView.atomControl._scope=new H(this,b);b=r.cloneNode(this._gridTemplate);
this.addTemplate(this._gridPresenter,b);f(this._detailTemplate).attr("atom-dock")||f(this._detailTemplate).attr("atom-dock","Fill");if(this._headerTemplate){var a=r.cloneNode(this._headerTemplate);a.setAttribute("atom-dock","Top");f(a).addClass("atom-navigator-list-header");a._templateParent=this;this.addTemplate(this._gridPanel,a)}this._footerTemplate&&(b=r.cloneNode(this._footerTemplate),b.setAttribute("atom-dock","Bottom"),f(a).addClass("atom-navigator-list-footer"),this.addTemplate(this._gridPanel,
b))},init:function(){c.init.call(this);var b=this;this.backCommand=function(){b.onBackCommand.apply(b,arguments)};this.addCommand=function(){b.onAddCommand.apply(b,arguments)};this.cancelAddCommand=function(){b.onCancelAddNewCommand.apply(b,arguments)};this.showDetailCommand=function(){b.get_selectedItem()&&(d.setValue(b,"displayMode",1),b.updateDisplayMode())}}}})})(m,n.AtomListBox.prototype);(function(a,c){var b=a.AtomUI;return classCreatorEx({name:"WebAtoms.AtomNumberComboBox",base:c,start:function(){},
properties:{showPrompt:!1,startNumber:void 0,endNumber:void 0,step:1},methods:{set_startNumber:function(b){this._startNumber=b;this.resetNumbers()},set_endNumber:function(b){this._endNumber=b;this.resetNumbers()},set_step:function(b){b&&(this._step=b,this.resetNumbers())},onLoaded:function(){this.resetNumbers()},resetNumbers:function(){if(this._created&&void 0!==this._startNumber&&void 0!==this._endNumber){var a=b.toNumber(this._startNumber),c=b.toNumber(this._endNumber),h=b.toNumber(this._step),
g=[];for(this._showPrompt&&g.push({label:"Select",value:0});a<=c;a+=h)g.push({label:a,value:a});this.set_items(g)}}}})})(m,n.AtomComboBox.prototype);(function(a,c){var b=a.document,e=a.$;return classCreatorEx({name:"WebAtoms.AtomPhoneControl",base:c,start:function(){this._value=""},properties:{},methods:{set_value:function(b){this._value=b;this._countries&&this.setupValues()},setupValues:function(){if(this._value){for(var b=this._value.split(":",6),a=b[1],c=new p(this._countries);c.next();)if(c.current().country==
a){this.cs.selectedIndex=c.currentIndex();break}a=(b[3]||"").split(".").join("-");"--"==a&&(a="");e(this.num).val(a);e(this.ext).val(b[4]);e(this.msg).val(b[5]);this.onFormat()}else e(this.num).val(""),e(this.ext).val(""),e(this.msg).val("")},onDataChange:function(){var b;b=this._countries[this.cs.selectedIndex];b="v2:"+(b.country+":"+b.code);var a=e(this.num).val().split("-").join(".");b=b+(":"+a)+(":"+e(this.ext).val());b+=":"+e(this.msg).val();this._value=a?b:"";d.refreshValue(this,"value")},setCountries:function(b){this._countries=
b;var a=this.cs.options;a.length=0;for(b=new p(b);b.next();){var c=b.current();if(!c.valueIndex){c.label=c.label;c.valueIndex=b.currentIndex();var e=eval("("+c.value+")");c.country=e.country;c.code=e.code;c.format=e.format}a[b.currentIndex()]=new Option(c.label,c.valueIndex,!1,!1)}this.setupValues();this.onFormat()},onCountryChange:function(){this.onDataChange();this.onFormat()},onFormat:function(){var b=this.cs;if(-1!=b.selectedIndex){var a=this._countries[b.selectedIndex];if(a.format&&a.format.length&&
0<a.format.length)for(this._currentFormat=[],b=0,a=new p(a.format);a.next();)b+=a.current(),this._currentFormat.push(b)}},onKeyUp:function(b){if(this._currentFormat){b=this.num.value;b=b.replace(/\D/g,"");for(var a="",c=0;c<b.length;c++)a+=b[c],c<b.length-1&&-1!=e.inArray(c+1,this._currentFormat)&&(a+="-");this.num.value=a}},init:function(){this.cs=b.createElement("SELECT");this.num=b.createElement("INPUT");this.num.type="text";this.ext=b.createElement("INPUT");this.ext.type="text";e(this.ext).attr("placeholder",
"Ext.");this.msg=b.createElement("INPUT");this.msg.type="text";e(this.msg).attr("placeholder","Message");var a=this.get_element();a.appendChild(this.cs);a.appendChild(this.num);a.appendChild(this.ext);a.appendChild(this.msg);var f=this;this.onKeyUpLater=function(b){f.onKeyUp(b);f.onDataChange(b)};this.bindEvent(this.cs,"change","onCountryChange");this.bindEvent(this.num,"change","onDataChange");this.bindEvent(this.num,"keyup","onKeyUpLater");this.bindEvent(this.num,"keypress","onKeyUpLater");this.bindEvent(this.ext,
"change","onDataChange");this.bindEvent(this.msg,"change","onDataChange");e(this._element).addClass("atom-phone-control");e(this.num).addClass("atom-pc-num");e(this.msg).addClass("atom-pc-msg");e(this.cs).addClass("atom-pc-cs");e(this.ext).addClass("atom-pc-ext");var g=this;u.cachedJson("/config/phonecountries").then(function(b){g.setCountries(b.value())}).invoke();c.init.call(this)}}})})(m,n.AtomControl.prototype);(function(a,c){return classCreatorEx({name:"WebAtoms.AtomRadioButtonList",base:c,start:function(){this._allowMultipleSelection=
!1},properties:{},methods:{updateChildSelections:function(){for(var b=this.get_dataItems(),b=new p(b),a=this._dataElements;b.next();){var c=b.current(),d=a[b.currentIndex()];this.isSelected(c)?f(d).attr("checked","true"):f(d).removeAttr("checked")}},onDataChange:function(b){this._onUIChanged=!0;var a=b.target;b=a;this.hasItems()&&(b=f(a).data("atom-data-item"));a=f(a).attr("checked");d.clear(this._selectedItems);this.isSelected(b)?a||d.removeItem(this._selectedItems,b):a&&d.addItem(this._selectedItems,
b);this._onUIChanged=!1},createChildElement:function(b,a,c){b=s.createElement("SPAN");var d=s.createElement("INPUT");f(d).attr("type","radio");f(d).attr("name",this._groupName);var g=this.get_labelPath(),m=this.get_valuePath();v=l=c;g&&(l=c[g]);m&&(v=c[m]);f(d).data("atom-data",v);f(d).data("atom-data-item",c);f(d).val(l);b.appendChild(d);c=s.createTextNode(l);b.appendChild(c);a.appendChild(b);this.bindEvent(d,"change","onDataChange");return d},init:function(){this._groupName="__g"+r.getNewIndex();
c.init.call(this)}}})})(m,n.AtomCheckBoxList.prototype);(function(a,c){return classCreatorEx({name:"WebAtoms.AtomSortableColumn",base:c,start:function(){},properties:{direction:"",defaultDirection:"",label:"",sortField:null},methods:{set_direction:function(b){this._direction=b;f(this._element).removeClass("atom-sort-asc");f(this._element).removeClass("atom-sort-desc");b&&f(this._element).addClass("atom-sort-"+b.toLowerCase())},set_value:function(b){this._value=b;this.refreshUI()},refreshUI:function(){this._value&&
(-1==this._value.indexOf(this._sortField)?d.setValue(this,"direction",""):this._value.lastIndexOf("desc")!=this._value.length-4?d.setValue(this,"direction","asc"):d.setValue(this,"direction","desc"))},onClick:function(b){this._direction?"asc"==this._direction?d.setValue(this,"direction","desc"):d.setValue(this,"direction","asc"):d.setValue(this,"direction",this._defaultDirection);d.setValue(this,"value",this._sortField+" "+this._direction)},init:function(){c.init.call(this);this.bindEvent(this._element,
"click","onClick");f(this._element).addClass("atom-column")},onUpdateUI:function(){this.refreshUI()}}})})(m,n.AtomControl.prototype);(function(a){return classCreatorEx({name:"WebAtoms.AtomTabButtonBar",base:a,start:function(){this._allowMultipleSelection=!1;this._showTabs=!0},methods:{}})})(n.AtomLinkBar.prototype);(function(a,c){return classCreatorEx({name:"WebAtoms.AtomTabControl",base:c,start:function(){this._presenters=["itemsPresenter"];this._layout=n.AtomViewBoxLayout.defaultInstance;this.selectedIndex=
0;this.labelPath="label"},properties:{items:null},methods:{createChildren:function(){c.createChildren.call(this);if(this._itemsPresenter!=this._element){for(var b=[],a=new y(this._element);a.next();){var d=a.current();this._element.removeChild(d);b.push(d)}this._template&&(a=r.cloneNode(this._template),a._templateParent=this,this._element.appendChild(a),this.onCreateChildren(this._element));for(a=new p(b);a.next();)this._itemsPresenter.appendChild(a.current());if(this._template)this.onCreateChildren(this._itemsPresenter)}}}})})(m,
n.AtomControl.prototype);(function(a,c){return classCreatorEx({name:"WebAtoms.AtomTimePicker",base:c,properties:{displayLabel:"9:00 AM"},methods:{init:function(){this._autoOpen=!0;for(var b=[],a=0;23>=a;a++){var d="AM",f=a;11<a&&(d="PM",12<a&&(f=a-12));var g=f+":00 "+d;b.push({label:g,value:g});g=f+":30 "+d;b.push({label:g,value:g})}this._items=b;c.init.call(this)}}})})(m,n.AtomAutoCompleteBox.prototype);(function(a){return classCreatorEx({name:"WebAtoms.AtomUploadButton",base:a,start:function(a){/input/gi.test(a.nodeName)&&
/file/gi.test(f(a).attr("type"))?this._filePresenter=a:(this._filePresenter=s.createElement("input"),f(this._filePresenter).attr("type","file"),f(this._filePresenter).css("left","-500px"),f(this._filePresenter).css("position","absolute"),f(this._filePresenter).css("top","-0px"),s.body.appendChild(this._filePresenter))},properties:{fileTypes:void 0,accept:"*/*",capture:"",progress:0},methods:{set_accept:function(a){(this._accept=a)&&this._filePresenter&&f(this._filePresenter).attr("accept",a)},set_capture:function(a){(this._capture=
a)&&this._filePresenter&&f(this._filePresenter).attr("capture",a)},onClickHandler:function(a){this._confirm&&!confirm(this._confirmMessage)||!this._postUrl||this._filePresenter==this._element||(f(this._filePresenter).trigger("click"),r.cancelEvent(a))},onFileSelected:function(){var a=this.get_postData();if(null!==a&&void 0!==a){var b=this._mergeData;if(b)for(var e in b)a[e]=b[e];b=this._xhr;if(!b){b=new XMLHttpRequest;e=b.upload;try{b.timeout=36E5}catch(f){}this.bindEvent(e,"progress","onProgress");
this.bindEvent(e,"timeout","onError");this.bindEvent(e,"error","onError");this.bindEvent(b,"load","onComplete");this.bindEvent(b,"error","onError");this.bindEvent(b,"timeout","onError");this._xhr=b}e=new FormData;for(var h=new p(this._filePresenter.files);h.next();)e.append("file"+h.currentIndex(),h.current());e.append("formModel",JSON.stringify(d.getClone(a)));b.open("POST",this._postUrl);b.send(e);atomApplication.setBusy(!0,"Uploading...")}},set_progress:function(a){(this._progress=a)&&d.setValue(atomApplication,
"progress",a)},onError:function(a){atomApplication.setBusy(!1,"Uploading...");this.unbindEvent(this._xhr);this._xhr=null;this._lastError=a;q.alert("Upload failed")},onProgress:function(a){a.lengthComputable&&(a=Math.round(100*a.loaded/a.total),d.setValue(this,"progress",a))},onComplete:function(a){atomApplication.setBusy(!1,"Uploading...");if(a.target)if(200==a.target.status)this._value=a.target.responseText;else{q.alert(a.target.statusText);return}else this._value=a.result;this.unbindEvent(this._xhr);
this._xhr=null;d.refreshValue(this,"value");this.invokeAction(this._next,a)},init:function(){a.init.call(this);this.bindEvent(this._filePresenter,"change","onFileSelected")}}})})(n.AtomPostButton.prototype);(function(a,c){return classCreatorEx({name:"WebAtoms.AtomViewBox",base:c,start:function(){this._layout=a.AtomViewBoxLayout.defaultInstance},methods:{}})})(n,n.AtomControl.prototype);(function(a,c){return classCreatorEx({name:"WebAtoms.AtomWizard",base:c,start:function(){this._presenters=["viewPresenter"]},
properties:{currentStep:null,nextLabel:"Next",nextClass:"",buttons:null,prevLabel:"Back",finishLabel:"Finish",canMoveBack:!0,canMoveNext:!0,steps:0,isLastStep:!1},methods:{set_currentStep:function(b){this._currentStep=b;var a=this._buttons;a&&a.length&&(b=a[b],d.setValue(this,"nextLabel",b.label),d.setValue(this,"nextClass",b.styleClass));d.refreshValue(this,"isLastStep")},get_isLastStep:function(){return this._currentStep==this._steps-1},init:function(){f(this._element).addClass("atom-wizard");c.init.call(this);
var b=this;this.goNextCommand=function(a,c,e){b.get_isLastStep()?(b.invokeAction(b._next,e),d.setValue(b,"canMoveBack",!1)):d.setValue(b,"currentStep",b._currentStep+1)};this.goPrevCommand=function(){d.setValue(b,"currentStep",b._currentStep-1)};this.resetCommand=function(){d.setValue(b,"currentStep",0);d.setValue(b,"canMoveBack",!0)};for(var a=this._viewPresenter,k=0,h=new y(this._viewTemplate);h.next();){k++;var g=h.current();a.appendChild(g);var m=f(g).attr("atom-type");m||(m="AtomViewBox",f(g).attr("atom-type",
m));m=f(g).attr("atom-type")||n.AtomControl;r.createControl(g,m).init()}d.setValue(this,"steps",k);k&&d.setValue(this,"currentStep",0);this.nextCommand=function(c,d,f){var g=a.atomControl.get_selectedChild().atomControl;g._next?g.invokeAction(g._next):b.goNextCommand(c,d,f)}}}})})(m,n.AtomDockPanel.prototype);(function(a){return classCreatorEx({name:"WebAtoms.AtomYesNoControl",base:a,start:function(){this._allowSelectFirst=!1;this._items=[{label:"Yes",value:!0},{label:"No",value:!1}]},methods:{init:function(){this._element.style.height=
"26px";a.init.call(this)}}})})(n.AtomToggleButtonBar.prototype);(function(a,c){return classCreatorEx({name:"WebAtoms.AtomYesNoCustom",base:c,start:function(){this._presenters=["yesNo","input"];this._hasValue=!1},properties:{hasValue:!1,placeholder:null},methods:{set_hasValue:function(b){(this._hasValue=b)||d.setValue(this,"value","")},set_value:function(b){this._value=b;d.setValue(this,"hasValue",b?!0:!1);this._onUIChanged||f(this._input).val(b)},onValueChange:function(){this._onUIChanged=!0;var b=
f(this._input).val();d.setValue(this,"value",b);this._onUIChanged=!1},onUpdateUI:function(){f(this._input).addClass("atom-yes-no-custom-input");this._placeholder&&(f(this._input).attr(this._placeholder),placeHolderFixer.refresh())},init:function(){c.init.call(this);this._yesNo=this._yesNo.atomControl;this.bindEvent(this._input,"change","onValueChange")}}})})(m,n.AtomControl.prototype);(function(a,c,b){return classCreatorEx({name:"WebAtoms.AtomSkinnedApplication",base:b,start:function(){this._presenters=
["appPresenter"]},methods:{setup:function(){var b=this._element,a=f(b).attr("atom-skin");if(!a)throw Error("Skin is missing");this._skinTemplate=b.innerHTML;b.innerHTML="";var c=this,d=u.get(a).then(function(){c.skinLoaded(d)});d.invoke()},skinLoaded:function(a){this._element.innerHTML=a.value();b.setup.call(this)},createChildren:function(){var b=this._skinTemplate;this._appPresenter=f(this._element).find("[atom-presenter=appPresenter]").first()[0];var a=this._element.innerHTML,a=a.replace(this._appPresenter.innerHTML,
b);this._element.innerHTML=a;base.createChildren.call(this)}}})})(m,"WebAtoms.AtomSkinnedApplication",n.AtomApplication.prototype);(function(a,c){return classCreatorEx({name:"WebAtoms.AtomAutoPostForm",base:c,start:function(){},properties:{isBusy:!1,postError:null},methods:{pushPost:function(b){if(!this._isBusy){this._pushPostTimeout&&clearTimeout(this._pushPostTimeout);b||(b=1E3);var a=this;this._pushPostTimeout=setTimeout(function(){n.dispatcher.callLater(function(){a.onSubmit()})},b)}},onSubmit:function(){this._pushPostTimeout=
0;if(!this._isBusy&&this.isValid()){var b=this.preparePostData();if(b){var a=JSON.stringify(d.getClone(b));if(!this._cachedData||a!=this._cachedData){this._cachedData=a;var c=this,a=u.getUrl(this._postUrl),f=u.json(a,null,{type:"POST",data:b}).then(c._success);f.failed(function(){c._isBusy=!1;c._postError=f.error.msg;d.refreshValue(c,"isBusy");d.refreshValue(c,"postError")});f.showProgress(!1);f.showError(!1);f.invoke()}}}},onCreated:function(){c.onCreated.apply(this,arguments);var b=this.preparePostData();
b&&(this._cachedData=JSON.stringify(d.getClone(b)))},onSuccess:function(b){c.onSuccess.apply(this,arguments);this._isBusy=!1;d.refreshValue(this,"isBusy")},onKeyUp:function(b){this.pushPost();if(!(b.target&&b.target.nodeName&&/textarea/gi.test(b.target.nodeName))&&13==b.keyCode)this.onSubmit()},init:function(){c.init.call(this);var b=this;this.pushPostHandler=function(){b.pushPost(1E3)};this.bindEvent(this._element,"click",this.pushPostHandler);f(this._element).find("input,select,textarea").bind("change",
null,this.pushPostHandler)}}})})(m,n.AtomForm.prototype);(function(a,c){return classCreatorEx({name:"WebAtoms.AtomFormField",base:c,start:function(){this._presenters=["contentPresenter"]},properties:{error:void 0,dataType:null,label:void 0,fieldClass:void 0,required:!1,isValid:void 0,regex:null,fieldValue:void 0,field:null,requiredMessage:"Required",invalidMessage:"Invalid",fieldVisible:!0,validate:!1,isValidSet:!1},methods:{set_dataType:function(b){this._dataType=b;this.setup()},set_fieldValue:function(b){this._fieldValue=
b;this._validate&&this.validate()},set_isValid:function(b){this._isValid=b;this._isValidSet=!0;this._validate&&this.validate()},set_regex:function(b){this._regex=b;this.setup()},set_required:function(b){this._required=b;this.setup()},validateChildren:function(b){for(b=new y(b);b.next();){var a=b.current();a.atomControl?this.validateValue(d.getValue(a.atomControl,"value")):/input|select|textarea/gi.test(a.nodeName)?this.validateValue(f(a).val()):this.validateChildren(a)}},validateValue:function(b){if(this._required){if(!b){d.setValue(this,
"error",this._requiredMessage);this._isValid=!1;return}}else if(!b){this._isValid=!0;return}var a=null;/email/gi.test(this._dataType)?a=/^(([^<>()\[\]\\.,;:\s@\"]+(\.[^<>()\[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/:this._regex&&(a=eval("("+this._regex+")"));a&&!a.test(b)&&(d.setValue(this,"error",this._invalidMessage),this._isValid=!1)},validate:function(){this._validate=!0;if(!(this._required||this._regex||this._dataType))return void 0===
this._isValid?!0:this._isValid;if(this._isValid&&(d.setValue(this,"error",""),this._isValidSet))return!0;this._isValid=!0;void 0!==this._fieldValue?this.validateValue(this._fieldValue):this.validateChildren(this._element);this._isValid&&d.setValue(this,"error","");return this._isValid},onCreated:function(){this.setup()},onFocusOut:function(){this._validate=!0;this.validate()},setup:function(){if(this._created){var b=this._element;this._contentPresenter&&this._contentPresenter.appendChild(this._element.contentElement);
for(b=new p(f(b).find("input,select,textarea"));b.next();){var a=b.current();this.bindEvent(a,"blur","onFocusOut");this.bindEvent(a,"change","onFocusOut")}d.refreshValue(this,"fieldClass")}}}})})(m,n.AtomControl.prototype);(function(a,c){return classCreatorEx({name:"WebAtoms.AtomFormGridLayout",base:c,start:function(){},properties:{minLabelWidth:100,cellSpacing:5,label:""},methods:{onUpdateUI:function(){d.refreshValue(this,"controlWidth");d.refreshValue(this,"controlHeight");c.onUpdateUI.apply(this,
arguments)},get_controlWidth:function(){return f(this._element.parentNode).innerWidth()},get_controlHeight:function(){return f(this._element.parentNode).innerHeight()},createChildren:function(){var b=this._element;f(b).addClass("atom-form-grid");var a=f(b).children(),c=new p(a);r.removeAllChildren(b);var d=s.createElement("DIV");f(d).addClass("atom-form-grid-container");b.appendChild(d);f(this._element).attr("atom-min-label-width");for(this.getTemplate("fieldTemplate");c.next();)if(a=c.current(),
(b=r.attributeMap(a,/^(atom\-type)$/gi)["atom-type"])&&"AtomFormRow"==b.value){b=s.createElement("TABLE");d.appendChild(b);f(b).addClass("atom-form-grid-row");var g=s.createElement("TBODY");b.appendChild(g);b=s.createElement("TR");g.appendChild(b);a=f(a).children();for(a=new p(a);a.next();)g=s.createElement("TD"),b.appendChild(g),this.createField(g,a.current())}else if(!b||"AtomFormTabControl"!=b.value&&"AtomTabControl"!=b.value)this.createField(d,a);else{g=s.createElement("DIV");g.setAttribute("atom-type",
"AtomToggleButtonBar");b=r.assignID(g);g.setAttribute("atom-name",b);g.setAttribute("atom-show-tabs","true");var m=s.createElement("SPAN");g.appendChild(m);m.setAttribute("atom-text","{$data.label}");m.setAttribute("atom-template","itemTemplate");this.createField(d,g);for(var g=L[b],a=new y(a),m=[],n=0;a.next();){var q=a.current();f(q).remove();q.setAttribute("style-display","[$scope."+b+".selectedIndex == "+n+" ? '' : 'none']");q=this.createField(d,q);m.push(q);n++}g.set_items(m)}}}})})(m,n.AtomFormLayout.prototype);
(function(a){return classCreatorEx({name:"WebAtoms.AtomFormTab",base:a,start:function(){},methods:{}})})(n.AtomFormGridLayout.prototype);(function(a){return classCreatorEx({name:"WebAtoms.AtomFormNoLayout",base:a,start:function(){},methods:{}})})(n.AtomForm.prototype);(function(a){return classCreatorEx({name:"WebAtoms.AtomFormVerticalLayout",base:a,start:function(){},methods:{}})})(n.AtomFormLayout.prototype);(function(a){return classCreatorEx({name:"WebAtoms.AtomTableLayout",base:a,start:function(a,
b,e){this._cellWidth=b;this._cellHeight=e;this._columns=a},methods:{doLayout:function(a){var b=new p(f(a).children()),e=0,d=0,h=Math.ceil(b._array.length/this._columns)-1,g=h,m=this._columns*this._cellWidth,n=this._cellHeight*(h+1);a.style.position="relative";a.style.width=m+"px";a.style.height=n+"px";for(a.maxRows=h;b.next();)a=b.current(),a.style.position="absolute",a.style.left=e+"px",a.style.top=d+"px",a.style.width=this._cellWidth+"px",0>=g?(g=h,e+=this._cellWidth+10,d=0):(g--,d+=this._cellHeight)}}})})(n.AtomLayout.prototype);
F=function(a){return classCreatorEx({name:"WebAtoms.AtomViewBoxLayout",base:a,start:function(){},methods:{doLayout:function(a){var b=f(a).innerWidth()+"px",e=f(a).innerHeight()+"px";a=new y(a);for(var d;a.next();)d=a.current(),d.style.width=b,d.style.height=e,d.atomControl&&d.atomControl.updateUI()}}})}(n.AtomLayout.prototype);F.defaultInstance=new F;q.confirm=function(a,c){var b={Message:a,ConfirmValue:!1,Confirm:c?!0:!1},d=s.createElement("DIV");s.body.appendChild(d);var k=r.createControl(d,n.AtomWindow,
b);k.set_windowWidth(380);k.set_windowHeight(120);k.set_windowTemplate(k.getTemplate("alertTemplate"));k.set_title(c?"Message":"Confirm");k.set_next(function(){k.dispose();f(d).remove();b.ConfirmValue&&c&&c()});k.refresh()};q.alert=m.__chromeCSP?function(a){q.confirm(a,null)}:function(a){alert(a)};f(m.document).ready(function(){n.dispatcher.setupControls();n.dispatcher.start()})}).apply(window,[WebAtoms]);