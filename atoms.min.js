function t(e,n,i){var o=e.indexOf(".");if(-1==o){var a=n[e];return a||(a=i,n[e]=a),a}var a=t(e.substr(0,o),n,{});return t(e.substr(o+1),a,i)}function e(t,e){return e?function(){return this[t]}:function(e){this[t]=e}}function n(n,i,o,a,r){var s=i?i.constructor:null,l=o||function(){},u=r,h=null;if(s){h=r?function(){for(var t in u)this["_"+t]=u[t];s.apply(this,arguments),this.__typeName=n,l.apply(this,arguments)}:function(){s.apply(this,arguments),this.__typeName=n,l.apply(this,arguments)};var m=s.prototype;for(var d in m)a[d]||m.hasOwnProperty(d)&&(a[d]=m[d])}else h=r?function(){this.__typeName=n;for(var t in u)this["_"+t]=u[t];l.apply(this,arguments)}:function(){this.__typeName=n,l.apply(this,arguments)};if(r)for(var d in r)a["get_"+d]||(a["get_"+d]=e("_"+d,!0)),a["set_"+d]||(a["set_"+d]=e("_"+d));return h.__typeName=n,s&&(h.__baseType=s),h.prototype=a,h.prototype.constructor=h,a.hasOwnProperty("toString")||(h.prototype.toString=function(){return n}),t(/\./.test(n)?n:"WebAtoms."+n,window,h),h}function i(t){return n(t.name,t.base,t.start,t.methods,t.properties)}window.createClass=i,window.classCreatorEx=i,function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t("object"==typeof exports?require("jquery"):jQuery)}(function(t){var e,n=navigator.userAgent,i=/iphone/i.test(n),o=/chrome/i.test(n),a=/android/i.test(n);t.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},autoclear:!0,dataName:"rawMaskFn",placeholder:"_"},t.fn.extend({caret:function(t,e){var n;if(0!==this.length&&!this.is(":hidden"))return"number"==typeof t?(e="number"==typeof e?e:t,this.each(function(){this.setSelectionRange?this.setSelectionRange(t,e):this.createTextRange&&(n=this.createTextRange(),n.collapse(!0),n.moveEnd("character",e),n.moveStart("character",t),n.select())})):(this[0].setSelectionRange?(t=this[0].selectionStart,e=this[0].selectionEnd):document.selection&&document.selection.createRange&&(n=document.selection.createRange(),t=0-n.duplicate().moveStart("character",-1e5),e=t+n.text.length),{begin:t,end:e})},unmask:function(){return this.trigger("unmask")},mask:function(n,r){var s,l,u,h,m,d,c,p;if(!n&&this.length>0){s=t(this[0]);var f=s.data(t.mask.dataName);return f?f():void 0}return r=t.extend({autoclear:t.mask.autoclear,placeholder:t.mask.placeholder,completed:null},r),l=t.mask.definitions,u=[],h=c=n.length,m=null,t.each(n.split(""),function(t,e){"?"==e?(c--,h=t):l[e]?(u.push(new RegExp(l[e])),null===m&&(m=u.length-1),h>t&&(d=u.length-1)):u.push(null)}),this.trigger("unmask").each(function(){function s(){if(r.completed){for(var t=m;d>=t;t++)if(u[t]&&V[t]===f(t))return;r.completed.call(E)}}function f(t){return r.placeholder.charAt(t<r.placeholder.length?t:0)}function v(t){for(;++t<c&&!u[t];);return t}function g(t){for(;--t>=0&&!u[t];);return t}function _(t,e){var n,i;if(!(0>t)){for(n=t,i=v(e);c>n;n++)if(u[n]){if(!(c>i&&u[n].test(V[i])))break;V[n]=V[i],V[i]=f(i),i=v(i)}I(),E.caret(Math.max(m,t))}}function A(t){var e,n,i,o;for(e=t,n=f(t);c>e;e++)if(u[e]){if(i=v(e),o=V[e],V[e]=n,!(c>i&&u[i].test(o)))break;n=o}}function b(){var t=E.val(),e=E.caret();if(t.length<p.length){for(P(!0);e.begin>0&&!u[e.begin-1];)e.begin--;if(0===e.begin)for(;e.begin<m&&!u[e.begin];)e.begin++;E.caret(e.begin,e.begin)}else{for(P(!0);e.begin<c&&!u[e.begin];)e.begin++;E.caret(e.begin,e.begin)}s()}function C(){P(),E.val()!=B&&E.change()}function w(t){if(!E.prop("readonly")){var e,n,o,a=t.which||t.keyCode;p=E.val(),8===a||46===a||i&&127===a?(e=E.caret(),n=e.begin,o=e.end,o-n===0&&(n=46!==a?g(n):o=v(n-1),o=46===a?v(o):o),x(n,o),_(n,o-1),t.preventDefault()):13===a?C.call(this,t):27===a&&(E.val(B),E.caret(0,P()),t.preventDefault())}}function y(e){if(!E.prop("readonly")){var n,i,o,r=e.which||e.keyCode,l=E.caret();if(!(e.ctrlKey||e.altKey||e.metaKey||32>r)&&r&&13!==r){if(l.end-l.begin!==0&&(x(l.begin,l.end),_(l.begin,l.end-1)),n=v(l.begin-1),c>n&&(i=String.fromCharCode(r),u[n].test(i))){if(A(n),V[n]=i,I(),o=v(n),a){var h=function(){t.proxy(t.fn.caret,E,o)()};setTimeout(h,0)}else E.caret(o);l.begin<=d&&s()}e.preventDefault()}}}function x(t,e){var n;for(n=t;e>n&&c>n;n++)u[n]&&(V[n]=f(n))}function I(){E.val(V.join(""))}function P(t){var e,n,i,o=E.val(),a=-1;for(e=0,i=0;c>e;e++)if(u[e]){for(V[e]=f(e);i++<o.length;)if(n=o.charAt(i-1),u[e].test(n)){V[e]=n,a=e;break}if(i>o.length){x(e+1,c);break}}else V[e]===o.charAt(i)&&i++,h>e&&(a=e);return t?I():h>a+1?r.autoclear||V.join("")===S?(E.val()&&E.val(""),x(0,c)):I():(I(),E.val(E.val().substring(0,a+1))),h?e:m}var E=t(this),V=t.map(n.split(""),function(t,e){return"?"!=t?l[t]?f(e):t:void 0}),S=V.join(""),B=E.val();E.data(t.mask.dataName,function(){return t.map(V,function(t,e){return u[e]&&t!=f(e)?t:null}).join("")}),E.one("unmask",function(){E.off(".mask").removeData(t.mask.dataName)}).on("focus.mask",function(){if(!E.prop("readonly")){clearTimeout(e);var t;B=E.val(),t=P(),e=setTimeout(function(){E.get(0)===document.activeElement&&(I(),t==n.replace("?","").length?E.caret(0,t):E.caret(t))},10)}}).on("blur.mask",C).on("keydown.mask",w).on("keypress.mask",y).on("input.mask paste.mask",function(){E.prop("readonly")||setTimeout(function(){var t=P(!0);E.caret(t),s()},0)}),o&&a&&E.off("input.mask").on("input.mask",b),P()})}})}),function(t){function e(t,e){if(t)if(t.constructor==String)location.href=t;else{var n=t;if(n.atomControl)n=n.atomControl,n.refresh?n.refresh(this.get_scope(),this):g.alert("no default action defined");else if(n._element)n.refresh(this.get_scope(),this);else if("function"==typeof n)n.call(this,this.get_scope(),this,e);else{if(n.length){for(ae=new f(n);ae.next();)this.invokeAction(ae.current(),e);return}var t=n.timeOut||n.timeout;if(t){var i=this,o=100;return t.hasOwnProperty("length")&&t.length>1&&(o=t[0],t=t[1]),void setTimeout(function(){i.invokeAction(t)},o)}if(this.set_merge(n),t=n.confirm){var a="Are you sure?";t.hasOwnProperty("length")&&(t.length>1?(a=t[0],t=t[1]):t=t[0]);var i=this,r=t,s=e;g.confirm(a,function(){i.invokeAction(r,s)})}if(t=n.alert,t&&g.alert(t),t=n.next)return void this.invokeAction(t,e);t=n.control,t&&k[t].refresh(),t=n.window,t&&u.AtomWindow.openNewWindow({url:t,localScope:!1,opener:this,scope:this.get_scope()}),t=n.localWindow,t&&u.AtomWindow.openNewWindow({url:t,localScope:!0,opener:this,scope:this.get_scope()})}}}function o(t,e){function n(t){this._handler=t;var n=this;this.invoke=function(){try{n._handler.apply(n,n.args)}catch(t){console&&console.log(t)}finally{n.timeout=0,n.pending=!1}},this.handler=function(){n.pending||(n.pending=!0,n.args=arguments,n.timeout&&clearTimeout(n.timeout),n.timeout=setTimeout(n.invoke,e||500))}}var i=new n(t);return i.handler}var a=t.$,r=t.document,s={jsonML:{}},u={};t.WebAtoms=u,t.Templates=s;var h=s.jsonML;h["WebAtoms.AtomAutoCompleteBox.template"]=[["input",{"data-atom-presenter":"selectionBox",disabled:"disabled",type:"text","data-atom-init":"t1"}],["input",{"data-atom-presenter":"inputBox",type:"text",autocomplete:"off",autocorrect:"off","data-atom-init":"t2"}],["div",{"data-atom-presenter":"itemsPresenter","class":"atom-list-box",style:"position: absolute; z-index: 100;","data-atom-init":"t3"},["div",{"data-atom-template":"itemTemplate",style:"min-width:100px;","data-atom-init":"t4"}]]],h["WebAtoms.AtomCalendar.itemTemplate"]=[["div",{"data-atom-template":"itemTemplate","data-atom-init":"t5"},["span",{"data-atom-init":"t6"}]]],h["WebAtoms.AtomCalendar.template"]=[["section",{"class":"calendar"},["header",{},["button",{"class":"prev","data-atom-init":"t7"}],["select",{"data-atom-type":"AtomComboBox","class":"month","data-atom-init":"t8"}],["select",{"data-atom-type":"AtomComboBox","class":"year","data-atom-init":"t9"}],["button",{"class":"next","data-atom-init":"t10"}]],["ul",{"class":"days"},["li",{"class":"weekend"},"S"],["li",{},"M"],["li",{},"T"],["li",{},"W"],["li",{},"T"],["li",{},"F"],["li",{"class":"weekend"},"S"]],["section",{"class":"day-list","data-atom-presenter":"itemsPresenter"}]]],h["WebAtoms.AtomCheckBoxList.itemTemplate"]=[["div",{"data-atom-template":"itemTemplate"},["input",{type:"checkbox","data-atom-init":"t13"}],["span",{"data-atom-init":"t14"}]]],h["WebAtoms.AtomDataPager.template"]=[["button",{"class":"atom-pager-first-button",style:"float:left","data-atom-init":"t15"},"First"],["span",{style:"text-align:left"},["button",{"class":"atom-pager-prev-button","data-atom-init":"t16"},"Prev"],["span",{},"Goto: Page"],["select",{"data-atom-type":"AtomComboBox","data-atom-init":"t17"}],["button",{"class":"atom-pager-next-button","data-atom-init":"t18"},"Next"]],["button",{"class":"atom-pager-last-button",style:"float:right","data-atom-init":"t19"},"Last"]],h["WebAtoms.AtomDateField.popupTemplate"]=[["div",{"class":"atom-date-popup","data-atom-init":"t20"},["div",{"class":"atom-date-list-box"},["div",{"class":"calendar","data-atom-presenter":"calendarPresenter"},["select",{"data-atom-type":"AtomComboBox","class":"month","data-atom-init":"t22"}],["select",{"data-atom-type":"AtomNumberComboBox","class":"year","data-atom-init":"t23"}],["div",{"class":"days"},["span",{"class":"weekend-header"},"S"],["span",{},"M"],["span",{},"T"],["span",{},"W"],["span",{},"T"],["span",{},"F"],["span",{"class":"weekend-header"},"S"]],["div",{"class":"day-list","data-atom-type":"AtomItemsControl","data-atom-presenter":"itemsPresenter","data-atom-init":"t24"},["div",{"data-atom-template":"itemTemplate","data-atom-init":"t25"},["span",{"data-atom-init":"t26"}]]]]]]],h["WebAtoms.AtomDateField.template"]=[["div",{"class":"date-label","data-atom-init":"t27"}]],h["WebAtoms.AtomDateListBox.template"]=[["div",{"class":"atom-date-list-box"},["div",{"class":"calendar"},["select",{"data-atom-type":"AtomComboBox","class":"month","data-atom-init":"t28"}],["select",{"data-atom-type":"AtomComboBox","class":"year","data-atom-init":"t29"}],["div",{"class":"days"},["span",{"class":"weekend-header"},"S"],["span",{},"M"],["span",{},"T"],["span",{},"W"],["span",{},"T"],["span",{},"F"],["span",{"class":"weekend-header"},"S"]],["div",{"class":"day-list","data-atom-presenter":"itemsPresenter"},["div",{"data-atom-template":"itemTemplate","data-atom-init":"t31"},["span",{"data-atom-init":"t32"}]]]],["div",{"class":"list","data-atom-type":"AtomListBox","data-atom-init":"t33"},["div",{"data-atom-template":"itemTemplate","data-atom-init":"t34"}]]]],h["WebAtoms.AtomItemsControl.itemTemplate"]=[["span",{"data-atom-init":"t35"},"Item"]],h["WebAtoms.AtomLinkBar.itemTemplate"]=[["li",{"data-atom-init":"t36"},["a",{"data-atom-init":"t37"}]]],h["WebAtoms.AtomLinkBar.menuTemplate"]=[["ul",{"class":"menu","data-atom-type":"AtomLinkBar","data-atom-init":"t38"},["li",{"data-atom-template":"itemTemplate"},["a",{"data-atom-init":"t40"}]]]],h["WebAtoms.AtomNavigatorList.detailTemplate"]=[["iframe",{"class":"atom-navigator-list-iframe","data-atom-template":"detailTemplate","data-atom-init":"t41"}]],h["WebAtoms.AtomNavigatorList.template"]=[["div",{"data-atom-type":"AtomViewStack","data-atom-init":"t42"},["div",{"data-atom-type":"AtomDockPanel","data-atom-presenter":"gridPanel"},["div",{"data-atom-dock":"Fill","data-atom-presenter":"gridPresenter","class":"atom-navigator-list-grid"}]],["div",{"data-atom-presenter":"detailView","data-atom-type":"AtomDockPanel","data-atom-init":"t45"},["div",{"data-atom-dock":"Top","data-atom-presenter":"detailHeaderToolbar"},["input",{type:"button",value:"Back",style:"float: left","data-atom-init":"t47"}]]],["div",{"data-atom-presenter":"newView","data-atom-type":"AtomDockPanel","data-atom-init":"t48"},["div",{"data-atom-dock":"Top","data-atom-presenter":"newHeaderToolbar"},["input",{type:"button",value:"Back",style:"float: left","data-atom-init":"t50"}]]]]],h["WebAtoms.AtomRadioButtonList.itemTemplate"]=[["span",{},["input",{type:"radio","data-atom-name":"{$owner.groupName}","data-atom-init":"t51"}],["span",{"data-atom-init":"t52"}]]],h["WebAtoms.AtomSortableColumn.template"]=[["span",{"data-atom-init":"t53"}]],h["WebAtoms.AtomTabControl.template"]=[["div",{"data-atom-type":"AtomDockPanel"},["ul",{"data-atom-dock":"Top","data-atom-type":"AtomToggleButtonBar","data-atom-init":"t55"},["li",{"data-atom-template":"itemTemplate","data-atom-init":"t56"}]],["div",{"data-atom-dock":"Fill","data-atom-type":"AtomViewStack","data-atom-presenter":"itemsPresenter","data-atom-init":"t57"}]]],h["WebAtoms.AtomTimeEditor.template"]=[["span",{},"Hour:"],["input",{type:"number",min:"0",max:"12","data-atom-init":"t58"}],["span",{},"Minute:"],["input",{type:"number",min:"0",max:"59","data-atom-init":"t59"}],["ul",{"data-atom-type":"AtomToggleButtonBar","data-atom-init":"t60"},["li",{"data-atom-template":"itemTemplate","data-atom-init":"t61"}]]],h["WebAtoms.AtomToggleButtonBar.itemTemplate"]=[["li",{"data-atom-init":"t62"}]],h["WebAtoms.AtomWizard.template"]=[["div",{"data-atom-dock":"Fill","data-atom-type":"AtomViewStack","data-atom-presenter":"viewPresenter","data-atom-init":"t63"}],["div",{"data-atom-dock":"Bottom","class":"atom-wizard-command-bar"},["button",{"class":"atom-wizard-back-button","data-atom-init":"t65"},["span",{"data-atom-init":"t66"}]],["button",{"class":"atom-wizard-next-button","data-atom-init":"t67"},["span",{"data-atom-init":"t68"}]]]],h["WebAtoms.AtomYesNoCustom.template"]=[["ul",{"data-atom-type":"AtomYesNoControl","data-atom-presenter":"yesNo","data-atom-init":"t69"}],["input",{style:"vertical-align:top",type:"text","data-atom-presenter":"input","data-atom-init":"t70"}]],h["WebAtoms.AtomApplication.busyTemplate"]=[["div",{style:"position:absolute;left:0px;top:0px;z-index:10000; display:none","data-atom-init":"t71"},["div",{"class":"atom-busy-window",style:"position:absolute","data-atom-init":"t72"},["div",{"class":"atom-busy-image","data-atom-init":"t73"}],["div",{"data-atom-init":"t74"}],["div",{style:"height:3px; background-color:green","data-atom-init":"t75"}]]]],h["WebAtoms.AtomForm.errorTemplate"]=[["section",{"data-atom-type":"AtomItemsControl",style:"overflow:auto","data-atom-init":"t76"},["div",{"data-atom-template":"itemTemplate"},["span",{"data-atom-init":"t78"}]]]],h["WebAtoms.AtomFormGridLayout.fieldTemplate"]=[["table",{"class":"atom-form-grid-row","data-atom-type":"AtomFormField","data-atom-init":"t79"},["tbody",{},["tr",{},["td",{"class":"atom-form-grid-label","data-atom-init":"t80"}],["td",{"class":"atom-form-grid-required","data-atom-init":"t81"},"*"],["td",{"class":"atom-form-grid-content","data-atom-presenter":"contentPresenter","data-atom-init":"t82"}],["td",{"data-atom-init":"t83"}]]]]],h["WebAtoms.AtomFormLayout.fieldTemplate"]=[["tr",{"data-atom-type":"AtomFormField"},["td",{"class":"atom-form-label","data-atom-init":"t85"}],["td",{"class":"atom-form-required","data-atom-init":"t86"}],["td",{"class":"atom-form-content","data-atom-presenter":"contentPresenter","data-atom-init":"t87"},["span",{"class":"atom-form-error","data-atom-init":"t88"}]]]],h["WebAtoms.AtomFormVerticalLayout.fieldTemplate"]=[["tr",{"data-atom-type":"AtomFormField"},["td",{},["div",{},["span",{"class":"atom-form-label","data-atom-init":"t90"}],["span",{"class":"atom-form-required","data-atom-init":"t91"}]],["div",{"class":"atom-form-content","data-atom-presenter":"contentPresenter","data-atom-init":"t92"}],["div",{"class":"atom-form-error","data-atom-init":"t93"}]]]],h["WebAtoms.AtomWindow.alertTemplate"]=[["div",{"class":"atom-alert","data-atom-dock":"Fill"},["pre",{"data-atom-init":"t95"}],["div",{"class":"buttons","data-atom-init":"t96"},["button",{"class":"ok","data-atom-init":"t97"},"Ok"],["button",{"class":"yes","data-atom-init":"t98"},"Yes"],["button",{"class":"no","data-atom-init":"t99"},"No"]]]],h["WebAtoms.AtomWindow.frameTemplate"]=[["div",{"class":"atom-window-background","data-atom-init":"t100"},["div",{"class":"atom-window","data-atom-presenter":"windowDiv",style:"position:absolute","data-atom-type":"AtomDockPanel","data-atom-init":"t101"},["div",{"class":"atom-window-title","data-atom-dock":"Top","data-atom-presenter":"windowTitleDiv","data-atom-init":"t102"}],["div",{"class":"atom-window-close-button","data-atom-presenter":"windowCloseButton","data-atom-init":"t103"}]]]],h["WebAtoms.AtomWindow.windowTemplate"]=[["iframe",{"class":"atom-window-frame","data-atom-presenter":"iframe","data-atom-init":"t104"}]],u.PageSetup=u.PageSetup||{},function(){this.t1=function(t){this.bind(t,"styleDisplay",[["isPopupOpen"]],0,function(t){return t?"":"none"}),this.bind(t,"value",["selectedText"])},this.t2=function(t){this.bind(t,"placeholder",["placeholder"]),this.bind(t,"value",["displayLabel"],!0,null,"keyup")},this.t3=function(t){this.bind(t,"styleLeft",[["offsetLeft"]],0,function(t){return t+2+"px"}),this.bind(t,"styleTop",[["offsetTop"]],0,function(t){return t+24+"px"}),this.bind(t,"styleDisplay",[["isPopupOpen"]],0,function(t){return t?"block":"none"})},this.t4=function(t){this.setLocalValue("text",g.get(this,"data")[g.get(this,"templateParent.labelPath")],t)},this.t5=function(t){this.bind(t,"class",[["data","isWeekEnd"],["data","isOtherMonth"],["data","isToday"],["scope","itemSelected"]],0,function(t,e,n,i){return{weekend:t,other:e,today:n,selected:i}})},this.t6=function(t){this.bind(t,"text",["data","label"])},this.t7=function(t){this.setLocalValue("eventClick",g.get(this,"prevMonthCommand"),t),D.text(t,"<")},this.t8=function(t){this.setLocalValue("items",_.monthList,t),this.bind(t,"value",["templateParent","month"],!0)},this.t9=function(t){this.bind(t,"items",[["value"],["templateParent","startYear"],["value"],["templateParent","endYear"]],0,function(t,e,n,i){return g.range(t+e,n+i)}),this.bind(t,"value",["templateParent","year"],!0)},this.t10=function(t){this.setLocalValue("eventClick",g.get(this,"nextMonthCommand"),t),D.text(t,">")},this.t13=function(t){this.bind(t,"checked",["scope","itemSelected"],!0)},this.t14=function(t){this.setLocalValue("text",g.get(this,"data")[g.get(this,"templateParent.labelPath")],t)},this.t15=function(t){this.bind(t,"isEnabled",[["pages","length"],["currentPage"]],0,function(t,e){return t>1&&e}),this.setLocalValue("eventClick",g.get(this,"goFirstCommand"),t)},this.t16=function(t){this.setLocalValue("eventClick",g.get(this,"goPrevCommand"),t),this.bind(t,"isEnabled",["currentPage"])},this.t17=function(t){this.bind(t,"items",["atomParent","pages"]),this.bind(t,"value",["atomParent","currentPage"],!0)},this.t18=function(t){this.setLocalValue("eventClick",g.get(this,"goNextCommand"),t),this.bind(t,"isEnabled",[["currentPage"],["pages","length"]],0,function(t,e){return e-1>t})},this.t19=function(t){this.setLocalValue("eventClick",g.get(this,"goLastCommand"),t),this.bind(t,"isEnabled",[["pages","length"],["currentPage"],["pages","length"]],0,function(t,e,n){return t>1&&n-1>e})},this.t20=function(t){this.bind(t,"styleLeft",[["offsetLeft"]],0,function(t){return t+"px"}),this.bind(t,"styleTop",[["offsetTop"]],0,function(t){return t+25+"px"}),this.bind(t,"class",[["isOpen"]],0,function(t){return t?"popup-open":"popup-closed"})},this.t22=function(t){this.setLocalValue("items",_.monthList,t),this.bind(t,"value",["templateParent","month"],!0)},this.t23=function(t){this.bind(t,"startNumber",[["templateParent","currentYear"],["templateParent","startYear"]],0,function(t,e){return t+e}),this.bind(t,"endNumber",[["templateParent","currentYear"],["templateParent","endYear"]],0,function(t,e){return t+e}),this.bind(t,"value",["templateParent","year"],!0)},this.t24=function(t){this.bind(t,"items",["templateParent","items"])},this.t25=function(t){this.setLocalValue("eventClick",g.get(this,"templateParent.templateParent.toggleDateCommand"),t),this.bind(t,"class",[["data","isWeekEnd"],["data","isOtherMonth"],["data","isToday"],["templateParent","templateParent","selectedItems"],["data","value"]],0,function(t,e,n,i,o){return{"list-item":!0,weekend:t,other:e,today:n,selected:g.query(i).any({value:o})}})},this.t26=function(t){this.bind(t,"text",["data","label"])},this.t27=function(t){this.bind(t,"class",[["isOpen"]],0,function(t){return t?"date-label-open":"date-label-closed"}),this.bind(t,"eventClick",[["isOpen"]],0,function(t){return{owner:{isOpen:!t}}}),this.bind(t,"text",[["selectedItem"],["selectedItem","dateLabel"]],0,function(t,e){return t?e:"SELECT"})},this.t28=function(t){this.setLocalValue("items",_.monthList,t),this.bind(t,"value",["templateParent","month"],!0)},this.t29=function(t){this.bind(t,"items",[["value"],["templateParent","startYear"],["value"],["templateParent","endYear"]],0,function(t,e,n,i){return g.range(t+e,n+i)}),this.bind(t,"value",["templateParent","year"],!0)},this.t31=function(t){this.setLocalValue("eventClick",g.get(this,"templateParent.toggleDateCommand"),t),this.bind(t,"data",[["templateParent","items"],["scope","itemIndex"]],0,function(t,e){return t[e]}),this.bind(t,"class",[["data","isWeekEnd"],["data","isOtherMonth"],["data","isToday"],["templateParent","selectedItems"],["data","value"]],0,function(t,e,n,i,o){return{"list-item":!0,weekend:t,other:e,today:n,selected:g.query(i).any({value:o})}})},this.t32=function(t){this.bind(t,"text",["data","label"])},this.t33=function(t){this.bind(t,"items",["templateParent","selectedItems"]),this.setLocalValue("labelPath","dateLabel",t),this.setLocalValue("valuePath","date",t),this.bind(t,"value",["templateParent","visibleDate"],!0)},this.t34=function(t){this.setLocalValue("text",g.get(this,"data.dateLabel"),t)},this.t35=function(t){this.bind(t,"text",[["data"],["atomParent","labelPath"]],0,function(t,e){return t[e]})},this.t36=function(t){this.setLocalValue("class",g.get(this,"data")[g.get(this,"templateParent.itemsPath")]&&g.get(this,"data")[g.get(this,"templateParent.itemsPath")].length?"sub-menu":"",t)},this.t37=function(t){this.setLocalValue("href",g.get(this,"data")[g.get(this,"atomParent.valuePath")],t),this.setLocalValue("target",g.get(this,"data")[g.get(this,"atomParent.targetPath")],t),this.setLocalValue("text",g.get(this,"data")[g.get(this,"atomParent.labelPath")],t)},this.t38=function(t){this.bind(t,"items",[["data"],["templateParent","itemsPath"]],0,function(t,e){return t[e]}),this.setLocalValue("menuTemplate",g.get(this,"templateParent.menuTemplate"),t),this.setLocalValue("menuDirection","vertical",t)},this.t40=function(t){this.setLocalValue("href",g.get(this,"data")[g.get(this,"templateParent.valuePath")],t),this.setLocalValue("text",g.get(this,"data")[g.get(this,"templateParent.labelPath")],t),this.setLocalValue("target",g.get(this,"data.target"),t),this.setLocalValue("eventClick",g.get(this,"data.action"),t)},this.t41=function(t){this.bind(t,"src",[["templateParent","displayMode"],["templateParent","displayMode"],["templateParent","newUrl"],["templateParent","detailUrl"]],0,function(t,e,n,i){return 1==t?2==e?n:i:"about:none"})},this.t42=function(t){this.bind(t,"selectedIndex",["atomParent","displayMode"])},this.t45=function(t){this.bind(t,"data",["templateParent","selectedItem"])},this.t47=function(t){this.bind(t,"eventClick",["templateParent","backCommand"])},this.t48=function(t){this.bind(t,"data",["templateParent","newItemCopy"])},this.t50=function(t){this.bind(t,"eventClick",["templateParent","cancelAddCommand"])},this.t51=function(t){this.bind(t,"checked",["scope","itemSelected"],!0)},this.t52=function(t){this.setLocalValue("text",g.get(this,"data.label"),t)},this.t53=function(t){this.bind(t,"text",["label"])},this.t55=function(t){this.setLocalValue("showTabs","true",t),this.bind(t,"labelPath",["templateParent","labelPath"]),this.bind(t,"items",["templateParent","items"]),this.bind(t,"selectedIndex",["templateParent","selectedIndex"],!0)},this.t56=function(t){this.bind(t,"text",["data"])},this.t57=function(t){this.bind(t,"selectedIndex",["templateParent","selectedIndex"])},this.t58=function(t){this.bind(t,"value",["hours"],!0)},this.t59=function(t){this.bind(t,"value",["minutes"],!0)},this.t60=function(t){this.setLocalValue("items",[{label:"AM",value:"AM"},{label:"PM",value:"PM"}],t),this.bind(t,"value",["templateParent","ap"],!0)},this.t61=function(t){this.setLocalValue("text",g.get(this,"data.label"),t)},this.t62=function(t){this.setLocalValue("text",g.get(this,"data")[g.get(this,"atomParent.labelPath")],t)},this.t63=function(t){this.bind(t,"selectedIndex",["templateParent","currentStep"],!0)},this.t65=function(t){this.bind(t,"isEnabled",["canMoveBack"]),this.setLocalValue("eventClick",g.get(this,"goPrevCommand"),t),this.bind(t,"styleVisibility",[["currentStep"]],0,function(t){return t?"visible":"hidden"})},this.t66=function(t){this.bind(t,"text",["prevLabel"])},this.t67=function(t){this.bind(t,"class",[["nextClass"],["isLastStep"]],0,function(t,e){return t||(e?"finish-button":"")}),this.setLocalValue("eventClick",g.get(this,"nextCommand"),t),this.bind(t,"isEnabled",["nextCommand"])},this.t68=function(t){this.bind(t,"text",[["isLastStep"],["finishLabel"],["nextLabel"]],0,function(t,e,n){return t?e:n})},this.t69=function(t){this.bind(t,"value",["templateParent","hasValue"],!0)},this.t70=function(t){this.bind(t,"isEnabled",["hasValue"]),this.bind(t,"placeholder",["placeholder"])},this.t71=function(t){this.bind(t,"styleWidth",[["appWidth"]],0,function(t){return t+"px"}),this.bind(t,"styleHeight",[["appHeight"]],0,function(t){return t+"px"}),this.bind(t,"styleDisplay",[["isBusy"]],0,function(t){return t?"block":"none"})},this.t72=function(t){this.bind(t,"styleLeft",[["appWidth"]],0,function(t){return t/2-100+"px"}),this.bind(t,"styleTop",[["appHeight"]],0,function(t){return t/2-25+"px"})},this.t73=function(t){D.absPos(t,"12,12,36,36")},this.t74=function(t){D.absPos(t,"56,24,145,null"),this.bind(t,"text",[["busyMessage"]],0,function(t){return t||"Loading..."})},this.t75=function(t){D.absPos(t,"0,48"),this.bind(t,"styleDisplay",[["isBusy"],["progress"]],0,function(t,e){return t&&e?"block":"none"}),this.bind(t,"styleWidth",[["progress"]],0,function(t){return t+"%"})},this.t76=function(t){this.setLocalValue("items",g.get(this,"data"),t)},this.t78=function(t){this.setLocalValue("text",g.get(this,"data.label"),t)},this.t79=function(t){this.bind(t,"class",["fieldClass"]),this.bind(t,"styleDisplay",[["fieldVisible"]],0,function(t){return t?"":"none"})},this.t80=function(t){this.bind(t,"text",["label"]),this.bind(t,"styleMinWidth",[["atomParent","minLabelWidth"],["atomParent","minLabelWidth"]],0,function(t,e){return t?e+"px":void 0})},this.t81=function(t){this.bind(t,"class",[["required"]],0,function(t){return t?"atom-form-grid-required":"atom-form-grid-not-required"})},this.t82=function(t){this.bind(t,"class",[["error"]],0,function(t){return t?"atom-data-error":""})},this.t83=function(t){this.bind(t,"class",[["error"]],0,function(t){return t?"atom-data-error":""}),this.bind(t,"text",[["error"]],0,function(t){return t||""}),this.bind(t,"styleDisplay",[["error"]],0,function(t){return t?"":"none"})},this.t85=function(t){this.bind(t,"text",["label"]),this.bind(t,"styleMinWidth",[["atomParent","minLabelWidth"]],0,function(t){return t||void 0})},this.t86=function(t){this.bind(t,"text",[["required"]],0,function(t){return t?"*":""})},this.t87=function(t){this.bind(t,"class",[["error"]],0,function(t){return t?"atom-data-error":""})},this.t88=function(t){this.bind(t,"text",[["error"]],0,function(t){return t||""})},this.t90=function(t){this.bind(t,"text",["label"])},this.t91=function(t){this.bind(t,"text",[["required"]],0,function(t){return t?"*":""})},this.t92=function(t){this.bind(t,"class",[["error"]],0,function(t){return t?"atom-data-error":""})},this.t93=function(t){this.bind(t,"text",[["error"]],0,function(t){return t||""})},this.t95=function(t){this.setLocalValue("text",g.get(this,"data.Message"),t)},this.t96=function(t){this.setLocalValue("class",g.get(this,"data.Confirm")?"confirm-buttons":"alert-buttons",t)},this.t97=function(t){this.setLocalValue("eventClick",g.get(this,"templateParent.closeCommand"),t)},this.t98=function(t){this.setLocalValue("eventClick",[{data:{ConfirmValue:!0}},g.get(this,"templateParent.closeCommand")],t)},this.t99=function(t){this.setLocalValue("eventClick",g.get(this,"templateParent.closeCommand"),t)},this.t100=function(t){this.bind(t,"styleWidth",[["appScope","owner","bodyWidth"]],0,function(t){return t+"px"}),this.bind(t,"styleHeight",[["appScope","owner","appHeight"]],0,function(t){return t+"px"}),this.bind(t,"styleDisplay",[["isOpen"]],0,function(t){return t?"block":"none"})},this.t101=function(t){this.bind(t,"styleWidth",[["atomParent","windowWidth"]],0,function(t){return t+"px"}),this.bind(t,"styleHeight",[["atomParent","windowHeight"]],0,function(t){return t+"px"}),this.bind(t,"styleLeft",[["appScope","owner","bodyWidth"],["atomParent","windowWidth"]],0,function(t,e){return(t-e)/2+"px"}),this.bind(t,"styleTop",[["appScope","owner","bodyHeight"],["atomParent","windowHeight"]],0,function(t,e){return(t-e)/2+"px"})},this.t102=function(t){this.bind(t,"text",["atomParent","title"])},this.t103=function(t){this.setLocalValue("eventClick",g.get(this,"atomParent.cancelCommand"),t)},this.t104=function(t){this.setLocalValue("src",g.get(this,"templateParent.url"),t)}}.call(u.PageSetup,t,u);var m={};t.$x=m,m.stop=function(t,e){return function(){if(t)throw new Error(e)}},m.stopIf=t.stop,m.timeout=function(t,e){return function(){var n=this;setTimeout(function(){n.invokeAction(e)},t)}},m.invoke=function(t,e,n){return function(){var i={};if(void 0===n){var o={};o[e]=n,i[t]=o}else i[t]=e;this.invokeAction(i)}},m.data=function(t,e){m.invoke("data",t,e)},m.scope=function(t,e){m.invoke("scope",t,e)},m.localScope=function(t,e){m.invoke("localScope",t,e)},m.appScope=function(t,e){m.invoke("appScope",t,e)},m.owner=function(t,e){m.invoke("owner",t,e)},m.reveal=function(){return function(){}};var d={debug:!1,baseUrl:"",log:"",ajax:{versionUrl:!0,versionKey:"__wav",version:(new Date).toDateString(),headers:{}}};t.AtomConfig=d;var c=function(e){t.console&&console.log(e),d.log+=e+"\r\n"};t.log=c;var p={browserName:"",version:"1.0",majorVersion:1,isMobile:!1,userAgent:"",detect:function(){var t=(navigator.appVersion,navigator.userAgent);this.userAgent=t;var e,n,i,o=navigator.appName,a=""+parseFloat(navigator.appVersion),r=parseInt(navigator.appVersion,10);-1!=(n=t.indexOf("Opera"))?(o="Opera",a=t.substring(n+6),-1!=(n=t.indexOf("Version"))&&(a=t.substring(n+8))):-1!=(n=t.indexOf("MSIE"))?(o="Microsoft Internet Explorer",a=t.substring(n+5)):-1!=(n=t.indexOf("Chrome"))?(o="Chrome",a=t.substring(n+7)):-1!=(n=t.indexOf("Safari"))?(o="Safari",this.isMobile=-1!=t.indexOf("iPhone"),a=t.substring(n+7),-1!=(n=t.indexOf("Version"))&&(a=t.substring(n+8))):-1!=(n=t.indexOf("Firefox"))?(o="Firefox",a=t.substring(n+8)):(e=t.lastIndexOf(" ")+1)<(n=t.lastIndexOf("/"))&&(o=t.substring(e,n),a=t.substring(n+1),o.toLowerCase()==o.toUpperCase()&&(o=navigator.appName)),-1!=(i=a.indexOf(";"))&&(a=a.substring(0,i)),-1!=(i=a.indexOf(" "))&&(a=a.substring(0,i)),r=parseInt(""+a,10),isNaN(r)&&(a=""+parseFloat(navigator.appVersion),r=parseInt(navigator.appVersion,10)),this.browserName=o,this.majorVersion=r,this.isMobile=/android|mobile|ios|iphone/gi.test(t)},isFF:!1,isChrome:!1,isIE:!1,isSafari:!1,isMac:!1,init:function(){switch(this.isMac=/mac os x/gi.test(this.userAgent)&&!/iphone|ipad/gi.test(this.userAgent),this.browserName){case"Firefox":this.supportsUpload=this.majorVersion>=4,this.isFF=!0;break;case"Chrome":this.supportsUpload=this.majorVersion>=6,this.isChrome=!0;break;case"Microsoft Internet Explorer":this.supportsUpload=this.majorVersion>=10,this.isIE=!0;break;case"Safari":this.isSafari=!0,this.isMobile||(this.supportsUpload=this.majorVersion>=5)}this.supportsFlash=!this.isMobile}};t.AtomBrowser=p,p.detect(),p.init();var f=function(){return n("AtomEnumerator",null,function(t){this._array=t,this.i=-1},{next:function(){return this.i=this.i+1,this.i<this._array.length},current:function(){return this._array[this.i]},currentIndex:function(){return this.i},isFirst:function(){return 0==this.i},isLast:function(){return this.i==this._array.length-1},reset:function(){this.i=-1}})}();t.AtomEnumerator=f;var g={refreshWindowCommand:function(){location.reload(!0)},time:function(){return(new Date).getTime()},get:function(t,e){var n=e.indexOf(".");if(-1!=n){var i=e.substr(0,n);
return t=E.getValue(t,i),e=e.substr(n+1),g.get(t,e)}return E.getValue(t,e)},set:function(t,e,n){if(t){var i=e.indexOf(".");if(-1!=i){var o=e.substr(0,i);return t=E.getValue(t,o),e=e.substr(i+1),g.set(t,e,n)}E.setValue(t,e,n)}},csv:function(t,e,n){n||(n=", ");for(var i=[],o=new f(t);o.next();){var a=o.current();i.push(g.get(a,e))}return i.join(n)},range:function(t,e,n){var i=[];n=n||1;for(var o=t;e>=o;o+=n)i.push({label:o,value:o});return i},merge:function(t,e,n,i){if(t){var o=i?E.getClone(e):e;if(n)for(var a in o)g.set(t,a,E.getValue(o,a));else for(var a in o)t[a]=o[a];return t}},url:function(t,e,n){var i=t,o=[];if(e){for(var a in e)if(e.hasOwnProperty(a)){var r=e[a];if(void 0===r)continue;if(null===r)continue;r&&r.constructor!=String&&"object"==typeof r&&(r=JSON.stringify(r)),o.push(a+"="+encodeURIComponent(r))}if(o.length){var s=i.indexOf("?");i+=-1==s?"?":"&"}i+=o.join("&")}if(n){o=[];for(var a in n)if(n.hasOwnProperty(a)){var r=n[a];if(void 0===r||null===r)continue;o.push(a+"="+encodeURIComponent(r))}o.length&&(i+="#"+o.join("&"))}return i},encodeParameters:function(t){var e=[];for(var n in t)if(0!=n.indexOf("_")){var i=t[n];if(void 0!==i&&null!==i){var o=typeof i;("string"==o||"number"==o||"boolean"==o)&&e.push(n+"="+encodeURIComponent(i))}}return e.join("&")},tableLayout:function(t,e,n){return new u.AtomTableLayout(t,e,n)},toDash:function(t){return t.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()})},secureUrl:function(){for(var t="",e=0;e<arguments.length;e++){var n=arguments[e];if(null===n||void 0===n)return void 0;t+=n}return/^\/\//.test(t)?r.location.protocol+t:("https:"==r.location.protocol&&(t=t.replace(/http\:\/\//,"https://")),t)}};g.resolve=function(t,e){var n=!e;if(!t)return t;n&&(e=new B,e.list=[],e.done=function(n){g.remove(e.list,n),0==e.list.length&&e.pushValue(t)});var i=typeof t;if("object"==i)if("undefined"!=typeof t.length)for(var o=0;o<t.length;o++){var a=t[o];if(a){var r=t,s=o;a instanceof B||a.constructor==B?(e.list.push(a),a.failed(function(t){e.done(t)}),a.then(function(t){r[s]=t.value(),e.done(t)})):g.resolve(a,e)}}else for(var o in t){var a=t[o];if(a)if(a instanceof B||a.constructor==B){e.list.push(a),a.failed(function(t){e.done(t)});var r=t,s=o;a.then(function(t){r[s]=t.value(),e.done(t)})}else g.resolve(a,e)}return e.list.length?(n&&e.onInvoke(function(){for(var t=new f(e.list);t.next();)t.current().invoke(e._invoker)}),e):t},t.Atom=g,function(){for(var e,n=/\+/g,i=/([^&=]+)=?([^&]*)/g,o=function(t){return decodeURIComponent(t.replace(n," "))},a=t.location.search.substring(1),r={};e=i.exec(a);)r[o(e[1])]=o(e[2]);g.pageQuery=r}();var _={zoneOffsetMinutes:(new Date).getTimezoneOffset(),zoneOffset:60*(new Date).getTimezoneOffset()*1e3,toLocalTime:function(t){return t.toJSON()},m_names:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],setTime:function(t,e){if(!t||!e)return t;var n=e.split(":"),i=parseInt(n[0]);n=n[1].split(" ");var o=parseInt(n[0]);"PM"==n[1]&&12!=i&&(i+=12);var a=new Date(t.getFullYear(),t.getMonth(),t.getDate());return a.setHours(i),a.setMinutes(o),a},toMMDDYY:function(t){var e=t.getMonth()+1,n=t.getFullYear(),i=t.getDate(),o="";return o+=e>9?e:"0"+e,o+="/"+(i>9?i:"0"+i),o+="/"+n},toShortDateString:function(t){if(!t)return"";if(t.constructor==String){if(!/^\/date\(/gi.test(t))throw new Error("Invalid date format "+t);t=t.substr(6),t=new Date(parseInt(t,10))}return this.m_names[t.getMonth()]+" "+t.getDate()+", "+t.getFullYear()},toDateTimeString:function(t){if(!t)return"";t.constructor==String&&(t=t.substr(6),t=new Date(parseInt(t,10)));var e=_.toShortDateString(t);return e+" - "+_.toTimeString(t)},toTimeString:function(t){if(t=_.parse(t),!t)return"";var e=t.getHours(),n="AM";12==e?n="PM":e>12&&(e-=12,n="PM");var i=t.getMinutes();return 10>i?i="0"+i:(i+="",1==i.length&&(i+="0")),e+":"+i+" "+n},smartDate:function(t){if(!t)return null;var e=_.parse(t),n=new Date;if(n.getFullYear()===e.getFullYear()&&n.getMonth()===e.getMonth()){var i=n.getDate()-e.getDate();switch(i){case-1:return"Tomorrow ("+_.toTimeString(e)+")";case 0:return"Today ("+_.toTimeString(e)+")";case 1:return"Yesterday ("+_.toTimeString(e)+")"}}return _.toDateTimeString(e)},smartDateUTC:function(t){return _.smartDate(t)},jsonDate:function(t){var e=_.parse(t);return{Year:e.getFullYear(),Month:e.getMonth()+1,Date:e.getDate(),Hours:e.getHours(),Minutes:e.getMinutes(),Seconds:e.getSeconds(),Offset:_.zoneOffsetMinutes}},toUTC:function(t){if(!t)return"";t=_.parse(t);var e=new Date(t.getTime()+_.zoneOffset);return e},parse:function(t){if(!t)return null;if(t.constructor!==String)return t;if(/^\/date\([\-0-9]+\)\//gi.test(t))t=new Date(parseInt(t.substr(6),10));else{if(/^\/dateiso/gi.test(t)){t=t.substr(9),t=t.substr(0,t.length-1);var e=t.split("T"),n=e[0],i=e[1];n=n.split("-"),i=i.split(":");var o=new Date(n[0],parseInt(n[1])-1,n[2],i[0],i[1],parseFloat(i[2]));return o=new Date(o.getTime()+_.zoneOffset)}t=Date.parse(t)}return t}};t.AtomDate=_,_.monthList=[{label:"January",value:1},{label:"February",value:2},{label:"March",value:3},{label:"April",value:4},{label:"May",value:5},{label:"June",value:6},{label:"July",value:7},{label:"August",value:8},{label:"September",value:9},{label:"October",value:10},{label:"November",value:11},{label:"December",value:12}];var A={toFileSize:function(t){return t?(t.constructor==String&&(t=parseInt(t,10)),t>1073741824?Math.round(t/1073741824)+" GB":t>1048576?Math.round(t/1048576)+" MB":t>1024?Math.round(t/1024)+" KB":t+" B"):""}};t.AtomFileSize=A;var b={toSmallPhoneString:function(t){if(!t)return"";var e=t.split(":",6),n=e[2];n="("+(/^\+/.test(n)?"":"+")+e[2]+") ";{var i=e[3];e[4],e[5]}return i?n+i:""},toPhoneString:function(t){if(!t)return"";var e=t.split(":",6),n="(+"+e[2]+") ",i=e[3],o=e[4],a=e[5];if(!i)return"";var r=n+i;return o&&(r+=" (ext: "+o+")"),a&&(r+=" ("+a+")"),r}};t.AtomPhone=b;var C={ecache:{},becache:{},parse:function(t){var e=this.becache[t];if(e)return e;var n=/(?:(\$)(window|appScope|scope|data|owner|localScope))(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*/gi,i=[],o=[],a=t.replace(n,function(t){var e="v"+(i.length+1);return t=t.substr(0==t.indexOf("$owner.")?7:0==t.indexOf("owner.")?6:1),i.push(t.split(".")),o.push(e),e}),r="return "+a+";",s=r;try{r=C.compile(o,r)}catch(l){throw g.alert("Error executing \n"+s+"\nOriginal: "+t),l}return e={length:o.length,method:r,path:i,original:a},this.becache[t]=e,e},compile:function(t,e){var n=t.join("-")+":"+e,i=this.ecache[n];return i?i:(t.push("Atom"),t.push("AtomPromise"),i=new Function(t,e),this.ecache[n]=i,i)}};t.AtomEvaluator=C;var w=null;p.isIE&&p.majorVersion<9?(w=function(t){this.index=-1,this.nextItem=t.firstChild,this.findNext(),this.item=null},w.prototype={findNext:function(){for(var t=this.nextItem;t&&1!==t.nodeType;)t=t.nextSibling;this.nextItem=t,this.index++},isFirst:function(){return 1===this.index},isLast:function(){return this.item&&!this.nextItem},next:function(){return this.item=this.nextItem,this.item?(this.nextItem=this.item.nextSibling,this.findNext(),this.item?!0:!1):!1},current:function(){return this.item}},t.ChildEnumerator=w):(w=function(t){this.nextItem=t.firstElementChild,this.item=null,this.first=!0},w.prototype={isFirst:function(){return!this.item.previousElementSibling},isLast:function(){return this.item&&!this.nextItem},next:function(){return this.item=this.nextItem,this.item?(this.nextItem=this.item.nextElementSibling,this.item?!0:!1):!1},current:function(){return this.item}},t.ChildEnumerator=w),function(t){var e=function(t){this.a=t,this.i=-1};e.prototype={next:function(){return this.i++,this.i<this.a.length},current:function(){return this.a[this.i]}};var n={truef:function(){return!0},falsef:function(){return!1},get:function(t,e){if(t){var i=e.indexOf(".");if(-1===i)return t[e];var o=e.substr(0,i);return e=e.substr(i+1),n.get(t[o],e)}},escapeRegex:function(t,e,i,o){if(!e)return{test:n.falsef};var a=e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return t&&(a=t+a),i&&(a+=i),new RegExp(a,o)},compare:function(t,i){switch(t){case"==":case"=":return function(t){return t==i};case"<=":return function(t){return i>=t};case">=":return function(t){return t>=i};case"<":return function(t){return i>t};case">":return function(t){return t>i};case"between":return function(t){return t>=i[0]&&t<=i[1]};case"equals":return i=n.escapeRegex("^",i,"$","i"),function(t){return t?i.test(t):!i};case"contains":return i=n.escapeRegex("",i,"","i"),function(t){return t?i.test(t):!1};case"startswith":return i=n.escapeRegex("^",i,"","i"),function(t){return t?i.test(t):!i};case"endswith":return i=n.escapeRegex("",i,"$","i"),function(t){return t?i.test(t):!i};case"equals":return i=n.escapeRegex("^",i,"$"),function(t){return t?i.test(t):!i};case"containscs":return i=n.escapeRegex("",i,""),function(t){return t?i.test(t):!1};case"startswithcs":return i=n.escapeRegex("^",i,""),function(t){return t?i.test(t):!i};case"endswithcs":return i=n.escapeRegex("",i,"$"),function(t){return t?i.test(t):!i};case"~":return function(t){return i.test(t)};case"in":return function(t){if(!t)return!1;for(var n=new e(i);n.next();){var o=n.current();if(o==t)return!0}return!1};case"has":return function(t){if(!t)return!1;for(var n=new e(t);n.next();){var o=n.current();if(o==i)return!0}return!1};case"any":var o=n.filter(i);return function(t){if(!t)return!1;for(var n=new e(t);n.next();){var i=n.current();if(o(i))return!0}return!1};case"all":var o=n.filter(i);return function(t){if(!t)return!1;for(var n=new e(t);n.next();)if(!o(item))return!1;return!0};default:return function(){return!1}}},isString:function(t){return"string"==typeof t||t instanceof String},sort:function(t){if(!n.isString(t))return t;var e=t.split(",");return e=e.map(function(t){var e=t.split(" "),n=e[1]||"asc";return{field:e[0],desc:/desc/i.test(n),cs:/^cs/i.test(n)}}),function(t,i){if(null==t||void 0==t)return null==i||void 0==i?0:1;if(null==i||void 0==i)return 1;for(var o=0;o<e.length;o++){var a=e[o],r=a.field,s=t[r],l=i[r];if(a.desc){var u=s;s=l,l=u}if(s!=l){if(!s)return l?-1:0;if(!l)return s?1:0;if(n.isString(s)){if(a.cs)return s.localeCompare(l);if(s=s.toLowerCase(),l=l.toLowerCase(),s==l)continue;return s.localeCompare(l)}}}return 0}},build:function(t,e,i,o,a){if("$or"===e){var r=n.filter(i,!0);return void t.push(function(t){return r(t)})}if("$and"===e){var r=n.filter(i,!1);return void t.push(function(t){return r(t)})}if("$not"===e){var s=n.filter(i,a);return void t.push(function(t){return!s(t)})}var l=e.split(" ");1===l.length&&(l=e.split(":"));var u=l[0],h="==";2===l.length&&(h=l[1]);var m=function(t){return n.get(t,u)};if(0!==h.indexOf("!")){var d=n.compare(h,i),c=function(t){var e=m(t);return d(e)};t.push(c)}else{h=h.substr(1);var d=n.compare(h,i),c=function(t){var e=m(t);return!d(e)};t.push(c)}},filter:function(t,i){if(t===!1)return n.falsef;if(!t)return n.truef;var o=[];for(var a in t)if(t.hasOwnProperty(a)){var r=t[a];n.build(o,a,r,t,i)}return function(t){for(var n=new e(o),a=[];n.next();){var r=n.current(),s=r(t);if(a.push(s),s){if(i)return!0}else if(!i)return!1}for(n=new e(a);n.next();)if(!n.current())return!1;return!0}}};t.$f=n.filter,Array.prototype.filter||(Array.prototype.filter=function(t){for(var e=[],n=0;n<this.length;n++){var i=this[n];t(i,n)&&e.push(i)}return e});var i=Array.prototype.filter;Array.prototype.filter=function(t){return t instanceof Function||"function"==typeof t?i.call(this,t):i.call(this,$f(t))};var o=Array.prototype.sort;Array.prototype.sort=function(t){var e=n.sort(t);return o.call(this,e)}}(t);var y={nodeValue:p.isIE&&p.majorVersion<9?"nodeValue":"value",attributeMap:function(t,e){var n,i,o={},a=new f(t.attributes);if(e){for(;a.next();)n=a.current(),i=n.nodeName,/^data\-/i.test(i)&&(i=i.substr(5)),e.test(i)&&(e.lastIndex=0,o[i]={value:n[y.nodeValue],node:n});return o}for(;a.next();)n=a.current(),i=n.nodeName,/^data\-/i.test(i)&&(i=i.substr(5)),o[i]={value:n[y.nodeValue],node:n};return o},attr:function(t,e,n){if(void 0!==n)return/^(atom|style)\-/.test(e)&&(e="data-"+e),t.setAttribute(e,n),n;var i=t.getAttribute("data-"+e)||t.getAttribute(e);return i},removeAttr:function(t,e){t.removeAttribute(e),t.removeAttribute("data-"+e)},getAtomType:function(t){return y.attr(t,"atom-type")},cloneNode:p.isIE&&p.majorVersion<8?function(e){for(var n=t.document,i=n.createElement(e.nodeName),o=new f(e.attributes);o.next();){var a=o.current();try{var r=a.nodeName,s=a[y.nodeValue];if(!s)continue;i.setAttribute(r,s)}catch(l){}}for(var u=e.firstChild;u;){if(3==u.nodeType){var h=n.createTextNode(u.nodeValue);i.appendChild(h)}else 1==u.nodeType&&i.appendChild(y.cloneNode(u));u=u.nextSibling}return i}:function(t){return t.cloneNode(!0)},findPresenter:function(t){for(var e=new w(t);e.next();){var n=e.current(),i=y.attr(n,"atom-presenter");if(i)return n;var o=y.findPresenter(n);if(o)return o}return null},parseUrl:function(t){for(var e={},n=t.split("&"),i=new f(n);i.next();){var o=i.current().split("="),a=o[0],r=o[1];r&&(r=decodeURIComponent(r)),r=y.parseValue(r),e[a]=r}return e},parseValue:function(t){var e;return/^[0-9]+$/.test(t)?(e=parseInt(t,10),isNaN(e)||(t=e),t):/^[0-9]+\.[0-9]+/gi.test(t)?(e=parseFloat(t),isNaN(e)||(t=e),t):/true/.test(t)?t=!0:/false/.test(t)?t=!1:t},cancelEvent:function(t){var e=t.target;if(!(e&&/input/gi.test(e.nodeName)&&/checkbox/gi.test(e.type)))return t.preventDefault?t.preventDefault():t.stop(),t.returnValue=!1,t.stopPropagation(),!1},assignID:function(t){return t.id||(t.id="__waID"+y.getNewIndex()),t.id},atomParent:function(e){return e.atomControl?e.atomControl:e!==r&&e!==t&&e.parentNode?y.atomParent(e._logicalParent||e.parentNode):null},toNumber:function(t){return t?t.constructor==String?parseFloat(t):t:0},isNode:function(e){try{if(t.XMLHttpRequest&&e instanceof XMLHttpRequest)return!0}catch(n){}return e===t||e===r?!0:"object"==typeof Node?e instanceof Node:"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},createDelegate:function(t,e){return this.getDelegate(t,e,!0)},getDelegate:function(t,e,n){if(e&&e.constructor!=String)throw new Error("methodName has to be string");var i=t.__delegates;if(!i){if(!n)return null;i={},t.__delegates=i}var o=i[e];if(!o){if(!n)return null;var a=t[e];if(!a)throw new Error("method "+e+" not found");o=function(){return a.apply(t,arguments)},i[e]=o}return o},__index:1e3,getNewIndex:function(){return this.__index=this.__index+1,this.__index},contains:function(t,e){var n=t.length,i=0;for(i=0;n>i;i++)if(t[i]==e)return!0;return!1},removeAllChildren:function(t){for(;t.hasChildNodes();){var e=t.lastChild;if(!e)break;e.atomControl&&(e.atomControl.dispose(),delete e.atomControl),a(e).remove()}},isWebkit:function(){return-1==t.navigator.userAgent.toLowerCase().indexOf("webkit")?!1:!0},isWeirdControl:function(t){return"BUTTON"==t.nodeName||"SELECT"==t.nodeName||"INPUT"==t.nodeName&&"submit"==t.getAttribute("type")},parseCSS:function(t,e){var n=parseInt(a(t).css(e),10);return isNaN(n)?0:n},setItemRect:function(t,e){var n=this.isWeirdControl(t);e.width&&(e.width-=this.parseCSS(t,"marginLeft")+this.parseCSS(t,"marginRight"),n||(e.width-=this.parseCSS(t,"borderLeftWidth")+this.parseCSS(t,"borderRightWidth"),e.width-=this.parseCSS(t,"paddingLeft")+this.parseCSS(t,"paddingRight")),e.width<0&&(e.width=0),t.style.width=e.width+"px"),e.height&&(e.height-=this.parseCSS(t,"marginTop")+this.parseCSS(t,"marginBottom"),n||(e.height-=this.parseCSS(t,"borderTopWidth")+this.parseCSS(t,"borderBottomWidth"),e.height-=this.parseCSS(t,"paddingTop")+this.parseCSS(t,"paddingBottom")),e.height<0&&(e.height=0),t.style.height=e.height+"px"),e.left&&(t.style.left=e.left+"px"),e.top&&(t.style.top=e.top+"px")},getPresenterOwner:function(t,e){if(t._presenters)for(var n=new f(t._presenters);n.next();){var i=n.current();if(i==e)return t}return this.getPresenterOwner(t.get_atomParent(),e)},createCss:function(t){if(!t)return"";if(t.constructor==String)return t;var e=[];for(var n in t){var i=t[n];i&&e.push(n)}return e.join(" ")},createControl:function(t,e,n,i){if(!t.atomControl){if(e?e.constructor==String&&(e=u[e]):(e=y.getAtomType(t),e=u[e]),e){var o=new e(t);return n&&(o._data=n),i&&(o._scope=i),o.createChildren(),n&&o.init(),o}return null}}};t.AtomUI=y,y.isIE7=-1!=t.navigator.userAgent.indexOf("MSIE 7.0"),y.isIE8=-1!=t.navigator.userAgent.indexOf("MSIE 8.0"),t.AtomUri=function(t){var e,n="",i="",o=t.split("?");e=o[0],2==o.length?(n=o[1]||"",o=n.split("#"),n=o[0],i=o[1]||""):(o=e.split("#"),e=o[0],i=o[1]||"");var a=location.protocol,r=location.host,s=location.port,l=e.indexOf("//");-1!==l&&(a=e.substr(0,l),e=e.substr(l+2),l=e.indexOf("/"),-1!==l&&(r=e.substr(0,l),e=e.substr(l+1),o=r.split(":"),o.length>1&&(r=o[0],s=o[1]))),this.host=r,this.protocol=a,this.port=s,this.path=e,this.query=y.parseUrl(n),this.hash=y.parseUrl(i)},t.getInputError=function $(t,e,n){var i=e["atom-required"];if(i){if(!n)return a(t).addClass("atom-error-required"),i.msg||"Required";a(t).removeClass("atom-data-required")}if(i=e["atom-regex"]){var o=eval("("+i.value+")");if(!o.test(n))return a(t).addClass("atom-error-invalid"),i.msg||"Invalid";a(t).removeClass("atom-erorr-invalid")}if(i=e["atom-data-type"]){var r=i.value;if("email"==r){var o=/^(([^<>()\[\]\\.,;:\s@\"]+(\.[^<>()\[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;if(!o.test(n))return a(t).addClass("atom-error-email"),i.msg||"Invalid email";a(t).removeClass("atom-error-email")}}return null},t.getInputErrors=function M(t,e){var n=null,i=[];if(/input|select|textarea/i.test(t.nodeName)){n=a(t).val();var o=y.attributeMap(t,/atom\-(required|data\-error|regex)/),r=getInputError(t,o,n);r&&i.push({label:r,value:t})}else{var s=t.atomControl;if(s){if(!e&&s.constructor==u.AtomFormField)return s.getInputErrors();n=E.getValue(s,"value");var o=y.attributeMap(t,/atom\-(required|data\-error|regex)/),r=getInputError(t,o,n);r&&i.push({label:r,value:t})}for(var l=new w(t);l.next();){var h=l.current(),r=M(h);r&&(i=i.concat(r))}}return i.length?i:null},t.clearInputErrors=function(t){var e=a(t);e.removeClass("atom-error-invalid"),e.removeClass("atom-error-required"),e.removeClass("atom-error-email");var n=t.atomControl;if(n&&n.constructor==u.AtomFormField)return void n.clearInputErrors();for(var i=new w(t);i.next();){var o=i.current();clearInputError(o)}};var x={stack:[],startOrder:2e3,show:function(t,e,n,i){if(e.style.zOrder=this.startOrder++,0==n){var o=a(t).offset();e.style.position="absolute",e.style.left=o.left+"px",e.style.top=o.top+a(t).outerHeight(!0)+"px"}e.style.visibility="visible",this.stack.push({parent:t,element:e,removeHandler:i})},peek:function(){var t=null;return this.stack.length>0&&(t=this.stack[this.stack.length-1]),t},hide:function(t){var e=this.peek();if(e&&e.element===t){t.style.visibility="hidden";var n=this.stack.pop();n.removeHandler&&n.removeHandler(n.element)}},clicked:function(t){var e=t.target,n=x.peek();if(n){for(;e&&e!=n.element&&e!=n.parent;)e=e.parentNode;e!=n.element&&e!=n.parent&&(n.element.style.visibility="hidden",this.stack.pop(),n.removeHandler&&n.removeHandler(n.element))}}};t.AtomPopup=x,t.simulateParentClick=function(){var t=null;try{t=frameElement}catch(e){return}if(t&&parent){var n=parent.$;n(frameElement).click(),t.simulateParentClick&&t.simulateParentClick()}},a(t).click(function(e){x.clicked(e),t.simulateParentClick()}),$f.get=g.get,$f.compileSelect=function(t){return t?t.constructor==String?function(e){return g.get(e,t)}:function(e){var n={};for(var i in t){var o=t[i];i=JSON.stringify(i),n[i]=o?g.get(e,o):g.get(e,i)}return n}:function(t){return t}};var I={firstOrDefault:function(t){for(var e=$f(t);this.next();){var n=this.current();if(e(n))return n}return null},first:function(t){for(var e=$f(t);this.next();){var n=this.current();if(e(n))return n}throw new Error("Item not found in collection")},where:function(t){for(var e=$f(t),n=[];this.next();){var i=this.current();e(i)&&n.push(i)}return new f(n)},toArray:function(){for(var t=[];this.next();)t.push(this.current());return t},any:function(t){return this.firstOrDefault(t)?!0:!1},select:function(t){for(var e=$f.compileSelect(t),n=[];this.next();){var i=this.current();n.push(e(i))}return new f(n)},join:function(t){for(var e=[];this.next();)e.push(this.current());return e.join(t)},count:function(t){if(t)return this.where(t).count();for(var e=0;this.next();)e++;return e},sum:function(t){for(var e=0,n=this;n.next();){var i=n.current();t&&(i=g.get(i,t)),e+=+(i||0)}return e},groupBy:function(t){for(var e=$f.compileSelect(t),n=this,i={},o=[];n.next();){var a=n.current(),r=e(a),s=i[r];s||(s=[],i[r]=s,o.push({key:r,items:s})),s.push(a)}return g.query(o)}};t.AtomQuery=I;for(var P in I)f.prototype[P]=I[P];g.query=function(t){return void 0!==t.length?new f(t):t};var E={getClone:function(t){var e={};if("object"==typeof t){if("undefined"!=typeof t.length)var e=new Array;for(var n in t){var i=t[n];if(void 0!==i)if(null!==i){if(!/^\_\$\_/gi.test(n)){var o=typeof i;"object"==o?e[n]=i.constructor==Date?"/DateISO("+_.toLocalTime(i)+")/":E.getClone(i):"string"==o?e[n]=i:"number"==o?e[n]=i:"boolean"==o?e[n]=1==i?!0:!1:"date"==o&&(e[n]=i.getTime())}}else e[n]=null}}return e},setValue:function(t,e,n){if(t||void 0!==n){var i=E.getValue(t,e);if(i!==n){var o=t["set_"+e];o?o.apply(t,[n]):t[e]=n,E.refreshValue(t,e,i,n)}}},refreshValue:function(t,e){var n=E.get_WatchHandler(t,e);if(void 0!=n&&null!=n){for(var i=new f(n);i.next();){var o=i.current();o(t,e)}t._$_watcher&&t._$_watcher._onRefreshValue(t,e)}},getValue:function(t,e){if(null==t)return null;var n=t["get_"+e];return n?n.apply(t):t[e]},add_WatchHandler:function(t,e,n){if(null!=t){var i=E.get_WatchHandler(t,e);i.push(n)}},get_WatchHandler:function(t,e){if(null==t)return null;var n=t._$_handlers;n||(n={},t._$_handlers=n);var i=n[e];return(void 0==i||null==i)&&(i=[],n[e]=i),i},remove_WatchHandler:function(t,e,n){if(null!=t&&void 0!==t._$_handlers&&null!==t._$_handlers){var i=t._$_handlers[e];if(void 0!=i&&null!=i)for(var o=new f(i);o.next();)if(o.current()==n)return void i.splice(o.currentIndex(),1)}},invokeItemsEvent:function(t,e,n,i){var o="_items",a=E.get_WatchHandler(t,o);if(a){for(var r=new f(a);r.next();){var s=r.current();s(e,n,i)}t._$_watcher&&t._$_watcher._onRefreshItems(t,e,n,i),E.refreshValue(t,"length")}},clear:function(t){t.length=0,E.invokeItemsEvent(t,"refresh",0,null)},addItem:function(t,e){var n=t.length;t.push(e),E.invokeItemsEvent(t,"add",n,e)},insertItem:function(t,e,n){t.splice(e,0,n),E.invokeItemsEvent(t,"add",e,n)},addItems:function(t,e){for(var n=new f(e);n.next();)E.addItem(t,n.current())},removeItem:function(t,e){var n=t.indexOf(e);-1!=n&&(t.splice(n,1),E.invokeItemsEvent(t,"remove",n,e))},removeAtIndex:function(t,e){if(-1!=e){var n=t[e];t.splice(e,1),E.invokeItemsEvent(t,"remove",e,n)}},refreshItems:function(t){E.invokeItemsEvent(t,"refresh",-1,null)},add_CollectionChanged:function(t,e){if(null!=t){var n="_items",i=E.get_WatchHandler(t,n);i.push(e)}},remove_CollectionChanged:function(t,e){if(null!=t&&t._$_handlers){var n="_items",i=t._$_handlers[n];if(void 0!=i&&null!=i)for(var o=new f(i);o.next();)if(o.current()==e)return void i.splice(o.currentIndex(),1)}},setError:function(t,e,n){var i=E.getValue(t,"__errors");i||E.setValue(t,"__errors",{}),E.setValue(i,e,n)}};t.AtomBinder=E,g.clone=E.getClone,g.add=E.addItem,g.insert=E.insertItem,g.remove=E.removeItem,g.refresh=E.refreshValue,g.refreshArray=E.refreshItems,g.clearArray=E.clear,Array.prototype.enumerator=function(){return new f(this)},Array.prototype.indexOf||(Array.prototype.indexOf=function(t){var e=0;for(e=0;e<this.length;e++)if(t==this[e])return e;return-1});var V={split:function(t,e){e&&e.constructor==String&&(e=a.trim(e));for(var n,i=t.split(e),o=[],r=new f(i);r.next();)n=r.current(),n&&n.constructor==String&&(n=a.trim(n)),o.push(n);return o},getValues:function(t,e){var n,i=t;if(e){i=[];for(var o=new f(t);o.next();)n=o.current(),i.push(n[e])}return i},intersect:function(t,e,n){for(var i,o,a=[],r=new f(n);r.next();)i=r.current(),o=this.getMatch(t,e,i),void 0!=o&&a.push(o);return a},getMatch:function(t,e,n){for(var i,o,a=new f(t);a.next();)if(i=a.current(),o=i,e&&(o=i[e]),o==n)return i},remove:function(t,e){for(var n=new f(t);n.next();){var i=n.current();if(i==e)return void t.splice(n.currentIndex(),1)}}};t.AtomArray=V;var S=function(){return n("WebAtoms.AtomScope",null,function(t,e,n){this.owner=t,this.parent=e,n&&(this.__application=n),this.__application==this.owner&&(this._v=0,this.refreshCommand=function(){appScope._v=appScope._v+1,E.refreshValue(appScope,"_v")}),this._refreshValue=function(t){E.refreshValue(this,t),this.__application===this.owner&&this.__application._onRefreshValue(this,t)}},{setValue:function(t,e,n){if(E.getValue(this,t)==e)return void(n&&this._refreshValue(t));var i=this["set_"+t];i?i.apply(this,[e]):this[t]=e,this._refreshValue(t)}})}();!function(){return n("WebAtoms.AtomComponent",null,function(){this._eventHandlers=[]},{bindEvent:function(t,e,n,i,o){if(null!=t){"function"==typeof n&&(o=n),o=o||y.createDelegate(this,n);var r={element:t,name:e,methodName:n,handler:o};if(i&&(r.key=i),y.isNode(t))a(t).bind(e,null,o);else if(t.addEventListener)t.addEventListener(e,o,!1);else{var s=t["add_"+e];null==s?(s=E["add_"+e],i?s.apply(E,[t,i,o]):s.apply(E,[t,o])):s.apply(t,[o])}this._eventHandlers.push(r)}},unbindEvent:function(t,e,n,i){for(var o=new f(this._eventHandlers),r=[];o.next();){var s=o.current();if(!(t&&t!==s.element||e&&e!==s.name||n&&n!==s.methodName||i&&i!==s.key)){if(y.isNode(s.element))a(s.element).unbind(s.name,s.handler);else if(s.element.removeEventListener)s.element.removeEventListener(e,s.handler,!1);else{var l=s.element["remove_"+s.name];null==l?(l=E["remove_"+s.name],s.key?l.apply(E,[s.element,s.key,s.handler]):l.apply(E,[s.element,s.handler])):l.apply(s.element,[s.handler])}r.push(s)}}if(r.length==this._eventHandlers.length)this._eventHandlers.length=0;else for(o=new f(r);o.next();){var s=o.current();V.remove(this._eventHandlers,s)}},init:function(){},dispose:function(){this.unbindEvent(null,null,null),this.__delegates&&(this.__delegates=null)}})}();var B=function(){this._success=[],this._failed=[],this._cached=!1,this._process=null,this._calls=0,this._showProgress=!0,this._showError=!0;var t=this;this.success=function(){t.onSuccess.apply(t,arguments)},this.error=function(){t.onError.apply(t,arguments)}};t.AtomPromise=B,B.prototype={onSuccess:function(t){this._value=t,this._process&&(this._value=this._process(this._value));for(var e=this._success,n=0;n<e.length;n++)e[n](this)},onError:function(){this.errors=arguments;for(var t=this._failed,e=0;e<t.length;e++)t[e](this)},then:function(t){return this._success.push(t),this},process:function(t){return this._process=t,this},failed:function(t){return this._failed.push(t),this},value:function(t){return void 0!==t?void(this._value=t):this._value},onInvoke:function(t){return this._invoke=t,this},invoke:function(){if(!this._persist)return this.invokePromise(),this;var t=this;return this.promiseTimeout=setTimeout(function(){t.invokePromise()},100),this},invokePromise:function(){if(this.promiseTimeout=null,this._showProgress&&(atomApplication.setBusy(!0),0===this._calls)){var t=function(){atomApplication.setBusy(!1)};this.then(t),this.failed(t)}return this._calls++,this._invoke(this),this},pushValue:function(t){var e=this;this._cached=!0,setTimeout(function(){e.onSuccess.apply(e,[t])},1)},showProgress:function(t){return this._showProgress=t,this},showError:function(t){return this._showError=t,this},persist:function(t){return this._persist=void 0===t?!0:t,this},abort:function(){return this.promiseTimeout?(clearTimeout(this.promiseTimeout),void(this.promiseTimeout=null)):(this._failed.length=0,this._success.length=0,this._showProgress&&atomApplication.setBusy(!1),void(this.handle&&this.handle.abort()))}},B.getUrl=function(t){var e=location.href,n=e.indexOf("#");return-1!==n&&(e=e.substr(0,n)),t?(n=e.lastIndexOf("/"),-1!==n&&(e=e.substr(0,n+1)),/^(http|https)\:\/\//gi.test(t)?t:/^\//gi.test(t)?t:/^\./gi.test(t)?(t=t.substr(1),/\/$/gi.test(e)&&/^\//gi.test(t)&&(t=t.substr(1)),e+t):e+t):e},B.parseDates=function(t){if(!t)return t;var e=typeof t;if("object"===e){if("undefined"!=typeof t.length){for(var n=0;n<t.length;n++)t[n]=B.parseDates(t[n]);return t}for(var i in t){var o=t[i];o&&(t[i]=B.parseDates(o))}}return("string"==typeof t||t.constructor===String)&&/^\/date\(/gi.test(t)&&/\)\/$/gi.test(t)?_.parse(t):t},B.ajax=function(t,e,n){var i=new B;n||(n={type:"GET",dataType:"text",data:null}),d.ajax.versionUrl&&void 0!==n.versionUrl&&n.versionUrl&&(e=e||{},e[d.ajax.versionKey]=d.ajax.version),n.success=i.success,n.error=i.error,void 0===n.cache&&(n.cache=!1);var o=t,r=d.ajax.headers;if(r){n.headers||(n.headers={});for(var s in r){var l=r[s];n.headers[s]=l,d.debug&&c("Header set: "+s+"="+l)}}var u=d.ajax.statusCode;if(u){var h=n.statusCode||{};for(var s in u){var l=u[s];h[s]||(h[s]=l)}n.statusCode=h}var m=n,p=m.data;p&&(m.data=E.getClone(p));var v=d.ajax.jsonPostEncode;v?m=v(m):m.data={formModel:JSON.stringify(m.data)};var _=m.attachments;if(_&&_.length){for(var A=new FormData,b=new f(_);b.next();)A.append("file"+b.currentIndex(),b.current());if(p)for(var s in p)A.append(s,p[s]);m.type="POST",m.xhr=function(){var t=a.ajaxSettings.xhr();return t.upload&&t.upload.addEventListener("progress",function(t){if(t.lengthComputable){var e=Math.round(100*t.loaded/t.total);E.setValue(atomApplication,"progress",e)}},!1),t},m.cache=!1,m.contentType=!1,m.processData=!1}if(e){var C={};if(!m.sendRawQueryString)for(var s in e){var l=e[s];if(l&&"object"==typeof l){if(l=JSON.stringify(E.getClone(l)),void 0===l)continue;if(null===l)continue}C[s]=l}o=g.url(t,C)}return t&&i.onInvoke(function(){i.handle=a.ajax(o,m)}),i.failed(function(){var t=i.errors[0].responseText;t&&"Internal Server Error"===i.errors[2]||(t=i.errors[2]),i.error={msg:t},i._showError&&i.error.msg&&g.alert(i.error.msg)}),i.then(function(t){var e=t.value();e=B.parseDates(e),e&&e.items&&e.merge&&(e.items.total=e.total,e=e.items,t.value(e))}),i.showError(!0),i.showProgress(!0),i},B.get=function(t,e,n){return n=n||{},n.type=n.type||"get",n.dataType=n.dataType||"text",B.ajax(t,e,n,"get")},B.plugins={},B.json=function(t,e,n){n=n||{},n.type=n.type||"get",n.dataType=n.dataType||"json";var i=null,o=t.indexOf("://");if(-1!==o){var a=t.substr(0,o);/http|https/i.test(a)||(t=t.substr(o+3),i=B.plugins[a])}return(i=i||B.ajax)(t,e,n,"json")},B.cache={},B.cacheInProgress={},B.cachedPromise=function(e,n){var i=B.cache[e];return!i&&t.sessionStorage&&(i=t.sessionStorage["__AP"+e],i&&(i=JSON.parse(i),B.cache[e]=i)),i?(n.onInvoke(function(){n.pushValue(i)}),n):(n.then(function(n){B.cache[e]=n.value(),t.sessionStorage&&(t.sessionStorage["__AP"+e]=JSON.stringify(n.value()))}),n)},B.cachedJson=function(t,e,n){var i=(new Date,d.ajax.version),o=d.ajax.versionKey+"="+i;-1===t.indexOf("?")?o="?"+o:/\&$/.test(t)||(o="&"+o),t+=o,n=n||{},n.cache=!0,n.ifModified=!0,n.versionUrl=!1;var a=B.ajax(t,e,n,"json");return B.cachedPromise(t,a)},B.configCache={},B.configLabel=function(t,e,n){if(null===e||void 0===e)return"";n=n||{};var i=n.valuePath||"value",o=n.labelPath||"label",a=n.isNumber||!1;a&&"number"!=typeof e&&(e=parseFloat(e));var r=new B;return r.onInvoke(function(){var n=B.configCache[t];if(n)return n=n[e],n=n?n[o]:"",void r.pushValue(n);var s=B.cachedJson(t);s.then(function(n){for(var s="",l={},u=new f(n.value());u.next();){var h=u.current();s=h[i],a&&"number"!=typeof s&&(s=parseFloat(s)),l[s]=h}B.configCache[t]=l,l=l[e],l=l?l[o]:"",r.pushValue(l)}),s.invoke()}),r},B.prototype.insertItem=function(t,e,n){return this.then(function(i){var o=i.value();o._$_itemInserted||(n&&(o=o[n]),-1===t?o.push(e):o.splice(t||0,0,e),o._$_itemInserted=!0)})};var T={list:function(){},add:function(){},remove:function(){},clear:function(){},set:function(){},get:function(){}};B.plugins["local-storage"]=function(t,e,n){var i=t.split("/"),o=i[0],a=i[1],r=new B;return r.onInvoke(function(t){var i=T,r=i[a](o,e,n.data);t.pushValue(r)}),r},function(t){return i({name:"WebAtoms.AtomBinding",base:t,start:function(t,e,n,i,o,r,s,l){if(this.element=e,this.control=t,this.vf=s,this.key=n,this.events=l,a.isArray(i)){this.pathList=[],this.path=[];
for(var u=new f(i);u.next();){var h=u.current();if(a.isArray(h)){for(var m=new f(h),d=[];m.next();)d.push({path:m.current(),value:null});this.pathList.push(d)}else this.path.push({path:h,value:null})}this.path.length?this.pathList=null:this.path=null}else{var u=new f(i.split("."));for(this.path=[];u.next();)this.path.push({path:u.current(),value:null})}this.twoWays=o,this.jq=r,this._isUpdating=!1},methods:{onPropChanged:function(){if(null!=this.path&&0!=this.path.length){for(var t=new f(this.path),e=this.control,n=null;t.next();){if(n=t.current(),n.value=e,!e)return;t.isLast()||(e=E.getValue(e,n.path))}var i=null;if(this.jq)switch(this.key){case"valueAsDate":i=this.element.valueAsDate;break;case"checked":i=this.element.checked?!0:!1;break;default:i=a(this.element).val()}else i=E.getValue(this.control,this.key);E.setValue(e,n.path,i)}},onDataChanged:function(){if(!this._isUpdating&&void 0!==arguments&&0!=arguments.length){var t,e=this.control;if(this.pathList){var n=[];for(t=new f(this.pathList);t.next();)n.push(this.evaluate(e,t.current()));for(t=new f(n);t.next();)if(void 0===t.current())return;this.setValue(n)}else{var i=this.path,n=this.evaluate(e,i);void 0!==n&&this.setValue(n)}}},evaluate:function(t,e){for(var n=null,i=null,o=new f(e);t&&o.next();){if(i=o.current(),n=E.getValue(t,i.path),!/scope|appScope|atomParent|templateParent|localScope/gi.test(i.path)){i.value?i.value!=t&&(this.unbindEvent(i.value,"WatchHandler",null,i.path),this.bindEvent(t,"WatchHandler","onDataChanged",i.path)):this.bindEvent(t,"WatchHandler","onDataChanged",i.path)}i.value=t,t=n}return void 0===n&&d.debug&&c("Undefined:"+this.control._element.id+" -> "+a.map(e,function(t){return t.path}).join(".")),n},onValChanged:function(){var t=this;u.dispatcher.callLater(function(){t.onPropChanged(null,null)})},setup:function(){if(this.twoWays)if(this.jq){if(this.bindEvent(this.element,"change","onValChanged"),this.bindEvent(this.element,"blur","onValChanged"),this.events)for(var t=new f(this.events.split(","));t.next();)this.bindEvent(this.element,t.current(),"onValChanged")}else this.bindEvent(this.control,"WatchHandler","onPropChanged",this.key);this.onDataChanged(this,null)},setValue:function(t){!this.pathList&&this.vf&&(t=[t]),this.vf&&(t.push(g),t.push(B),t=this.vf.apply(this,t)),t instanceof B&&(t._persist=!0),this._lastValue=t,this._isUpdating=!0,this.control.setLocalValue(this.key,t,this.element,!0),this._isUpdating=!1}}})}(u.AtomComponent.prototype);var k={};t.allControls=k,function(e){return n("WebAtoms.AtomDispatcher",e,function(){this._paused=!1,this.queue=[],this.onTimeout=function(){if(!this._paused){if(0==this.queue.length){var e=atomApplication._element;return void(("hidden"==e.style.visibility||"hidden"==a(e).css("visibility"))&&(e.style.visibility="visible",e.atomControl.updateUI()))}var n=this.queue.shift();n(),t.setTimeout(this._onTimeout,1)}};var e=this;this._onTimeout=function(){e.onTimeout()}},{pause:function(){this._paused=!0},start:function(){this._paused=!1,t.setTimeout(this._onTimeout,1)},callLater:function(t){this.queue.push(t),this._paused||this.start()},setupControls:function(){var t=a("[data-atom-type],[atom-type]").first()[0];if(void 0==t.atomControl||null==t.atomControl){var e=y.getAtomType(t);a(t).removeAttr("atom-type"),a(t).removeAttr("data-atom-type");var n=new u[e](t);n.setup()}}})}(),u.dispatcher=new u.AtomDispatcher,function(e){return n("WebAtoms.AtomUIComponent",e,function(){},{get_owner:function(){return this},get_appScope:function(){return appScope},get_scope:function(){if(void 0===this._scope){var t=this.get_atomParent(this._element._logicalParent||this._element.parentNode);return t?t._localScope||t.get_scope():appScope}return this._scope},get_localScope:function(){if(void 0===this._localScope){var t=this.get_atomParent(this._element._logicalParent||this._element.parentNode);if(t)return t.get_localScope();throw new Error("Local Scope does not exist")}return this._localScope},set_scope:function(e){var n=this._localScope||this.get_scope();for(var i in e){if(/^(application|owner|app|parent)$/gi.test(i))throw new Error("Invalid name for the scope property");var o=e[i];n!=t.appScope||t.atomApplication._ready||0!=i.indexOf("_")&&void 0!==o&&null!==o&&/string|number|boolean/i.test(typeof o)&&(atomApplication._defaultScope[i]=o),void 0===n[i]&&(n[i]=o)}},get_name:function(){return this._name},getTemplate:function(t){var e=this["_"+t];return void 0!==e&&null!==e?e:(e=s.get(this.constructor,t))?(this["_"+t]=e,e):null}},{next:null,value:void 0})}(u.AtomComponent.prototype),s.compiled={},s.compileElement=function(t){var e=new f(t);e.next();var n=e.current(),i=r.createElement(n);if(!e.next())return i;if(n=e.current())for(var o in n)i.setAttribute(o,n[o]);for(;e.next()&&(n=e.current());)i.appendChild(n.constructor==String?r.createTextNode(n):s.compileElement(n));return i},s.compileJsonML=function(t){if(1==t.length)return s.compileElement(t[0]);for(var e=[],n=new f(t);n.next();)e.push(s.compileElement(n.current()));return e},s.compile=function(t,e,n){var i=r.createElement("div");return i.innerHTML=n,1==a(i).children().length&&(n=y.cloneNode(i.firstElementChild||i.children[0])),n},s.get=function(t,e){var n=t.__typeName+"."+e,i=this.compiled[n];return i?i:(i=s.jsonML[n],i?i=s.compileJsonML(i):t.__baseType&&(i=s.get(t.__baseType,e)),i?(this.compiled[n]=i,i):null)},s.compileType=function(t){var e=t.__typeName,n=e.split(".");n=n[n.length-1];var i=this.compiled[e];if(i)return i;i={};var o=this[e]||this[n];if(o)for(var a in o)i[a]=this.compile(t,a,o[a]);if(t.__baseType){var r=this.compileType(t.__baseType);for(var s in r)i[s]||(i[s]=r[s])}this.compiled[e]=i;var a=this;return delete a[e],delete a[n],i};var L={"{":function(t,e,n,i){n=n.substr(1,n.length-2);var o=C.parse(n);if(o.path){var a=new f(o.path);for(n=[];a.next();){for(var r=new f(a.current()),s=t;r.next();)s=E.getValue(s,r.current());n.push(s)}}else n=[n];n.push(g),n.push(B),n=o.method.apply(null,n),t.setLocalValue(e,n,i)},"[":function(t,e,n,i){n=n.substr(1,n.length-2);var o=C.parse(n);0==o.length?(n=eval(n),E.setValue(t,e,n)):1==o.length&&o.path[0]==o.original?t.bind(i,e,n,!1):t.bind(i,e,o.path,!1,o.method)},"$[":function(t,e,n,i){var o=n.lastIndexOf("]"),a=null;o<n.length-1&&(a=n.substr(o+2),a=a.substr(0,a.length-1)),n=n.substr(0,o),n=n.substr(2),/^(@|\$)/g.test(n)&&(n=n.substr(1)),t.bind(i,e,n,!0,null,a)},"^[":function(t,e,n,i){n=n.substr(2,n.length-3),/^(@|\$)/g.test(n)&&(n=n.substr(1)),t.bind(i,e,n,!0,null,"keyup,keydown,keypress,blur,click")}},D={any:function(t,e,n){y.attr(t,n,e)},isEnabled:function(t,e){e?y.removeAttr(t,"disabled"):y.attr(t,"disabled","disabled")},checked:function(t,e){t.checked!=e&&(t.checked=e?!0:!1)},value:function(t,e){/date|datetime/gi.test(t.type)?t.valueAsDate=_.parse(e):a(t).val(e)},valueAsDate:function(t,e){t.valueAsDate=_.parse(e)},text:function(t,e){t.innerHTML="";var n=r.createTextNode(e);t.appendChild(n)},mask:function(t,e){e?e.constructor===String?a(t).mask(e):a(t).mask(e.mask,e.settings):a(t).unmask()},html:function(t,e){t.innerHTML=e},absPos:function(t,e){D.setPosition(!0,t,e)},relPos:function(t,e){D.setPosition(!1,t,e)},"class":function(t,e){t.atomClass&&a(t).removeClass(t.atomClass),e&&(e=y.createCss(e),e&&a(t).addClass(e),t.atomClass=e)},setPosition:function(t,e,n){var i=n;i.constructor==String&&(i=eval("["+i+"]")),e.style.position=t?"absolute":"relative";var o=i[0],a=i[1];if(null!==o&&(e.style.left=o+"px"),null!==a&&(e.style.top=a+"px"),i.length>2){var r=i[2],s=i[3];void 0!==r&&null!==r&&(e.style.width=r+"px"),void 0!==s&&null!==s&&(e.style.height=s+"px")}}};t.AtomProperties=D,function(n){return i({name:"WebAtoms.AtomControl",base:n,start:function(t){t.atomControl=this,this._element=t,this.dispatcher=u.dispatcher,this.bindings=[],this._isVisible=!0;var e=t.id;e&&appScope&&(/^\_\_waID/.test(e)||(appScope[e]=this)),y.assignID(t),k[e]=this},properties:{layout:null,loadNext:null,next:null,merge:void 0,value:void 0},methods:{set_merge:function(t){if(this._mergeData2=null,t){var e=t.data;e&&(g.merge(this.get_data(),e,!0),this._mergeData2=e),e=t.scope,e&&g.merge(this.get_scope(),e,!0),e=t.appScope,e&&g.merge(this.get_appScope(),e,!0),e=t.localScope,e&&g.merge(this.get_localScope(),e,!0),e=t.owner,e&&g.merge(this,e,!0);var n=t.timeOut||t.timeout;if(n){var i=this,o=100;return n.hasOwnProperty("length")&&n.length>1&&(o=n[0],n=n[1]),void setTimeout(function(){i.set_merge(n)},o)}}},invokeAction:function(t,n){try{e.call(this,t,n)}catch(i){alert(i),console.error&&console.error(i)}},refresh:function(){},get_element:function(){return this._element},clearBinding:function(t,e){for(var n,i=new f(this.bindings),o=[];i.next();)n=i.current(),t&&n.element!=t||e&&n.key!=e||(n.dispose(),o.push(n));for(i=new f(o);i.next();)V.remove(this.bindings,i.current())},addBinding:function(t,e,n,i,o,a,r,s){this.clearBinding(e,n);var l=new u.AtomBinding(t,e,n,i,o,a,r,s);this.bindings.push(l),l.setup()},get_atomParent:function(e){if(null==e){if(!this._element._logicalParent&&!this._element.parentNode)return null;e=this._element._logicalParent||this._element.parentNode}return e.atomControl?e.atomControl:e!==r&&e!==t&&e.parentNode?this.get_atomParent(e._logicalParent||e.parentNode):null},get_templateParent:function(t){if(t||(t=this._element),t._templateParent)return t._templateParent;var e=t._logicalParent||t.parentNode;if(!e)throw new Error("Could not find templateParent");return this.get_templateParent(t._logicalParent||t.parentNode)},get_data:function(){if(void 0===this._data){var t=this.get_atomParent(this._element._logicalParent||this._element.parentNode);if(t)return t.get_data()}return this._data},set_data:function(t){this._data=t,this.mergeData(),this.updateChildBindings(this._element)},mergeData:function(){this._mergeData2&&g.merge(this.get_data(),this._mergeData2,!0)},updateChildBindings:function(t){for(var e=new w(t);e.next();){var n=e.current();if(n.atomControl&&n.atomControl._created){var i=n.atomControl;if(void 0!==i._data)continue;E.refreshValue(i,"data"),i.mergeData()}this.updateChildBindings(n)}},initProperties:function(){if(!this._disposed){var t=this.get_element();this.setProperties(t),this._created=!0,this.onCreated(),this.onLoaded()}},createChildren:function(){this.onCreateChildren(this._element);var t=this.getTemplate("template");if(t){var e=new w(this._element);if(!e.next()){if(t.constructor==String){this._element.innerHTML=t;var n=this;a(this._element).children().each(function(){this._templateParent=n})}else if(y.isNode(t))t=y.cloneNode(t),t._templateParent=this,this._element.appendChild(t);else for(var i=new f(t);i.next();){var o=i.current();o=y.cloneNode(o),o._templateParent=this,this._element.appendChild(o)}this.onCreateChildren(this._element)}}},onCreateChildren:function(t){for(var e,n=new w(t);n.next();){e=n.current();var i=y.attributeMap(e,/^atom\-(template|presenter|type|template\-name)$/gi),o=i["atom-template"];if(o)e.removeAttributeNode(o.node),t.templateOwner=!0,this["_"+o.value]=e,t.removeChild(e);else{var a=i["atom-template-name"];if(a)e.removeAttributeNode(a.node),this._scopeTemplates=this._scopeTemplates||{},this._scopeTemplates[a.value]=e,t.removeChild(e);else{var r=i["atom-presenter"];if(r){var s=y.getPresenterOwner(this,r.value);s["_"+r.value]=e}var l=i["atom-type"];l?y.createControl(e,l.value):this.onCreateChildren(e)}}}},onLoaded:function(){},onUpdateUI:function(){this._layout?this._layout.doLayout(this._element):this.updateChildUI(this.get_element())},updateUI:function(){var t=this;this.dispatcher.callLater(function(){t.onUpdateUI()})},updateChildUI:function(t){t||(t=this._element);for(var e=new w(t);e.next();){var n=e.current();n.atomControl?n.atomControl.updateUI():this.updateChildUI(n)}},onCreated:function(){this.updateUI()},setProperties:function(t){var e,n,i,o=t.attributes,r=new f(o),s=[],l="value";p.isIE&&p.majorVersion<9&&(l="nodeValue");for(var h={},m=null;r.next();)i=r.current(),e=i.nodeName,n=i[l],"data-atom-init"!==e?(/^data\-atom/.test(e)&&(e=e.substr(5)),/^atomControl$/g.test(e)||(/^atom\-type$/.test(e)?s.push(i):/^(atom|bind|style|event)\-/g.test(e)&&(/^(style|event)\-/g.test(e)||(e=e.substr(5)),n&&(/(^style$|dock)/.test(e)||s.push(i),e=a.camelCase(e),h[e]=n)))):(m=n,s.push(i));if(m){var d=u.PageSetup[m];d.call(this,t)}for(e in h)this.setValue(e,h[e],!0,t);for(r=new f(s);r.next();)t.removeAttributeNode(r.current());for(var c=new w(t);c.next();){var v=c.current();v.atomControl||this.setProperties(v)}},setValue:function(t,e,n,i){if(e&&e.constructor==String){var o=e[0],a=L[o];if(a)return void a(this,t,e,i);if(o+=e[1],a=L[o])return void a(this,t,e,i)}this.setLocalValue(t,e,i)},setLocalValue:function(t,e,n,i){if(void 0!==e){if(e&&e instanceof B){n._promisesQueue=n._promisesQueue||{};var o=n._promisesQueue[t];o&&o.abort(),n._promisesQueue[t]=e,e._persist&&(this._promises=this._promises||{},this._promises[t]=e);var a=this;return e.then(function(e){n._promisesQueue[t]==e&&(n._promisesQueue[t]=null),n._promisesQueue[t]=null,a.setLocalValue(t,e.value(),n,!0),a._loadNext&&a.invokeAction(a._loadNext)}),e.failed(function(e){n._promisesQueue[t]==e&&(n._promisesQueue[t]=null)}),void e.invoke()}if(this._element==n){var r=this["set_"+t];if(null!=r){if(i){var s=E.getValue(this,t);if(s==e)return}return r.apply(this,[e]),void(i&&E.refreshValue(this,t))}}if(/^style/g.test(t)&&t.length>5){var l=t.substr(5);return l=String.fromCharCode(l.charCodeAt(0)).toLowerCase()+l.substr(1),void(n.style[l]=e)}if(/^event/g.test(t)&&t.length>5){var l=t.substr(5);l=String.fromCharCode(l.charCodeAt(0)).toLowerCase()+l.substr(1);var u=this;return this.unbindEvent(n,l),void this.bindEvent(n,l,null,null,function(t){u.invokeAction(e,t)})}var h=D[t]||D.any;h&&h(n||this._element,e,t)}},bind:function(e,n,i,o,a,r){if(null==i)return void this.clearBinding(e,n);var s=this;i&&i.constructor==String&&/^window\./g.test(i)&&(s=t);var l=this.get_element(),u=l!=e;if(!u){var h=this["get_"+n];(void 0==h||null==h)&&(u=!0)}switch(n){case"value":/input/gi.test(e.nodeName)&&(u=!0),this.addBinding(s,e,"value",i,o,u,a,r);break;case"text":this.addBinding(s,e,"text",i,!1,!0,a,r);break;default:this.addBinding(s,e,n,i,o,u,a,r)}},onInitialized:function(){},init:function(){n.init.apply(this,arguments);var t=this.get_element(),e=y.attributeMap(t,/^atom\-(name|local\-scope)$/gi),i=e["atom-name"];if(i)t.removeAttributeNode(i.node),i=i.value;else{var o=t.id;/^\_\_waID/.test(o)||(i=t.id)}if(i){if(/^(app|window|owner|scope|localScope|parent)$/gi.test(i))throw new Error("Invalid Control Name '"+i+"'");var a=this.get_scope();E.setValue(a,i,this),this._name=i}ls=e["atom-local-scope"],ls&&(this._localScope=new S(this,this.get_scope(),atomApplication),this._scope=this._localScope,this._name&&(this._localScope[this._name]=this),t.removeAttributeNode(ls.node));var r=this._scopeTemplates;if(r){var a=this.get_scope();for(var s in r){var l=r[s];E.setValue(a,s,l)}}var h=this;u.dispatcher.callLater(function(){h.initProperties()}),this.initChildren(this._element),u.dispatcher.callLater(function(){h.onInitialized()})},dispose:function(t){if(t){var e=t.atomControl;return e?e.dispose():(this.clearBinding(t),this.disposeChildren(t)),void a(t).remove()}this._disposed=!0,this.disposeChildren(this._element),this.clearBinding(),this.bindings.length=0,n.dispose.apply(this,arguments)},disposeChildren:function(t){for(var e=p.isIE&&p.majorVersion<9,n=new w(t);n.next();){var i=n.current();i.atomControl?(i.atomControl.dispose(),e?i.atomControl=void 0:delete i.atomControl):(this.clearBinding(i),this.unbindEvent(i),this.disposeChildren(i))}try{t.innerHTML=""}catch(o){a(t).html("")}},get_innerTemplate:function(){return this._template},set_innerTemplate:function(t){if(this._template!==t||!this._created){if(!this._created){var e=this;return void u.dispatcher.callLater(function(){e.set_innerTemplate(t)})}this._template=t,this.disposeChildren(this._element),this.createChildren(),this.setProperties(this._element),this.initChildren(this._element),this.updateUI()}},initChildren:function(t){for(var e,n,i=new w(t),o=[];i.next();)if(e=i.current(),"SCRIPT"!=e.nodeName)n=e.atomControl,n?n.init():this.initChildren(e);else{var r=a.trim(e.innerHTML);if(/^\(\{/.test(r)&&/\}\)$/.test(r))try{r=new Function("return "+r+";")(),this.set_scope(r)}catch(s){c(JSON.stringify(s)),alert(JSON.stringify(s))}o.push(e)}for(i=new f(o);i.next();)t.removeChild(i.current())}}})}(u.AtomUIComponent.prototype),function(t){return i({name:"WebAtoms.AtomItemsControl",base:t,start:function(){this._selectedItems=[],this._selectedElements=[],this._selectedIndexSet=!1,this._onUIChanged=!1,this._itemsPresenter=null,this._itemsPanel=null,this._presenters=["itemsPresenter"],this._childItemType=u.AtomControl},properties:{allowSelectFirst:!1,allowMultipleSelection:!1,uiVirtualize:!1,defaultValue:null,autoScrollToSelection:!1,selectAll:void 0,labelPath:"label",valuePath:"value",sortPath:null,valueSeparator:null,postData:null,postUrl:null,confirm:!1,confirmMessage:null,filter:null,items:null,itemTemplate:null},methods:{get_postData:function(){return this._postData||this.get_selectedItem()},get_allValues:function(){if(this._valueSeparator&&this._valuePath){for(var t=[],e=this._valuePath,n=function(t){return t[e]},i=g.query(this.get_dataItems());i.next();)t.push(n(i.current()));return t.join(this._valueSeparator)}},get_value:function(){if(this._allowMultipleSelection){var t=this._selectedItems;return 0==t.length?void 0!==this._value?this._value:null:(t=V.getValues(t,this._valuePath),this._valueSeparator&&(t=t.join(this._valueSeparator)),t)}var e=this.get_selectedItem();return e?(this._valuePath&&(e=e[this._valuePath]),e):void 0!==this._value?this._value:null},set_value:function(t){if(this._value=t,void 0===t||null===t)return void E.clear(this._selectedItems);var e=this.get_dataItems();this._allowMultipleSelection&&this._valueSeparator?(t.constructor!=String&&(t=""+t),t=V.split(t,this._valueSeparator)):t=[t];var n=V.intersect(e,this._valuePath,t);this._selectedItems.length=0;for(var i=new f(n);i.next();)this._selectedItems.push(i.current());E.refreshItems(this._selectedItems)},set_sortPath:function(t){this._sortPath=t,t&&this.onCollectionChangedInternal("refresh",-1,null)},set_selectAll:function(t){if(void 0!==t&&null!==t){this._selectedItems.length=0;var e=this.get_dataItems();if(t&&e)for(var n=new f(e);n.next();)this._selectedItems.push(n.current());this._selectAll=!0,E.refreshItems(this._selectedItems)}},refresh:function(){this._promises&&this._promises.items&&this._promises.items.invoke()},set_defaultValue:function(t){this.get_value()||E.setValue(this,"value",t)},invokePost:function(){if(this._onUIChanged&&(!this._confirm||confirm(this._confirmMessage))){if(!this._postUrl)return void this.invokeAction(this._next);var t=this.get_postData();if(null!==t&&void 0!==t){t=E.getClone(t);var e=this,n=B.json(this._postUrl,null,{type:"POST",data:t});n.then(function(){e.invokeNext()}),n.invoke()}}},invokeNext:function(){this.invokeAction(this._next)},set_filter:function(t){t!=this._filter&&(this._filter=t,this._filteredItems=null,this.hasItems()&&this.onCollectionChangedInternal("refresh",-1,null))},isSelected:function(t){for(var e=new f(this._selectedItems),n=null;e.next();)if(n=e.current(),n==t)return!0;return!1},get_dataItems:function(){var t=this._items;if(this.hasItems()){var e=this._filter;if(e){var n=[];if("object"==typeof e)n=g.query(t).where(e).toArray();else for(var i=new f(t);i.next();){var o=i.current();e(o,i.currentIndex())&&n.push(o)}this._filteredItems=n,t=n}var r=this._sortPath;return r&&(t=t.sort(r)),t}return a(this._itemsPresenter).children()},getIndexOfDataItem:function(t){if(null==t)return-1;for(var e=this.get_dataItems(),n=new f(e);n.next();)if(n.current()==t)return n.currentIndex();return-1},getDataItemAtIndex:function(t){return-1==t?null:this.get_dataItems()[t]},get_childAtomControls:function(){for(var t=this._itemsPresenter||this._element,e=[],n=new w(t);n.next();){var i=n.current();i=!i||i.atomControl,i&&e.push(i)}return e},get_selectedChild:function(){var t=this.get_selectedItem();if(!this.hasItems())return t;for(var e=new w(this._itemsPresenter);e.next();){var n=e.current();if(n.atomControl.get_data()==t)return n}return null},set_allowSelectFirst:function(t){t=t?"false"!=t:t,this._allowSelectFirst=t},get_selectedItem:function(){return this._selectedItems.length>0?this._selectedItems[0]:null},set_selectedItem:function(t){t?(this._selectedItems.length=1,this._selectedItems[0]=t):this._selectedItems.length=0,E.refreshItems(this._selectedItems)},get_selectedItems:function(){return this._selectedItems},set_selectedItems:function(){throw new Error("Not yet implemented")},get_selectedIndex:function(){var t=this.get_selectedItem();return this.getIndexOfDataItem(t)},set_selectedIndex:function(t){E.setValue(this,"selectedItem",this.getDataItemAtIndex(t))},updateChildSelections:function(){},bringSelectionIntoView:function(){if(!this._allowSelectFirst||0!=this.get_selectedIndex())for(var t=new w(this._itemsPresenter);t.next();){var e=t.current(),n=e.atomControl?e.atomControl.get_data():e;if(this.isSelected(n))return void e.scrollIntoView()}},updateSelectionBindings:function(){E.refreshValue(this,"value"),E.refreshValue(this,"selectedItem"),E.refreshValue(this,"selectedItems"),E.refreshValue(this,"selectedIndex"),this._selectedItems.length||this._selectAll===!0&&(this._selectAll=!1,E.refreshValue(this,"selectAll"))},onSelectedItemsChanged:function(t,e,n){this._onUIChanged||(this.updateChildSelections(t,e,n),this._autoScrollToSelection&&this.bringSelectionIntoView()),this.updateSelectionBindings(),this.updateUI(),this.invokePost()},hasItems:function(){return void 0!=this._items&&null!=this._items},get_items:function(){return this._items},set_items:function(t){var e=this;this._items&&this.unbindEvent(this._items,"CollectionChanged",null),this._items=t,this._filteredItems=null,null!=t&&(this.bindEvent(this._items,"CollectionChanged",function(){e.onCollectionChangedInternal.apply(e,arguments)}),this.onCollectionChangedInternal("refresh",-1,null))},set_itemTemplate:function(t){this._itemTemplate=t,this.onCollectionChangedInternal("refresh",-1,null)},onCollectionChangedInternal:function(t,e,n){if(this._created){g.refresh(this,"allValues");var i=this.get_value();if(this.hasItems()&&(this.onCollectionChanged(t,e,n),i||this._allowSelectFirst||E.clear(this._selectedItems)),null!=i){if(this.set_value(i),-1!=this.get_selectedIndex())return;this._value=void 0}this.selectDefault()}},selectDefault:function(){return this._allowSelectFirst&&this.get_dataItems().length>0?void this.set_selectedIndex(0):void this.updateSelectionBindings()},onScroll:function(){this.scrollTimeout&&clearTimeout(this.scrollTimeout);var t=this;this.scrollTimeout=setTimeout(function(){t.scrollTimeout=0,t.onCollectionChangedInternal("refresh",-1,null)},1e3)},onCollectionChanged:function(t,e,n){if(/remove/gi.test(t)){for(var i=new w(this._itemsPresenter);i.next();){var o=i.current();if(o.atomControl&&o.atomControl.get_data()==n){o.atomControl.dispose(),a(o).remove();break}}return void this.updateUI()}var r=this.get_scope(),s=this.getTemplate("itemTemplate");if(s&&(s=y.getAtomType(s),s&&(this._childItemType=s)),/add/gi.test(t)){u.dispatcher.pause();for(var l=new f(this._items),i=new w(this._itemsPresenter);l.next();){i.next();var o=i.current();if(l.currentIndex()==e){var h=this.createChildElement(r,this._itemsPresenter,n,l,o);this.applyItemStyle(h,n,l.isFirst(),l.isLast());break}if(l.isLast()){var h=this.createChildElement(r,this._itemsPresenter,n,l);this.applyItemStyle(h,n,l.isFirst(),l.isLast());break}}return u.dispatcher.start(),void this.updateUI()}{var m=this._itemsPresenter;this.get_dataItems()}this.disposeChildren(m),u.dispatcher.pause();var d,c,p=this.get_dataItems(!0),v=[],l=new f(p);for(this.getTemplate("itemTemplate");l.next();){var d=l.current(),c=this.createChildElement(r,m,d,l);v.push(c),this.applyItemStyle(c,d,l.isFirst(),l.isLast())}var g=this;u.dispatcher.callLater(function(){for(var t=[],e=new w(m);e.next();){var n=e.current(),i=v.filter(function(t){return n==t});i.pop()!=n&&t.push(n)}for(e=new f(t);e.next();){var n=e.current();g.dispose(n),a(n).remove()}}),u.dispatcher.start(),E.refreshValue(this,"childAtomControls")},set_innerTemplate:function(){this._itemsPresenter=this._element,t.set_innerTemplate.apply(this,arguments),this.onCollectionChangedInternal("mode",-1,null)},applyItemStyle:function(){},createChildElement:function(t,e,n,i,o){var a=y.cloneNode(this._itemTemplate);a._logicalParent=e,a._templateParent=this,a._isDirty=!0,u.dispatcher.callLater(function(){o?e.insertBefore(a,o):e.appendChild(a)});var r=new S(this,t,t.__application);i&&(r.itemIsFirst=i.isFirst(),r.itemIsLast=i.isLast(),r.itemIndex=i.currentIndex(),r.itemExpanded=!1,r.data=n,r.get_itemSelected=function(){return r.owner.isSelected(n)},r.set_itemSelected=function(){r.owner.toggleSelection(n,!0)});y.createControl(a,this._childItemType,n,r);return a},toggleSelection:function(t){this._onUIChanged=!0,this._value=void 0,this._allowMultipleSelection?y.contains(this._selectedItems,t)?E.removeItem(this._selectedItems,t):E.addItem(this._selectedItems,t):(this._selectedItems.length=1,this._selectedItems[0]=t,E.refreshItems(this._selectedItems)),this._onUIChanged=!1},onUpdateUI:function(){t.onUpdateUI.call(this);for(var e=new w(this._itemsPresenter);e.next();){var n=e.current();if(n.atomControl){var i=n.atomControl.get_data();E.refreshValue(n.atomControl.get_scope(),"itemSelected"),this.applyItemStyle(n,i,e.isFirst(),e.isLast())}}},onCreated:function(){this._items&&this.onCollectionChangedInternal("refresh",-1,null);var t=this;this.dispatcher.callLater(function(){t._autoScrollToSelection&&t.bringSelectionIntoView()})},init:function(){this.get_element();this._itemsPresenter||(this._itemsPresenter=this._element);var e=this;this.bindEvent(this._selectedItems,"CollectionChanged",function(){e.onSelectedItemsChanged.apply(e,arguments)}),t.init.apply(this,arguments);var n=this;this.removeItemCommand=function(t,e){if(e){var i=e.get_data();E.removeItem(n._items,i)}},this.removeSelectedCommand=function(){for(var t=n.get_selectedItems().slice(0),e=new f(t);e.next();)E.removeItem(n.get_items(),e.current())},this.removeAllCommand=function(){E.clear(n.get_items())}}}})}(u.AtomControl.prototype),function(t){return i({name:"WebAtoms.AtomButton",base:t,start:function(t){this._sendData=!1,a(t).addClass("atom-button")},properties:{sendData:!1},methods:{onClickHandler:function(t){return y.cancelEvent(t),this._next&&(this._sendData&&this._next&&E.setValue(this._next,"data",this.get_data()),this.invokeAction(this._next)),!1},init:function(){var e=this._element;this.bindEvent(e,"click","onClickHandler"),t.init.apply(this)}}})}(u.AtomControl.prototype),function(t){return i({name:"WebAtoms.AtomListBox",base:t,start:function(){this._labelPath="label",this._valuePath="value",this._autoScrollToSelection=!1},properties:{autoSelectOnClick:!0},methods:{setClass:function(){var t=a(this._element);t.addClass("atom-list-box")},onClick:function(t){this._autoSelectOnClick&&this.onSelectItem(null,null,t)},get_itemWidth:function(){if(!this._items||!this._items.length)return 0;var t=a(this._element).innerWidth();return t/this._items.length},applyItemStyle:function(t,e,n,i){var o=a(t);o.removeClass("selected-item list-item first-item last-item"),e&&(o.addClass("list-item"),n&&o.addClass("first-item"),i&&o.addClass("last-item"),this.isSelected(e)&&o.addClass("selected-item"))},onCreated:function(){this.bindEvent(this._itemsPresenter,"click","onClick"),t.onCreated.call(this)},invokePost:function(){-1!=this.get_selectedIndex()&&t.invokePost.apply(this,arguments)},onSelectItem:function(t,e,n){for(var i=n?n.target:null,o=this._itemsPresenter,a=i||e._element;null!=a.parentNode&&a.parentNode!=o;)a=a.parentNode;if(a!=r){var s=a;this.hasItems()&&(s=a.atomControl.get_data()),this.toggleSelection(s)}},updateChildSelections:function(){var e=this._element;if(/select/i.test(e.tagName)){var n=this.get_selectedIndex();e.selectedIndex!=n&&u.dispatcher.callLater(function(){e.selectedIndex=n})}else t.updateChildSelections.apply(this,arguments)},init:function(){this.setClass(),t.init.call(this);var e=this,n=this._element;/select/i.test(n.tagName)&&(this.set_allowSelectFirst(!0),this.bindEvent(n,"change",function(){E.setValue(e,"selectedIndex",n.selectedIndex)})),this.selectCommand=function(){e.onSelectItem.apply(e,arguments)},this.selectAllCommand=function(){e.set_selectAll(!0)},this.clearSelectionCommand=function(){e.set_selectedIndex(-1)}}}})}(u.AtomItemsControl.prototype),function(e){return i({name:"WebAtoms.AtomAutoCompleteBox",base:e,start:function(t){a(t).addClass("atom-auto-complete-box"),this._presenters=["itemsPresenter","inputBox","selectionBox"],this._mouseCapture=0},properties:{isPopupOpen:!1,autoOpen:!1,selectedText:"",placeholder:void 0,keyPressed:void 0,displayLabel:void 0},methods:{get_offsetLeft:function(){return a(this._element).offset().left},get_offsetTop:function(){return a(this._element).offset().top},get_offsetWidth:function(){return a(this._inputBox).offset().width},set_itemsUrl:function(t){var e="[ !$owner.keyPressed ? undefined : AtomPromise.json('"+t+"').showProgress(false) ]";this.setValue("items",e,!0,this._element)},set_isPopupOpen:function(e){if(this._isPopupOpen=e,e){E.refreshValue(this,"offsetTop"),E.refreshValue(this,"offsetLeft"),E.refreshValue(this,"offsetWidth");var n=this;this.trySelect(),this.bindEvent(t,"click",function(){n.onWindowClick.apply(n,arguments)})}else this.unbindEvent(t,"click")},onSelectedItemsChanged:function(){this._onUIChanged&&this._selectedItems.length>0&&this.refreshLabel(),e.onSelectedItemsChanged.apply(this,arguments)},onClick:function(){e.onClick.apply(this,arguments),this._backupValue=this.get_value(),this.refreshLabel(),this._backupLabel=this.get_displayLabel(),E.setValue(this,"keyPressed",!1),E.setValue(this,"isPopupOpen",!1)},restoreSelection:function(){E.setValue(this,"isPopupOpen",!1),this._backupValue?(E.setValue(this,"value",this._backupValue),E.setValue(this,"displayLabel",this._backupLabel),this._backupValue=null):E.setValue(this,"selectedIndex",-1)},onKeyUp:function(t){switch(E.setValue(this,"isPopupOpen",!0),t.keyCode){case 27:return E.setValue(this,"keyPressed",!1),void this.restoreSelection();case 13:return E.setValue(this,"keyPressed",!1),E.setValue(this,"isPopupOpen",!1),this._backupValue=this.get_value(),this.refreshLabel(),this._backupLabel=this.get_displayLabel(),y.cancelEvent(t);case 37:break;case 38:return E.setValue(this,"keyPressed",!1),void this.moveSelection(!0);case 39:break;case 40:return E.setValue(this,"keyPressed",!1),void this.moveSelection(!1);default:var e=this;this.dispatcher.callLater(function(){e.trySelect()})}this.oldTimeout&&clearTimeout(this.oldTimeout);var n=this;this.oldTimeout=setTimeout(function(){E.setValue(n,"keyPressed",!0)},500)},trySelect:function(){if(this._items&&0!=this._items.length){var t=new f(this._items),e=this._labelPath,n=this._displayLabel;for(n&&(n=n.toLowerCase());t.next();){var i=t.current(),o=i;if(e&&(o=o[e]),0==o.toLowerCase().indexOf(n))return E.setValue(this,"selectedItem",i),E.setValue(this,"selectedText",o),void this.bringSelectionIntoView()}}},moveSelection:function(t){if(this._items&&this._items.length){var e=this.get_selectedIndex();-1==e&&(this.backupLabel=this.get_displayLabel()),e=t?e-1:e+1,t&&-2==e&&(e=this._items.length-1),t||e!=this._items.length||(e=-1),E.setValue(this,"selectedIndex",e),-1==e?E.setValue(this,"displayLabel",this.backupLabel||""):this.refreshLabel()}},refreshLabel:function(){var t=this.get_selectedItem(),e=t;e&&this._labelPath&&(e=e[this._labelPath]),E.setValue(this,"displayLabel",e||"")},onWindowClick:function(t){for(var e=this._element,n=this._itemsPresenter,i=t.target;null!=i.parentNode&&i!=e&&i!=n;)i=i.parentNode;i!=e&&i!=n&&this.restoreSelection()},onInputFocus:function(){this._autoOpen&&(this._backupValue=this.get_value(),this._backupLabel=this.get_displayLabel(),E.setValue(this,"isPopupOpen",!0),a(this._inputBox).select())
},onInputBlur:function(){if(!this._mouseCapture){var t=this;setTimeout(function(){t._isPopupOpen&&(E.setValue(t,"isPopupOpen",!1),t.restoreSelection())},10)}},onCreated:function(){this._itemsPresenter._logicalParent=this._element,a(this._itemsPresenter).remove(),r.body.appendChild(this._itemsPresenter),a(this._itemsPresenter).addClass("auto-complete-popup"),e.onCreated.apply(this,arguments),this.bindEvent(this._itemsPresenter,"mouseover","onMouseOver"),this.bindEvent(this._itemsPresenter,"mouseout","onMouseOut")},onMouseOver:function(){this._mouseCapture++},onMouseOut:function(){var t=this;setTimeout(function(){t._mouseCapture--},1e3)},init:function(){e.init.apply(this,arguments),this.bindEvent(this._inputBox,"focus","onInputFocus"),this.bindEvent(this._inputBox,"blur","onInputBlur"),this.bindEvent(this._inputBox,"keyup","onKeyUp")},dispose:function(){this._itemsPresenter&&(this.disposeChildren(this._itemsPresenter),a(this._itemsPresenter).remove(),this._itemsPresenter=null),e.dispose.call(this)}}})}(u.AtomListBox.prototype),function(t){return i({name:"WebAtoms.AtomComboBox",base:t,start:function(){this._labelPath="label",this._valuePath="value",this._allowSelectFirst=!0},methods:{invokePost:function(){this.get_selectedIndex()>0&&t.invokePost.apply(this,arguments)},invokeNext:function(){t.invokeNext.apply(this,arguments),this._postUrl&&(E.setValue(this,"selectedIndex",0),this.updateChildSelections())},onSelectionChanged:function(){this._onUIChanged=!0;var t=this.get_element();this.set_selectedIndex(t.selectedIndex),this._onUIChanged=!1},updateChildSelections:function(){var t=this._element;t.selectedIndex=this.get_selectedIndex()},onCollectionChanged:function(){var t=this.get_element(),e=this.get_dataItems();t.options.length=e.length;for(var n=new f(e),i=this._labelPath,o=this._valuePath,a=null,r=null,s=this.get_value();n.next();){var l=n.current();a=l,r=l,i&&(a=a[i]),o&&(r=r[o]),t.options[n.currentIndex()]=new Option(a,r,!1,r==s)}},verifyTemplates:function(){},init:function(){var e=this.get_element();this.bindEvent(e,"change","onSelectionChanged"),t.init.apply(this,arguments)}}})}(u.AtomItemsControl.prototype),function(t){return i({name:"WebAtoms.AtomDateListBox",base:t,start:function(){this._monthList=_.monthList;var t=new Date;this._month=t.getMonth()+1,this._year=t.getFullYear(),this._selectedItems=[],this._presenters=["itemsPresenter"],this._startYear=-5,this._endYear=10,this._currentYear=(new Date).getFullYear(),this._value=null},properties:{month:0,year:0,selectedItems:[],startYear:-5,endYear:0,currentYear:0,monthList:null,items:void 0,month:null,visibleDate:void 0},methods:{set_month:function(t){this._month=t,this.updateList()},set_year:function(t){this._year=t,this.updateList()},set_visibleDate:function(t){t&&(this._visibleDate=t,this._year=t.getFullYear(),this._month=t.getMonth()+1,this.updateList(),E.refreshValue(this,"year"),E.refreshValue(this,"month"))},init:function(){t.init.apply(this);var e=this;this.toggleDateCommand=function(){e.toggleDate.apply(e,arguments)}},onLoaded:function(){var t=this.getTemplate("itemTemplate"),e=this.get_scope(),n=this._itemsPresenter,i=this.getTemplate("itemTemplate");if(i&&(i=y.getAtomType(i),i||(i=u.AtomControl)),this.updateList(),t)for(var o=this._items,r=0;42>r;r++){var s=y.cloneNode(t);s._templateParent=this;var l=new S(this,e,atomApplication);l.itemIndex=r,a(n).append(s);{y.createControl(s,i,o[r],l)}}},toggleDate:function(t,e){var n=e.get_data(),i=a.inArray(n.value,a.map(this._selectedItems,function(t){return t.value}));i>-1?E.removeAtIndex(this._selectedItems,i):E.addItem(this._selectedItems,n),E.refreshValue(this,"value"),E.refreshValue(this,"selectedItems"),this.invokeAction(this._next)},getItemClass:function(t){var e=a.inArray(t.value,a.map(this._selectedItems,function(t){return t.value}))>-1,n=t.date.getDay(),i=0==n||6==n,o="atom-date-list-box-day-list-item ";return o+=i?"atom-date-list-box-weekend ":"",o+=e?"atom-date-list-box-selected ":"atom-date-list-box-item ",o+=this._month==t.date.getMonth()+1?"":"atom-date-list-box-day-list-item-other"},set_value:function(t){if(void 0!==t){if(this._selectedItems.length=0,null!==t)for(var e=t.split(","),n=0;n<e.length;n++){var i=e[n];if(i){var o=i.split("/"),a=new Date(parseInt(o[2],10),parseInt(o[0],10)-1,parseInt(o[1],10));this._selectedItems.push({date:a,dateLabel:_.toShortDateString(a),value:i,label:a.getDate()})}}this._created&&(E.refreshItems(this._selectedItems),E.refreshValue(this,"value"),E.refreshValue(this,"selectedItems"))}},get_value:function(){return a.map(this._selectedItems,function(t){return t.value}).join(",")},updateList:function(){if(this._month&&this._year){var t=new Date,e=(new Date(this._year,this._month-1,1),new Date(this._year,this._month-1,1));if(e.getDay()){var n=e.getDay()-1;n=-n,e.setDate(n)}var i=e.getMonth(),o=e.getFullYear(),a=[],r=0,s=this._month-1;for(r=0;42>r;r++){var l=r+e.getDate(),u=new Date(o,i,l),h=u.getDay();h=0==h||6==h,a.push({label:u.getDate(),isWeekEnd:h,isToday:t.getDate()==u.getDate()&&t.getMonth()==u.getMonth()&&t.getFullYear()==u.getFullYear(),isOtherMonth:u.getMonth()!=s,dateLabel:_.toShortDateString(u),value:_.toMMDDYY(u),date:u})}this._items=a,E.refreshValue(this,"items"),E.refreshValue(this,"selectedItems"),this._created&&E.refreshValue(this,"value")}}}})}(u.AtomControl.prototype),function(e){var n=t.AtomUI;return i({name:"WebAtoms.AtomDockPanel",base:e,start:function(t){a(t).addClass("atom-dock-panel")},properties:{resizeOnChildResized:!1,contentWidth:0},methods:{resizeChild:function(t){t.atomControl?t.atomControl.updateUI():this.updateChildUI(t)},calculateSize:function(){var t=this.get_element(),e=a(t),i={width:e.width(),height:e.height()};if(!this._resizeOnChildResized)return i;for(var o=0,r=new w(t);r.next();){var s=r.current(),l=n.attr(s,"atom-dock");switch(l){case"Bottom":case"Fill":case"Top":var u;u=p.isIE&&p.majorVersion<10?s.offsetHeight:a(s).outerHeight(!0),o+=u}}return i.height<o&&(i.height=o,e.height(i.height)),i},onUpdateUI:function(){var t=this.get_element(),e=(a(t),0),i=parseInt(a(t).css("paddingTop"),10),o=this.calculateSize(),r=o.height,s=o.width;this._contentWidth&&(e=(s-this._contentWidth)/2,s=this._contentWidth);var l,u,h,m,d={top:[],bottom:[],left:[],right:[],fill:[]};isScriptOrStyle=/script|style/i;for(var c=new w(t);c.next();){var p=c.current();if(!isScriptOrStyle.test(p.tagName)){var v=a(p);v.is(".dock-left,[dock$='Left']")?d.left.push(p):v.is(".dock-right,[dock$='Right']")?d.right.push(p):v.is("header,.dock-top,[dock$='Top']")?d.top.push(p):v.is("footer,.dock-bottom,[dock$='Bottom']")?d.bottom.push(p):v.is("section,.dock-fill,[dock$='Fill']")&&d.fill.push(p)}}for(l=new f(d.top);l.next();)u=l.current(),h=a(u).outerHeight(!0),n.setItemRect(u,{top:i,left:e,width:s}),i+=h,r-=h,this.resizeChild(u);for(l=new f(d.bottom.reverse());l.next();)u=l.current(),h=a(u).outerHeight(!0),r-=h,n.setItemRect(u,{left:e,top:i+r,width:s}),this.resizeChild(u);for(l=new f(d.left);l.next();){u=l.current();var m=a(u).outerWidth(!0);s-=m,n.setItemRect(u,{top:i,left:e,height:r}),e+=m,this.resizeChild(u)}for(l=new f(d.right.reverse());l.next();){u=l.current();var m=a(u).outerWidth(!0);s-=m,n.setItemRect(u,{left:s+e,top:i,height:r}),this.resizeChild(u)}for(l=new f(d.fill);l.next();)u=l.current(),m=a(u).css("max-width"),m&&(m=parseFloat(m),m>0&&(s=m)),n.setItemRect(u,{left:e,top:i,width:s,height:r}),this.resizeChild(u)}}})}(u.AtomControl.prototype),function(t){return i({name:"WebAtoms.AtomPostButton",base:t,start:function(){},properties:{postData:null,postResult:null,postUrl:null,next:null,confirm:!1,confirmMessage:null,mergeData:null},methods:{get_postData:function(){return this._postData||this.get_data()},onClickHandler:function(t){if(this._confirm){var e=this;return void g.confirm(this._confirmMessage,function(){e.onConfirmed(t)})}this.onConfirmed(t)},onConfirmed:function(){if(!this._postUrl)return void t.onClickHandler.apply(this,arguments);var e=this.get_postData();if(null!==e&&void 0!==e){var n=this._mergeData;if(n)for(var i in n)e[i]=n[i];var o=this,a=function(t){E.setValue(o,"postResult",t.value()),o.invokeAction(o._next)};B.json(this._postUrl,null,{type:"POST",data:e}).then(a).invoke()}}}})}(u.AtomButton.prototype),function(t){return i({name:"WebAtoms.AtomToggleButtonBar",base:t,start:function(){this._allowSelectFirst=!0,this._allowMultipleSelection=!1,this._showTabs=!1,this._autoScrollToSelection=!1},properties:{showTabs:!1},methods:{setClass:function(){var t=a(this._element);t.removeClass("atom-tab-bar atom-toggle-button-bar"),t.addClass(this._showTabs?"atom-tab-bar":"atom-toggle-button-bar")},set_showTabs:function(t){this._showTabs=t,this.setClass()}}})}(u.AtomListBox.prototype),function(t){return i({name:"WebAtoms.AtomViewStack",base:t,start:function(){this._swipeDirection="left-right"},properties:{selectedIndex:-1,previousIndex:-1,swipeDirection:"left-right"},methods:{bringSelectionIntoView:function(){},set_swipeDirection:function(t){var e=this._swipeDirection;e&&a(this._element).removeClass(e),this._swipeDirection=t,t&&a(this._element).addClass(t)},set_selectedIndex:function(t){if(this._isAnimating){var e=this;return void setTimeout(function(){e.set_selectedIndex(t)},50)}t!=this._selectedIndex&&(this._previousIndex=this._selectedIndex,this._selectedIndex=t,this.updateUI())},get_selectedChild:function(){return this._selectedChild},onUpdateUI:function(){var t=this._element,e=new w(t),n=this.get_selectedIndex(),i=this._previousIndex,o=u.dispatcher;o.pause();for(var r,s,l=-1,h=this;e.next();){l+=1;var m=e.current(),d=a(m);d.addClass("view-stack-child"),-1==i&&d.addClass("hidden"),l==n?r=m:l==i?s=m:d.addClass("hidden")}if(r){var c=a(t).innerWidth(),p=a(t).innerHeight();this._selectedChild=r,y.setItemRect(r,{width:c,height:p});var f=r.atomControl;if(f&&f.updateUI(),s&&s!=r){var h=this,v=this._swipeDirection;if(null!=v&&/none/i.test(v))a(s).addClass("hidden"),a(r).removeClass("hidden");else{var g=[r,s];a(g).removeClass("hidden"),this._isAnimating=!0,i>n?a(r).css("left",-c):a(r).css("left",c),a(g).addClass("animate-left-property"),setTimeout(function(){a(r).css("left",0),i>n?a(s).css("left",c):a(s).css("left",-c),setTimeout(function(){h._isAnimating=!1,a(g).removeClass("animate-left-property"),a(s).addClass("hidden")},800)},50)}}else a(r).removeClass("hidden")}o.start()},init:function(){var e=this.get_element();a(e).addClass("atom-view-stack"),t.init.call(this);var e=this.get_element();e.parentNode.atomControl||a(e).addClass("atom-view-stack-fill"),a(e).addClass(this._swipeDirection)}}})}(u.AtomControl.prototype),function(t){return i({name:"WebAtoms.AtomForm",base:t,start:function(){this._success=null,this._submit=null,this._errors=null,this._attachments=null},properties:{result:null,mergeData:null,mergeResult:!0,postUrl:null,postData:null,successMessage:null,clearData:!1,errorTemplate:null},methods:{createFormLayout:function(){},preparePostData:function(){var t=(this.get_element(),this._postData||this.get_data()),e=this._mergeData;if(e)for(var n in e)t[n]=e[n];return t},onSubmit:function(){var t=getInputErrors(this._element);if(t.length)return void this.invokeAction({localWindow:{path:this.getTemplate("errorTemplate"),prop:{data:t,title:"Form Errors"}}});var e=this.preparePostData(),n=B.getUrl(this._postUrl);B.json(n,{_tv:g.time()},{type:"POST",data:e}).then(this._success).invoke()},onSuccess:function(t){var e=t.value();if(E.setValue(this,"result",e),this._mergeResult){var n=this.get_data();for(var i in e)E.setValue(n,i,e[i])}if(this._clearData){var n=this.get_data();for(var i in this._clearData)E.setValue(n,i,e[i])}this._successMessage&&g.alert(this._successMessage),this.invokeAction(this._next)},onKeyUp:function(t){if(!(t.target&&t.target.nodeName&&/textarea/gi.test(t.target.nodeName))&&13==t.keyCode){var e=this;/input/gi.test(t.target.nodeName)&&a(t.target).change(),u.dispatcher.callLater(function(){e.onSubmit()})}},isValid:function(){for(var t=this.get_element(),e=new w(t),n=!0;e.next();){var i=e.current();this.validate(i)||(n=!1)}return n},validateField:function(t){var e=t.target;this.validate(e)},validate:function(t,e){e||(e=a(t).data("field-error"));var n=t.atomControl,i=null,o=!1;if(n){if(n.constructor==u.AtomFormField)return n.validate();i=E.getValue(n,"value")}else/input|select|textarea/i.test(t.nodeName)?i=a(t).val():o=!0;if(!o){var r=y.attr(t,"atom-required");if(r&&!i)return D.text(e,"Required"),a(t).addClass("atom-data-error"),!1;var s=y.attr(t,"atom-regex");if(s)s=eval("("+s+")");else{var l=y.attr(t,"atom-data-type");if(l)switch(l){case"email":s=/^(([^<>()\[\]\\.,;:\s@\"]+(\.[^<>()\[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/}}if(s&&!s.test(i))return a(e).text("Invalid"),a(t).addClass("atom-data-error"),!1;a(e).text(""),a(t).removeClass("atom-data-error")}for(var h=new w(t),m=!0;h.next();)this.validate(h.current(),e)||(m=!1);return m},init:function(){t.init.call(this);var e=this;this._success=function(){e.onSuccess.apply(e,arguments)},this._submit=function(){u.dispatcher.callLater(function(){e.onSubmit.apply(e,arguments)})};var n=this.get_element();this.submitCommand=this._submit,this.bindEvent(n,"keyup","onKeyUp"),a(n).find("input[type=submit]").bind("click",null,this._submit),a(n).find("button[type=submit]").bind("click",null,this._submit);var e=this;this._vh=function(){e.validateField.apply(e,arguments)},a(n).find("input,select,textarea").bind("blur",null,this._vh)}}})}(u.AtomControl.prototype),function(t){return i({name:"WebAtoms.AtomFormLayout",base:t,start:function(){this._useTable=!0,this._errorItems=[],this._minLabelWidth=0},properties:{minLabelWidth:0},methods:{createField:function(t,e){var n=!1,i=y.attributeMap(e,/^(atom\-(init|type|label|required|regex|data\-type|is\-valid|field\-(value|visible|class)|error))$/i),o=i["atom-type"];if(o)switch(i["atom-type"]=null,o.value){case"AtomFormField":n=!0;break;case"AtomFormGridLayout":case"AtomFormTab":t.appendChild(e);var a=y.createControl(e,o.value);return a}var r=y.cloneNode(this._fieldTemplate),s=y.findPresenter(r);if(s){if(n)for(var l=new w(e);l.next();)s.appendChild(l.current());else s.appendChild(e);y.removeAttr(s,"atom-presenter")}else r.contentElement=e;t.appendChild(r);for(var h in i){var m=i[h];m&&(e.removeAttributeNode(m.node),r.setAttributeNode(m.node))}if(i=y.attributeMap(r,/^atom\-(field\-value|is\-valid)$/i),!i["atom-field-value"]&&!i["atom-is-valid"]){var m=y.attr(e,"atom-value");if(m&&/^\$\[/gi.test(m)){m=m.substr(2),/^\$/gi.test(m)||(m="$"+m),m="["+m;var d=m.indexOf("]");m=m.substr(0,d+1),y.attr(r,"atom-field-value",m)}}return y.createControl(r,u.AtomFieldType)},createChildren:function(){var t=this._element;a(t).addClass("atom-form");var e=new f(a(t).children()),n=r.createElement("TABLE");a(n).addClass("atom-form-table");var i=r.createElement("TBODY");y.removeAllChildren(t),t.appendChild(n),n.appendChild(i);var o;for(this.getTemplate("fieldTemplate");e.next();)o=e.current(),o&&this.createField(i,o)}}})}(u.AtomControl.prototype),function(){return i({name:"WebAtoms.AtomLayout",start:function(){},methods:{doLayout:function(){}}})}(),function(t){return i({name:"WebAtoms.AtomWindow",base:t,start:function(){this._presenters=["windowDiv","windowTitleDiv","windowCloseButton","iframe","windowPlaceholder"]},properties:{opener:null,openerData:null,windowTemplate:null,isOpen:!1,windowHeight:300,windowWidth:500,url:void 0,title:void 0,windowUrl:void 0,cancelNext:void 0},methods:{get_openerData:function(){var t=this.get_opener();if(t)return t.get_data()},onCloseCommand:function(){E.setValue(this,"isOpen",!1);var t=this._value,e=this;this._value=null,u.dispatcher.callLater(function(){E.setValue(e,"value",t),e.invokeAction(e._next),e.disposeChildren(e._element)})},onCancelCommand:function(){E.setValue(this,"isOpen",!1);var t=this;u.dispatcher.callLater(function(){t.invokeAction(t._cancelNext),t.disposeChildren(t._element)})},refresh:function(t,e){this.openWindow(t,e)},openWindow:function(t,e){var n=this.getTemplate("frameTemplate");n=y.cloneNode(n);var i=a(n),o=i.find("[data-atom-presenter=windowDiv],[atom-presenter=windowDiv]").get(0),r=(i.find("[data-atom-presenter=windowTitleDiv],[atom-presenter=windowTitleDiv]").get(0),this.getTemplate("windowTemplate"));if(a(r).addClass("atom-window-template"),y.attr(r,"atom-dock")||y.attr(r,"atom-dock","Fill"),r.length)for(var s=0;s<r.length;s++)o.appendChild(r[s]);else o.appendChild(r);var l=this.getTemplate("commandTemplate");l&&(y.attr(l,"atom-dock","Bottom"),l.setAttribute("class","atom-wizard-command-bar"),o.appendChild(l)),this.set_innerTemplate(n),this._iframe&&(this._iframe.atomWindow=this),e&&(this._opener=e,E.refreshValue(this,"opener"),E.refreshValue(this,"openerData"));var h=this;u.dispatcher.callLater(function(){if(E.setValue(h,"isOpen",!0),!h._url){var t=a(h._windowPlaceholder).find("input");if(t.length>0){var e=t.get(0);try{e.focus()}catch(n){}}}})},init:function(){a(this._element).addClass("atom-window-placeholder"),t.init.call(this);var e=this;this.closeCommand=function(){e.onCloseCommand.apply(e,arguments)},this.cancelCommand=function(){e.onCancelCommand.apply(e,arguments)},this.openCommand=function(){e.openWindow.apply(e,arguments)},u.dispatcher.callLater(function(){var t=e._element;t._logicalParent||(t._logicalParent=t.parentNode,a(t).remove(),r.body.appendChild(t))})}}})}(u.AtomControl.prototype),u.AtomWindow.openNewWindow=function(t){{var e=r.createElement("DIV");y.assignID(e)}t.localScope&&e.setAttribute("data-atom-local-scope","true"),e._logicalParent=t.opener,r.body.appendChild(e);var n=y.createControl(e,u.AtomWindow),i=t.url;void 0!==i.length?(t.next=i[1],t.url=i[0],i=new AtomUri(t.url)):(i={path:i.path,query:i.prop,hash:i.scope},t.url.next&&(t.next=t.url.next)),n._next=[t.next||{},function(){u.dispatcher.callLater(function(){n.dispose(),a(e).remove()})}];var o=i.path;y.isNode(o)||(o=g.get(t.scope,i.path));var s=a(y.cloneNode(o)),l=s.children("[atom-template=commandTemplate],[data-atom-template=commandTemplate]").get(0);l&&(y.removeAttr(l,"atom-template"),n._commandTemplate=l,a(l).remove()),l=s.children("[atom-template=windowTemplate],[data-atom-template=windowTemplate]").get(0),l?(y.removeAttr(l,"atom-template"),n._windowTemplate=l):(y.removeAttr(o,"atom-template"),n._windowTemplate=o),n.init(),u.dispatcher.callLater(function(){var e=n.get_scope(),o=i.hash;for(var a in o)o.hasOwnProperty(a)&&g.set(e,a,o[a]);var r=i.query;for(var a in r)r.hasOwnProperty(a)&&g.set(n,a,r[a]);n.openWindow(t.scope,t.opener)})},function(t){return i({name:"WebAtoms.AtomCalendar",base:t,start:function(t){a(t).addClass("atom-calendar");var e=new Date;this._month=e.getMonth()+1,this._year=e.getFullYear(),this._startYear=-5,this._endYear=10,this._currentYear=(new Date).getFullYear(),this._value=null},properties:{month:0,year:0,startYear:-5,endYear:0,currentYear:0,visibleDate:void 0},methods:{set_month:function(t){this._month=t,this.updateCalendar()},set_year:function(t){this._year=t,this.updateCalendar()},set_visibleDate:function(t){t&&t!=this._visibleDate&&(this._visibleDate=t,this._year=t.getFullYear(),this._month=t.getMonth()+1,this.updateCalendar(),E.refreshValue(this,"year"),E.refreshValue(this,"month"))},onCreated:function(){t.onCreated.call(this);var e=this;u.dispatcher.callLater(function(){e.updateCalendar()})},applyItemStyle:function(){},updateCalendar:function(){if(this._created){var t=new Date,e=(new Date(this._year,this._month-1,1),new Date(this._year,this._month-1,1));if(e.getDay()){var n=e.getDay()-1;n=-n,e.setDate(n)}var i=e.getMonth(),o=e.getFullYear(),a=[],r=0,s=this._month-1;for(r=0;42>r;r++){var l=r+e.getDate(),u=new Date(o,i,l),h=u.getDay();h=0==h||6==h,a.push({label:u.getDate(),isWeekEnd:h,isToday:t.getDate()==u.getDate()&&t.getMonth()==u.getMonth()&&t.getFullYear()==u.getFullYear(),isOtherMonth:u.getMonth()!=s,dateLabel:_.toShortDateString(u),value:_.toMMDDYY(u),date:u})}E.setValue(this,"items",a)}},changeMonth:function(t){var e=this._month;e+=t,e>12&&(e=1,g.set(this,"year",this._year+1)),0==e&&(g.set(this,"year",this._year-1),e=12),E.setValue(this,"month",e)},init:function(){t.init.call(this);var e=this;this.nextMonthCommand=function(){e.changeMonth(1)},this.prevMonthCommand=function(){e.changeMonth(-1)}}}})}(u.AtomListBox.prototype),function(t){return i({name:"WebAtoms.AtomCheckBoxList",base:t,start:function(){this._allowMultipleSelection=!0,this._valueSeparator=", ",this._dataElements=[]},methods:{init:function(){t.init.call(this),a(this._element).addClass("atom-check-box-list")}}})}(u.AtomItemsControl.prototype),function(t){return i({name:"WebAtoms.AtomDataPager",base:t,properties:{itemsPath:"items",totalPath:"total",pageSize:25,currentPage:0,items:null,total:0,pages:[]},start:function(){this._presenters=["pageList"];var t=this,e=E;this.goFirstCommand=function(){e.setValue(t,"currentPage",0)},this.goLastCommand=function(){e.setValue(t,"currentPage",t._pages.length-1)},this.goNextCommand=function(){e.setValue(t,"currentPage",t.get_currentPage()+1)},this.goPrevCommand=function(){e.setValue(t,"currentPage",t.get_currentPage()-1)}},methods:{preparePages:function(){if(this._items&&this._total&&this._pageSize){var t=(this._items.length,this._total),e=Math.ceil(t/this._pageSize);if(e!=this._pages.length){var n,i=(this._pageSize,[]);for(n=0;e>n;n++)i.push({value:n,label:n+1});E.setValue(this,"pages",i)}}},set_items:function(t){t!=this._items&&this._items&&this.unbindEvent(this._items,"CollectionChanged","onCollectionChangedInternal"),t&&(this._items=t,null!=t&&this._created&&(this.bindEvent(this._items,"CollectionChanged","onCollectionChangedInternal"),this.onCollectionChangedInternal("refresh",-1,null)))},onCollectionChangedInternal:function(){var t=this._items;if(void 0===t.length){var e=t[this._itemsPath];E.setValue(this,"total",t[this._totalPath]),E.setValue(this,"value",e)}else t.total&&E.setValue(this,"total",t.total),E.setValue(this,"value",t);this.preparePages()},onCreated:function(){this._items&&(this.bindEvent(this._items,"CollectionChanged","onCollectionChangedInternal"),this.onCollectionChangedInternal("refresh",-1,null))},set_currentPage:function(t){this._currentPage=t,E.refreshValue(this,"pageStart")},get_pageStart:function(){return this._currentPage*this._pageSize},set_pageSize:function(t){this._pageSize=t,this.preparePages()},set_total:function(t){this._total!=t&&(this._total=t)},init:function(){a(this._element).addClass("atom-data-pager"),t.init.apply(this,arguments)}}})}(u.AtomControl.prototype),function(t){return i({name:"WebAtoms.AtomDateControl",base:t,start:function(){},properties:{startYear:-1,endYear:10},methods:{resetYears:function(){var t=this._year,e=new Date,n=e.getFullYear();n+=this._startYear;var i=e.getFullYear()+this._endYear,o=this._value;o||(o=e),t.options.length=0;var a=1;t.options[0]=new Option("Select","",!1,!1);for(var e=(this._value||new Date).getFullYear(),r=n;i>=r;r++)t.options[a]=new Option(r,r,!1,e==r),a++},set_value:function(t){t&&t.constructor==String&&(t=new Date(parseInt(t.substr(6)))),this._value=t,this.setDate()},setDate:function(){if(this._value){var t=this._value,e=t.getMonth()+1,n=t.getDate(),i=t.getFullYear();this.setComboValue(this._month,e),this.setComboValue(this._year,i),this.setComboValue(this._date,n)}},setComboValue:function(t,e){for(var n=new f(t.options);n.next();)if(n.current().value==e){t.selectedIndex=n.currentIndex();break}},set_startYear:function(t){this._startYear=t,this.resetYears()},set_endYear:function(t){this._endYear=t,this.resetYears()},onDataChange:function(){var t=a(this._year).val(),e=a(this._month).val(),n=a(this._date).val();try{if(t&&e&&n){var i=new Date(t,e-1,n,9,0,0);this._value=i}else this._value=null}catch(o){g.alert(o)}E.refreshValue(this,"value")},setMonths:function(){var t=_.monthList,e=this._month.options;e.length=0;var n=new f(t);for(e[0]=new Option("Select","",!1,!1);n.next();){var i=n.current();e[n.currentIndex()+1]=new Option(i.label,i.value,!1,!1)}this.setDate(),E.refreshValue(this,"value")},init:function(){var e=this._element;this._date=r.createElement("SELECT"),this._month=r.createElement("SELECT"),this._year=r.createElement("SELECT"),e.style.height="25px",e.appendChild(this._date),e.appendChild(this._month),e.appendChild(this._year);var n,i=this._date.options;for(i[0]=new Option("Select","",!1,!1),n=1;32>n;n++)i[n]=new Option(n,n,!1,!1);this.resetYears(),this.bindEvent(this._date,"change","onDataChange"),this.bindEvent(this._month,"change","onDataChange"),this.bindEvent(this._year,"change","onDataChange"),this.setMonths(),t.init.apply(this,arguments)}}})}(u.AtomControl.prototype),function(t){return i({name:"WebAtoms.AtomDateField",base:t,start:function(t){this._presenters=["calendarPresenter","itemsPresenter"],a(t).addClass("atom-date-field")},properties:{isOpen:!1,time:"9:00 AM"},methods:{get_offsetLeft:function(){return a(this._element).offset().left},get_offsetTop:function(){return a(this._element).offset().top},onPopupRemoved:function(){E.setValue(this,"isOpen",!1)},set_isOpen:function(t){if(this._isOpen=t,t){this.getTemplate("popupTemplate"),this.popup=y.cloneNode(this._popupTemplate),this.popup._logicalParent=this._element,this.popup._templateParent=this,r.body.appendChild(this.popup),this.onCreateChildren(this.popup),this.setProperties(this.popup),this.initChildren(this.popup);var e=this;this._refreshInterval=setInterval(function(){E.refreshValue(e,"offsetLeft"),E.refreshValue(e,"offsetTop")}),x.show(this._element,this.popup,-1,function(){g.set(e,"isOpen",!1)})}else this._refreshInterval&&clearInterval(this._refreshInterval),this.popup&&(this.disposeChildren(this.popup),a(this.popup).remove(),this.popup=null)},dispose:function(){this.set_isOpen(!1),t.dispose.call(this)},get_isOpen:function(){return this._isOpen},get_selectedItem:function(){return this._selectedItems.length?this._selectedItems[0]:null},set_time:function(t){if(!this._set_timeCalled){if(this._set_timeCalled=!0,t){this._time=t;var e=_.setTime(this.get_value(),t);E.setValue(this,"value",e)}this._set_timeCalled=!1}},set_value:function(t){t=_.parse(t),this._value=t,E.setValue(this,"time",_.toTimeString(t)),this._selectedItems.length=0,t&&(this._selectedItems.push({date:t,dateLabel:_.toShortDateString(t),value:_.toMMDDYY(t),label:t.getDate()}),this.set_visibleDate(t)),this._created&&(E.refreshItems(this._selectedItems),E.refreshValue(this,"value"),E.refreshValue(this,"selectedItem"),E.refreshValue(this,"selectedItems"))},get_value:function(){return this._selectedItems.length?this._selectedItems[0].date:this._value},toggleDate:function(t,e){var n=e.get_data();this._selectedItems.length=0,E.addItem(this._selectedItems,n),E.refreshValue(this,"value"),E.refreshValue(this,"selectedItem"),E.refreshValue(this,"selectedItems"),E.setValue(this,"isOpen",!1)}}})}(u.AtomDateListBox.prototype),function(t){return i({name:"WebAtoms.AtomDeleteButton",base:t,start:function(){this._confirm=!0,this._confirmMessage="Are you sure you want to delete this item?"},methods:{},properties:{}})}(u.AtomPostButton.prototype),function(t){return createClass({name:"WebAtoms.AtomFrameView",base:t,start:function(t){var e=this;a(t).addClass("atom-frame-view"),this._items=[],this._layout=u.AtomViewBoxLayout.defaultInstance,this.backCommand=function(){e.onBackCommand.apply(e,arguments)}},properties:{url:"",replaceUrl:"",layout:null,items:[],removeOnBack:!0},methods:{set_replaceUrl:function(t){var e=new f(this._items);for(this.set_url(t);e.next();){var n=e.current();n.url!=t&&this.replaceItemWithUrl(n)}},set_url:function(t){if(t){if(/replace\:/.test(t))return this.set_replaceUrl(t.substr(8)),void(this._url=t);var e=t.indexOf("?"),n=t,i="",o=this;-1!==e&&(n=t.substr(0,e),i=t.substr(e+1));var a=this._items,r=g.query(a).firstOrDefault({url:n});if(r)g.set(this,"selectedIndex",r.index),this.updateUI();else{var s=g.get(this,"scope"),l=s[n];if(!l)return void(console&&console.error&&console.error("Page Template "+l+" not found"));l=y.cloneNode(l),l._logicalParent=this._element,r={url:n,index:a.length,opener:this._url,element:l},g.add(a,r);var h=y.createControl(l,y.getAtomType(l)||u.AtomControl);r.control=h,u.dispatcher.callLater(function(){h.init(),o._element.appendChild(l),g.set(o,"selectedIndex",r.index),o.updateUI()})}i&&this.invokeAction({appScope:y.parseUrl(i)}),this._url=t}},replaceItemWithUrl:function(t,e){if(e&&this.set_url(e),t){var n=this;setTimeout(function(){n.removeItem(t)},1e3)}},removeItem:function(t){g.remove(this._items,t),t.control.dispose(),a(t.element).remove();for(var e=new f(this._items);e.next();)t=e.current(),t.index=e.currentIndex()},onBackCommand:function(){var t=this._selectedIndex;if(t){var e=g.query(this._items).firstOrDefault({index:t});if(e){var n=this;t-=1,g.set(this,"selectedIndex",t),n._removeOnBack&&this.replaceItemWithUrl(e,e.opener)}}},init:function(){t.init.call(this);var e=this,n=this._url;n&&u.dispatcher.callLater(function(){e.set_url(n)})}}})}(u.AtomViewStack.prototype),function(t){return i({name:"WebAtoms.AtomLinkBar",base:t,start:function(){this._allowSelectFirst=!1;var t=this;this.openMenuCommand=function(){t.openMenu.apply(t,arguments)}},properties:{itemsPath:"items",selectCurrent:!0,targetPath:"",menuTemplate:null,menuDirection:"horizontal"},methods:{setClass:function(){var t=a(this._element);t.removeClass("atom-tab-bar atom-link-bar"),t.addClass(this._showTabs?"atom-tab-bar":"atom-link-bar")},set_menuDirection:function(t){var e=a(this._element);e.removeClass("vertical horizontal"),e.addClass(t),this._menuDirection=t},onClick:function(){},openMenu:function(t){var e=t.target,n=this.get_atomParent(e);if(null!=n){var i=n.get_data();if(i[this._itemsPath]){var o=this._subMenu;if(o)x.hide(o._element);else{var a=this.getTemplate("menuTemplate");o=y.cloneNode(a),o._templateParent=this,o.style.position="absolute",r.body.appendChild(o);var a=y.getAtomType(a)||u.AtomControl;o=y.createControl(o,a,i),this._subMenu=o}E.setValue(o,"data",i),x.show(n._element,o._element,0),y.cancelEvent(t)}}},selectDefault:function(){this._items&&this._selectCurrent&&(this._value||(E.setValue(this,"value",location.pathname),-1==this.get_selectedIndex()&&this.selectItem(this._items),this.updateSelectionBindings()))},selectItem:function(t,e){for(var n=new f(t),i=this._valuePath,o=location.pathname.toLowerCase();n.next();){var a=n.current(),r=a;if(i&&(r=r[i]),r){if(o==r.toLowerCase())return e||E.setValue(this,"selectedItem",a),!0;if(a.links&&this.selectItem(a.links,!0))return E.setValue(this,"selectedItem",a),!0}}return!1},dispose:function(){this._subMenu&&(this._subMenu.dispose(),this._subMenu=null),t.dispose.apply(this,arguments)},init:function(){t.init.apply(this,arguments),this.bindEvent(this._element,"click","openMenuCommand"),this.set_menuDirection("horizontal")}}})}(u.AtomToggleButtonBar.prototype),function(t){return i({name:"WebAtoms.AtomMultiButtonList",base:t,start:function(){this._dataElements=[]},properties:{labelPath:"label",valuePath:"value",options:null,isRadio:!1,items:null},methods:{set_options:function(t){this._options=t,t&&this.onCollectionChangedInternal("refresh",-1,null)},set_value:function(t){this._value=t,this.updateSelections()},set_items:function(t){this._items&&this.unbindEvent(this._items,"CollectionChanged","onCollectionChangedInternal"),this._items=t,null!=t&&(this.bindEvent(this._items,"CollectionChanged","onCollectionChangedInternal"),this.onCollectionChangedInternal("refresh",-1,null))},onCollectionChangedInternal:function(t,e,n){var i=this.get_value();this.onCollectionChanged(t,e,n),this.set_value(i)},onCollectionChanged:function(){if(this._items&&this._options){this._dataElements=[],this.unbindEvent(null,"change","onDataChange");for(var t=new f(this._items),e=this.get_scope();t.next();){var n=t.current();this.createChildElement(e,this._element,n)}this.updateUI()}},updateSelections:function(){if(this._dataElements&&0!=this._dataElements.length){for(n=new f(this._dataElements);n.next();){var t=n.current();t.checked=!1}if(this._value){var e,n,i,o=this._value.split(",");n.reset();
for(var r;n.next();)for(r=n.current(),e=new f(o);e.next();)i=e.current(),i=a.trim(i),r.value==i&&(r.checked=!0)}}},onDataChange:function(){for(var t=new f(this._dataElements),e=[];t.next();){var n=t.current(),i=a(n).val();n.checked&&e.push(i)}this._value=e.join(", "),E.refreshValue(this,"value")},createChildElement:function(t,e,n){var i=r.createElement("SPAN");e.appendChild(i),e=i,i=r.createElement("SPAN");var o=this.get_labelPath(),s=this.get_valuePath();l=n,v=n,o&&(l=n[o]),s&&(v=n[s]);var u=null;this._isRadio&&(u="_g"+y.getNewIndex()),e.appendChild(i);for(var h=new f(this._options);h.next();){var m=h.current();s&&(m=m[s]);var d=v+"."+m,c=r.createElement("INPUT");this._isRadio?(y.attr(c,"type","radio"),y.attr(c,"name",u)):y.attr(c,"type","checkbox"),a(c).val(d),i.appendChild(c),this.bindEvent(c,"change","onDataChange"),this._dataElements.push(c)}i=r.createElement("SPAN"),e.appendChild(i);var p=r.createTextNode(l);i.appendChild(p)}}})}(u.AtomControl.prototype),function(t){return i({name:"WebAtoms.AtomNavigatorList",base:t,start:function(){this._displayMode=0,this._presenters=["gridPanel","gridPresenter","itemsPresenter","detailHeaderPresenter","newHeaderPresenter","detailPresenter","newPresenter","newView","detailView","newHeaderToolbar","detailHeaderToolbar"],this._layout=new u.AtomViewBoxLayout,this._newItem={}},properties:{autoShowDetail:!0,currentPage:null,pageSize:void 0,newItem:null,newUrl:null,detailUrl:null,displayMode:null},methods:{get_newItemCopy:function(){return this._newItemCopy},onBackCommand:function(){E.setValue(this,"displayMode",0),this.updateDisplayMode(),E.setValue(this,"selectedIndex",-1)},onCancelAddNewCommand:function(){this.onBackCommand(),E.refreshValue(this,"newItemCopy"),this.refresh()},onAddCommand:function(){E.setValue(this,"selectedIndex",-1),E.setValue(this,"displayMode",2);var t=this._newItem||{};this._newItemCopy=E.getClone(t),E.refreshValue(this,"newItemCopy"),this.updateDisplayMode()},onSelectedItemsChanged:function(){t.onSelectedItemsChanged.apply(this,arguments),this._autoShowDetail&&this.showDetailCommand()},addTemplate:function(t,e,n){n?(t.appendChild(e),e._templateParent=this,this.onCreateChildren(t),this.initChildren(t)):(t.appendChild(e),e._templateParent=this,this.onCreateChildren(t))},updateDisplayMode:function(){var t=this._displayMode;if(0==t)return this._detailPresenter&&(this._detailView.atomControl.dispose(this._detailPresenter),this._detailPresenter=null),this._newPresenter&&(this._newView.atomControl.dispose(this._newPresenter),this._newPresenter=null),this._detailHeaderPresenter&&(this._detailView.atomControl.dispose(this._detailHeaderPresenter),this._detailHeaderPresenter=null),void(this._newHeaderPresenter&&(this._newView.atomControl.dispose(this._newHeaderPresenter),this._newHeaderPresenter=null));var e,n=null,i=this.getTemplate("detailTemplate"),o=null,a="";1==t?(n=this._detailView,o=this._detailHeaderToolbar,e=this.getTemplate("detailHeaderTemplate"),a="_detail"):(n=this._newView,o=this._newHeaderToolbar,e=this.getTemplate("newHeaderTemplate"),a="_new"),o&&e&&(e=y.cloneNode(e),this.addTemplate(o,e,!0),this[a+"HeaderPresenter"]=e),n&&i&&(i=y.cloneNode(i),this.addTemplate(n,i,!0),this[a+"Presenter"]=i)},createChildren:function(){t.createChildren.call(this),this.getTemplate("gridTemplate"),this.getTemplate("detailTemplate"),this.getTemplate("searchTemplate"),this.getTemplate("detailHeaderTemplate"),this.getTemplate("newHeaderTemplate"),this.getTemplate("headerTemplate"),this.getTemplate("footerTemplate");var e=this.get_scope();this._newView.atomControl._scope=new S(this,e),this._detailView.atomControl._scope=new S(this,e);var n=y.cloneNode(this._gridTemplate);this.addTemplate(this._gridPresenter,n);var i=this._detailTemplate;if(y.attr(i,"atom-dock")||y.attr(i,"atom-dock","Fill"),this._headerTemplate){var o=y.cloneNode(this._headerTemplate);o.setAttribute("atom-dock","Top"),a(o).addClass("atom-navigator-list-header"),o._templateParent=this,this.addTemplate(this._gridPanel,o)}if(this._footerTemplate){var r=y.cloneNode(this._footerTemplate);r.setAttribute("atom-dock","Bottom"),a(r).addClass("atom-navigator-list-footer"),this.addTemplate(this._gridPanel,r)}},init:function(){t.init.call(this);var e=this;this.backCommand=function(){e.onBackCommand.apply(e,arguments)},this.addCommand=function(){e.onAddCommand.apply(e,arguments)},this.cancelAddCommand=function(){e.onCancelAddNewCommand.apply(e,arguments)},this.showDetailCommand=function(){var t=e.get_selectedItem();t&&(E.setValue(e,"displayMode",1),e.updateDisplayMode())}}}})}(u.AtomListBox.prototype),function(e){var n=t.AtomUI;return i({name:"WebAtoms.AtomNumberComboBox",base:e,start:function(){},properties:{showPrompt:!1,startNumber:void 0,endNumber:void 0,step:1},methods:{set_startNumber:function(t){this._startNumber=t,this.resetNumbers()},set_endNumber:function(t){this._endNumber=t,this.resetNumbers()},set_step:function(t){t&&(this._step=t,this.resetNumbers())},onLoaded:function(){this.resetNumbers()},resetNumbers:function(){if(this._created&&void 0!==this._startNumber&&void 0!==this._endNumber){var t=n.toNumber(this._startNumber),e=n.toNumber(this._endNumber),i=n.toNumber(this._step),o=[];for(this._showPrompt&&o.push({label:"Select",value:0});e>=t;t+=i)o.push({label:t,value:t});this.set_items(o)}}}})}(u.AtomComboBox.prototype),function(e){var n=t.document,o=t.$,a=[{label:"(US +1)",code:1,country:"US",format:"999-999-9999"},{label:"(CA +1)",code:1,country:"CA",format:"999-999-9999"},{label:"(IN +91)",code:91,country:"IN",format:"99-99-999999"},{label:"(UK +44)",code:44,country:"UK",format:"999-999-9999"}];return i({name:"WebAtoms.AtomPhoneControl",base:e,start:function(){this._value=""},properties:{countries:a},methods:{set_value:function(t){this._value=t,this._countries&&this.setupValues()},setupValues:function(){if(!this._value)return o(this.num).val(""),o(this.ext).val(""),void o(this.msg).val("");for(var t=this._value.split(":",6),e=t[1],n=new f(this._countries);n.next();){var i=n.current();if(i.country==e){this.cs.selectedIndex=n.currentIndex();break}}var a=(t[3]||"").split(".").join("-");"--"==a&&(a=""),o(this.num).val(a),o(this.ext).val(t[4]),o(this.msg).val(t[5]),this.onFormat()},onDataChange:function(){var t="v2:",e=this.cs.selectedIndex,n=this._countries[e];t+=n.country+":"+n.code;var i=o(this.num).val().split("-").join(".");t+=":"+i,t+=":"+o(this.ext).val(),t+=":"+o(this.msg).val(),this._value=i?t:"",E.refreshValue(this,"value")},set_countries:function(t){this._countries=t,this.onFormat()},onCountryChange:function(){this.onDataChange(),this.onFormat()},onFormat:function(){if(!this._isFormatting){this._isFormatting=!0;var t=this._countries,e=this.cs.options;e.length=0;for(var n=new f(t);n.next();){var i=n.current();i.valueIndex||(i.label=i.label,i.valueIndex=n.currentIndex()),e[n.currentIndex()]=new Option(i.label,i.valueIndex,!1,!1)}this.setupValues();var a=this.cs;if(-1!=a.selectedIndex){var i=this._countries[a.selectedIndex];i.format?o(this.num).mask(i.format):o(this.num).unmask(),this._isFormatting=!1}}},init:function(){this.cs=n.createElement("SELECT"),this.num=n.createElement("INPUT"),this.num.type="text",this.ext=n.createElement("INPUT"),this.ext.type="text",o(this.ext).attr("placeholder","Ext."),this.msg=n.createElement("INPUT"),this.msg.type="text",o(this.msg).attr("placeholder","Message");var t=this.get_element();t.appendChild(this.cs),t.appendChild(this.num),t.appendChild(this.ext),t.appendChild(this.msg);var i=this;this.onKeyUpLater=function(t){var e=t;i.onDataChange(e)},this.bindEvent(this.cs,"change","onCountryChange"),this.bindEvent(this.num,"change","onDataChange"),this.bindEvent(this.num,"keyup","onKeyUpLater"),this.bindEvent(this.num,"keypress","onKeyUpLater"),this.bindEvent(this.ext,"change","onDataChange"),this.bindEvent(this.msg,"change","onDataChange"),o(this._element).addClass("atom-phone-control"),o(this.num).addClass("atom-pc-num"),o(this.msg).addClass("atom-pc-msg"),o(this.cs).addClass("atom-pc-cs"),o(this.ext).addClass("atom-pc-ext"),e.init.call(this);var a=this;u.dispatcher.callLater(function(){a.onFormat()})}}})}(u.AtomControl.prototype),function(t){return i({name:"WebAtoms.AtomRadioButtonList",base:t,start:function(){this._allowMultipleSelection=!1},properties:{groupName:""},methods:{init:function(){this._groupName="__g"+y.getNewIndex(),t.init.call(this)}}})}(u.AtomItemsControl.prototype),function(t){return i({name:"WebAtoms.AtomSortableColumn",base:t,start:function(){},properties:{direction:"",defaultDirection:"",label:"",sortField:null},methods:{set_direction:function(t){this._direction=t;var e=a(this._element);e.removeClass("atom-sort-asc atom-sort-desc"),t&&e.addClass("atom-sort-"+t.toLowerCase())},set_value:function(t){this._value=t,this.refreshUI()},refreshUI:function(){return this._value?-1==this._value.indexOf(this._sortField)?void E.setValue(this,"direction",""):void(this._value.lastIndexOf("desc")!=this._value.length-4?E.setValue(this,"direction","asc"):E.setValue(this,"direction","desc")):void 0},onClick:function(){this._direction?"asc"==this._direction?E.setValue(this,"direction","desc"):E.setValue(this,"direction","asc"):E.setValue(this,"direction",this._defaultDirection),E.setValue(this,"value",this._sortField+" "+this._direction)},init:function(){t.init.call(this),this.bindEvent(this._element,"click","onClick"),a(this._element).addClass("atom-column")},onUpdateUI:function(){this.refreshUI()}}})}(u.AtomControl.prototype),function(t){return i({name:"WebAtoms.AtomTabButtonBar",base:t,start:function(){this._allowMultipleSelection=!1,this._showTabs=!0},methods:{}})}(u.AtomLinkBar.prototype),function(t){return i({name:"WebAtoms.AtomTabControl",base:t,start:function(){this._presenters=["itemsPresenter"],this._layout=u.AtomViewBoxLayout.defaultInstance,this.selectedIndex=0,this.labelPath="label"},properties:{items:null},methods:{createChildren:function(){if(t.createChildren.call(this),this._itemsPresenter!=this._element){for(var e=[],n=new w(this._element);n.next();){var i=n.current();this._element.removeChild(i),e.push(i)}if(this._template){var o=y.cloneNode(this._template);o._templateParent=this,this._element.appendChild(o),this.onCreateChildren(this._element)}for(n=new f(e);n.next();)this._itemsPresenter.appendChild(n.current());this._template&&this.onCreateChildren(this._itemsPresenter)}}}})}(u.AtomControl.prototype),function(t){return i({name:"WebAtoms.AtomTimePicker",base:t,start:function(){c("AtomTimePicker is Depricated !!!, use AtomTimeEditor")},properties:{displayLabel:"9:00 AM"},methods:{init:function(){this._autoOpen=!0;for(var e=[],n=0;23>=n;n++){var i="AM",o=n;n>11&&(i="PM",n>12&&(o=n-12));var a=o+":00 "+i;e.push({label:a,value:a}),a=o+":30 "+i,e.push({label:a,value:a})}this._items=e,t.init.call(this)}}})}(u.AtomAutoCompleteBox.prototype);var W=function(t){this._self=t,this._updating=!1,this.update=function(t){if(!this._updating)try{this._updating=!0,t.apply(this._self)}finally{this._updating=!1}}};!function(t){var e=/^([0-1]?[0-9]|2[0-3]):[0-5][0-9] [ap][m]$/i;return i({name:"WebAtoms.AtomTimeEditor",base:t,start:function(t){a(t).addClass("atom-time-editor"),this._updater=new W(this)},properties:{time:"10:00",ap:"AM",value:"10:00 AM"},methods:{get_hours24:function(){var t=this._time.split(":"),e=parseInt(t[0]||"0");return"PM"==this._ap&&12!=e&&(e+=12),e},set_hours24:function(t){this.setTime(t,this.get_minutes())},get_hours:function(){var t=this._time.split(":"),e=parseInt(t[0]||"0");return e},get_minutes:function(){var t=this._time.split(":");return parseInt(t[1]||"0")},setTime:function(t,e,n){var i=this.get_ap();n&&t>12&&(t-=12,i="PM"),t=""+t,1==t.length&&(t="0"+t),e+="",1==e.length&&(e="0"+e),E.setValue(this,"value",t+":"+e+" "+i)},set_hours:function(t){this.setTime(t,this.get_minutes())},set_minutes:function(t){this.setTime(this.get_hours(),t)},set_value:function(t){this._updater.update(function(){if(this._value!=t){if(!e.test(t))throw new Error("Unknown time format, expecting ##:## AM");this._value=t,t=t.split(" "),this._time=t[0],this._ap=t[1].toUpperCase(),this.refreshProperties()}})},refreshProperties:function(){g.refresh(this,"value"),g.refresh(this,"time"),g.refresh(this,"ap"),g.refresh(this,"hours"),g.refresh(this,"hours24"),g.refresh(this,"minutes")},set_time:function(t){this.set_value(t+" "+this._ap)},set_ap:function(t){this.set_value(this._time+" "+t)},get_value:function(){return this._time+" "+this._ap}}})}(u.AtomControl.prototype),function(t){return i({name:"WebAtoms.AtomUploadButton",base:t,start:function(t){if(/input/gi.test(t.nodeName)&&/file/gi.test(y.attr(t,"type")))return void(this._filePresenter=t);var e=this._filePresenter=r.createElement("input");y.attr(e,"type","file"),a(e).css({left:"-500px",position:"absolute",top:"0"}),r.body.appendChild(this._filePresenter)},properties:{fileTypes:void 0,accept:"*/*",capture:"",progress:0},methods:{set_accept:function(t){if(this._accept=t,t){var e=this._filePresenter;e&&y.attr(e,"accept",t)}},set_capture:function(t){if(this._capture=t,t){var e=this._filePresenter;e&&y.attr(e,"capture",t)}},onClickHandler:function(t){(!this._confirm||confirm(this._confirmMessage))&&this._postUrl&&this._filePresenter!=this._element&&(a(this._filePresenter).trigger("click"),y.cancelEvent(t))},onFileSelected:function(){var t=this.get_postData();if(null!==t&&void 0!==t){var e=this._mergeData;if(e)for(var n in e)t[n]=e[n];var i=this._xhr;if(!i){i=new XMLHttpRequest;var o=i.upload;try{i.timeout=36e5}catch(a){}this.bindEvent(o,"progress","onProgress"),this.bindEvent(o,"timeout","onError"),this.bindEvent(o,"error","onError"),this.bindEvent(i,"load","onComplete"),this.bindEvent(i,"error","onError"),this.bindEvent(i,"timeout","onError"),this._xhr=i}for(var r=new FormData,s=new f(this._filePresenter.files);s.next();)r.append("file"+s.currentIndex(),s.current());r.append("formModel",JSON.stringify(E.getClone(t))),i.open("POST",this._postUrl),i.send(r),atomApplication.setBusy(!0,"Uploading...")}},set_progress:function(t){this._progress=t,t&&E.setValue(atomApplication,"progress",t)},onError:function(t){atomApplication.setBusy(!1,"Uploading..."),this.unbindEvent(this._xhr),this._xhr=null,this._lastError=t,g.alert("Upload failed")},onProgress:function(t){if(t.lengthComputable){var e=Math.round(100*t.loaded/t.total);E.setValue(this,"progress",e)}},onComplete:function(t){atomApplication.setBusy(!1,"Uploading...");if(t.target){if(200!=t.target.status)return void g.alert(t.target.statusText);this._value=t.target.responseText}else this._value=t.result;this.unbindEvent(this._xhr),this._xhr=null,E.refreshValue(this,"value"),this.invokeAction(this._next,t)},init:function(){t.init.call(this);var e=this._filePresenter;this.bindEvent(e,"change","onFileSelected")}}})}(u.AtomPostButton.prototype),function(t,e){return i({name:"WebAtoms.AtomViewBox",base:e,start:function(){this._layout=t.AtomViewBoxLayout.defaultInstance},methods:{}})}(u,u.AtomControl.prototype),function(t){return i({name:"WebAtoms.AtomWizard",base:t,start:function(){this._presenters=["viewPresenter"]},properties:{currentStep:null,nextLabel:"Next",nextClass:"",buttons:null,prevLabel:"Back",finishLabel:"Finish",canMoveBack:!0,canMoveNext:!0,steps:0,isLastStep:!1},methods:{set_currentStep:function(t){this._currentStep=t;var e=this._buttons;if(e&&e.length){var n=e[t];E.setValue(this,"nextLabel",n.label),E.setValue(this,"nextClass",n.styleClass)}E.refreshValue(this,"isLastStep")},get_isLastStep:function(){return this._currentStep==this._steps-1},createWizard:function(){var t=this._viewPresenter;this.disposeChildren(t);for(var e=this._viewTemplate,n=0,i=new w(e);i.next();){n++;var o=y.cloneNode(i.current());t.appendChild(o);var a=y.getAtomType(o);a||(a="AtomViewBox",y.attr(o,"data-atom-type",a));var r=y.getAtomType(o)||u.AtomControl,s=y.createControl(o,r);s.init()}E.setValue(this,"steps",n),n&&E.setValue(this,"currentStep",0)},init:function(){a(this._element).addClass("atom-wizard"),t.init.call(this);var e=this,n=this._viewPresenter;this.goNextCommand=function(t,n,i){e.get_isLastStep()?(e.invokeAction(e._next,i),E.setValue(e,"canMoveBack",!1)):E.setValue(e,"currentStep",e._currentStep+1)},this.goPrevCommand=function(){E.setValue(e,"currentStep",e._currentStep-1)},this.resetCommand=function(){e.createWizard(),E.setValue(e,"currentStep",0),E.setValue(e,"canMoveBack",!0)},this.createWizard(),this.nextCommand=function(t,i,o){var a=n.atomControl.get_selectedChild().atomControl;return a._next?void a.invokeAction(a._next):void e.goNextCommand(t,i,o)}}}})}(u.AtomDockPanel.prototype),function(t){return i({name:"WebAtoms.AtomYesNoControl",base:t,start:function(){this._allowSelectFirst=!1,this._items=[{label:"Yes",value:!0},{label:"No",value:!1}]},methods:{}})}(u.AtomToggleButtonBar.prototype),function(e){return i({name:"WebAtoms.AtomYesNoCustom",base:e,start:function(){this._presenters=["yesNo","input"],this._hasValue=!1},properties:{hasValue:!1,placeholder:null},methods:{set_hasValue:function(t){this._hasValue=t,t||E.setValue(this,"value","")},set_value:function(t){this._value=t,E.setValue(this,"hasValue",t?!0:!1),this._onUIChanged||a(this._input).val(t)},onValueChange:function(){this._onUIChanged=!0;var t=a(this._input).val();E.setValue(this,"value",t),this._onUIChanged=!1},onUpdateUI:function(){if(a(this._input).addClass("atom-yes-no-custom-input"),this._placeholder){y.attr(this._input,"placeholder",this._placeholder);var e=t.placeHolderFixer;e&&e.refresh()}},init:function(){e.init.call(this),this._yesNo=this._yesNo.atomControl;var t=this._input;this.bindEvent(t,"change","onValueChange")}}})}(u.AtomControl.prototype),t.appScope=t.appScope||{},this.atomApplication=null,function(e){return n("WebAtoms.AtomApplication",e,function(e){if(a(e).removeClass("atom-dock-panel"),a(e).addClass("atom-application"),this._scope=new S(this,null,this),t.model&&(t.appScope.model=t.model,this._data=t.model),t.appScope){var n=this._scope,i=t.appScope;for(var o in i)n[o]=i[o]}t.appScope=this._scope,t.atomApplication=this,this.busyCount=0;var r=location.hash;if(r=r?r.substr(1):r){var i=y.parseUrl(r);this._hash=location.hash;var s=this._scope;this._defaultHash=i;for(var o in i){var l=i[o];s[o]=l}}else this._hash=location.hash;this._defaultScope={}},{get_title:function(){return r.title},set_title:function(t){r.title=t},get_isBusy:function(){return this.busyCount},setBusy:function(t,e){t?this.busyCount++:this.busyCount--,void 0!==e?(e||(e=""),E.setValue(this,"busyMessage",e)):E.setValue(this,"busyMessage","Loading..."),E.refreshValue(this,"isBusy")},updateUI:function(){e.updateUI.call(this),E.refreshValue(this,"appWidth"),E.refreshValue(this,"appHeight"),E.refreshValue(this,"bodyWidth"),E.refreshValue(this,"bodyHeight")},onUpdateUI:function(){this._renderAsPage||e.onUpdateUI.call(this)},get_appWidth:function(){return a(this._element).width()},get_appHeight:function(){return a(this._element).height()},get_bodyWidth:function(){return a(r.body).width()},get_bodyHeight:function(){return a(r.body).height()},onHashChanged:function(){if(!this._noHashRefresh){var t=this._scope,e=location.hash;e||(e="#"),this._noHashRefresh=!0,e=e.substr(1);var n=y.parseUrl(e);if(this._created){var i=this._defaultScope;for(var o in i){var a=i[o];void 0===n[o]&&(n[o]=a)}for(var o in n){var r=n[o];t[o]!=r&&E.setValue(t,o,r)}}else g.merge(t,n);this._noHashRefresh=!1}},invokeUpdateUI:function(){var e=this;t.setTimeout(function(){return e.updateUI()},5)},onRefreshValue:function(){if(!this._noHashRefresh&&this._ready){var t=this._defaultScope,e=E.getClone(this._defaultHash||{}),n=this._scope;for(var i in n){var o=n[i];if(t.hasOwnProperty(i)){if(o==t[i])continue;e[i]=o}else{if(0==i.indexOf("_"))continue;if(void 0===o||null===o)continue;if(!/string|number|boolean/i.test(typeof o))continue;e[i]=o}}var a=[];for(var i in e){var o=e[i];a.push({key:i,value:o})}var s="#"+a.map(function(t){return t.key+"="+encodeURIComponent(t.value)}).join("&");s!=location.hash&&("#"!=s||location.hash)&&(this._noHashRefresh=!0,history&&history.pushState?history.pushState({},r.title,location.href.split("#")[0]+s):location.href=s,this._noHashRefresh=!1)}},onInitialized:function(){if(this._ready=!0,e.onInitialized.call(this),this._renderAsPage||a(this._element).addClass("atom-dock-application"),p.isIE&&p.majorVersion<8){var n=this;setInterval(function(){n.onCheckHash()},1e3),this._lastHash=location.hash}else{var i=t.onhashchange?"onhashchange":"hashchange";this.bindEvent(t,i,"onHashChanged")}},createChildren:function(){e.createChildren.call(this),this.getTemplate("busyTemplate"),this._busyTemplate&&(this._element.appendChild(this._busyTemplate),this.onCreateChildren(this._busyTemplate))},onCreated:function(){e.onCreated.call(this),this._next&&u.dispatcher.callLater(function(){t.atomApplication.invokeAction(t.atomApplication._next)})},onCheckHash:function(){this._lastHash!=location.hash&&(this.onHashChanged(),this._lastHash=location.hash)},onCloseCommand:function(){if(parent){var t=frameElement.atomWindow;t._value=this._value,t.onCloseCommand()}},setup:function(){this.createChildren(),this.init()},init:function(){this.bindEvent(t,"resize","invokeUpdateUI");var n=this;this._onRefreshValue=o(function(){n.onRefreshValue.apply(n,arguments)}),this._scope._$_watcher=this,e.init.call(this),this.closeCommand=function(){n.onCloseCommand.apply(n,arguments)}}},{renderAsPage:!1,busyMessage:"",progress:0})}(u.AtomDockPanel.prototype),function(t){return i({name:"WebAtoms.AtomAutoPostForm",base:t,start:function(){},properties:{isBusy:!1,postError:null},methods:{pushPost:function(t){if(!this._isBusy){this._pushPostTimeout&&clearTimeout(this._pushPostTimeout),t||(t=1e3);var e=this;this._pushPostTimeout=setTimeout(function(){u.dispatcher.callLater(function(){e.onSubmit()})},t)}},onSubmit:function(){if(this._pushPostTimeout=0,!this._isBusy&&this.isValid()){var t=this.preparePostData();if(t){var e=JSON.stringify(E.getClone(t));if(!this._cachedData||e!=this._cachedData){this._cachedData=e;var n=this,i=B.getUrl(this._postUrl),o=B.json(i,null,{type:"POST",data:t}).then(n._success);o.failed(function(){n._isBusy=!1,n._postError=o.error.msg,E.refreshValue(n,"isBusy"),E.refreshValue(n,"postError")}),o.showProgress(!1),o.showError(!1),o.invoke()}}}},onCreated:function(){t.onCreated.apply(this,arguments);var e=this.preparePostData();e&&(this._cachedData=JSON.stringify(E.getClone(e)))},onSuccess:function(){t.onSuccess.apply(this,arguments),this._isBusy=!1,E.refreshValue(this,"isBusy")},onKeyUp:function(t){this.pushPost(),t.target&&t.target.nodeName&&/textarea/gi.test(t.target.nodeName)||13==t.keyCode&&this.onSubmit()},init:function(){t.init.call(this);var e=this;this.pushPostHandler=function(){e.pushPost(1e3)},this.bindEvent(this._element,"click",this.pushPostHandler),a(this._element).find("input,select,textarea").bind("change",null,this.pushPostHandler)}}})}(u.AtomForm.prototype),function(t){return i({name:"WebAtoms.AtomFormField",base:t,start:function(){this._presenters=["contentPresenter"]},properties:{error:void 0,dataType:null,label:void 0,fieldClass:void 0,required:!1,isValid:void 0,regex:null,fieldValue:void 0,field:null,requiredMessage:"Required",invalidMessage:"Invalid",fieldVisible:!0,validate:!1,isValidSet:!1},methods:{set_fieldVisible:function(t){this._fieldVisible=t,a(this._element).css("display",t?"":"none")},set_fieldClass:function(t){this._fieldClass=t,this.setLocalValue("class",t,this._element)},set_dataType:function(t){this._dataType=t,this.setup()},set_fieldValue:function(t){this._fieldValue=t,this._validate&&this.validate()},set_isValid:function(t){this._isValid=t,this._isValidSet=!0,this._validate&&this.validate()},set_regex:function(t){this._regex=t,this.setup()},set_required:function(t){this._required=t,this.setup()},validateChildren:function(t){for(var e=new w(t);e.next();){var n=e.current();n.atomControl?this.validateValue(E.getValue(n.atomControl,"value")):/input|select|textarea/gi.test(n.nodeName)?this.validateValue(a(n).val()):this.validateChildren(n)}},getInputErrors:function(){var t=[],e=this._element;if(void 0===this._fieldValue)return getInputErrors(e,!0);if(this._isValidSet)return this._isValid?t:[{label:this.get_invalidMessage(),value:e}];var n={};this._required&&(n["atom-required"]={msg:this.get_requiredMessage()}),this._dataType&&(n["atom-data-type"]={value:this._dataType,msg:this.get_invalidMessage()}),this._regex&&(n["atom-regex"]={value:this._regex,msg:this.get_invalidMessage()});var i=getInputError(e,n,this._fieldValue);return i?(this.set_error(i.label),t.push({label:i,value:e}),this._isValid=!1):this._isValid=!0,E.refreshValue(this,"isValid"),t.length?t:null},clearInputErrors:function(){this._error=null,this._isValid=!0,E.refreshValue(this,"error"),E.refreshValue(this,"isValid")},validateValue:function(t){if(this._required){if(!t)return E.setValue(this,"error",this._requiredMessage),void(this._isValid=!1)}else if(!t)return void(this._isValid=!0);var e=null;return/email/gi.test(this._dataType)?e=/^(([^<>()\[\]\\.,;:\s@\"]+(\.[^<>()\[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/:this._regex&&(e=eval("("+this._regex+")")),e&&!e.test(t)?(E.setValue(this,"error",this._invalidMessage),void(this._isValid=!1)):void 0},validate:function(){return this._validate=!0,this._required||this._regex||this._dataType?this._isValid&&(E.setValue(this,"error",""),this._isValidSet)?!0:(this._isValid=!0,void 0!==this._fieldValue?this.validateValue(this._fieldValue):this.validateChildren(this._element),this._isValid&&E.setValue(this,"error",""),this._isValid):void 0===this._isValid?!0:this._isValid},onCreated:function(){this.setup()},onFocusOut:function(){this._validate=!0,this.validate()},setup:function(){if(this._created){var t=this._element;this._contentPresenter&&this._contentPresenter.appendChild(this._element.contentElement);for(var e=new f(a(t).find("input,select,textarea"));e.next();){var n=e.current();this.bindEvent(n,"blur","onFocusOut"),this.bindEvent(n,"change","onFocusOut")}E.refreshValue(this,"fieldClass")}}}})}(u.AtomControl.prototype),function(t){return i({name:"WebAtoms.AtomFormGridLayout",base:t,start:function(){},properties:{minLabelWidth:100,cellSpacing:5,label:""},methods:{onUpdateUI:function(){E.refreshValue(this,"controlWidth"),E.refreshValue(this,"controlHeight"),t.onUpdateUI.apply(this,arguments)},get_controlWidth:function(){return a(this._element.parentNode).innerWidth()},get_controlHeight:function(){return a(this._element.parentNode).innerHeight()},createChildren:function(){var t=this._element;a(t).addClass("atom-form-grid");var e=a(t).children(),n=new f(e);y.removeAllChildren(t);var i=r.createElement("DIV");a(i).addClass("atom-form-grid-container"),t.appendChild(i);y.attr(this._element,"atom-min-label-width");for(this.getTemplate("fieldTemplate");n.next();){var o=n.current(),s=y.attr(o,"atom-type");if("AtomFormRow"!=s)if("AtomFormTabControl"!=s&&"AtomTabControl"!=s)this.createField(i,o);else{var l=r.createElement("ul");l.setAttribute("atom-type","AtomToggleButtonBar");var u=y.assignID(l);l.setAttribute("atom-name",u),l.setAttribute("atom-show-tabs","true");var h=r.createElement("li");l.appendChild(h),h.setAttribute("atom-text","{$data.label}"),h.setAttribute("atom-template","itemTemplate"),this.createField(i,l);for(var m=k[u],d=new w(o),c=[],p=0;d.next();){var v=d.current();a(v).remove(),v.setAttribute("style-display","[$scope."+u+".selectedIndex == "+p+" ? '' : 'none']");var g=this.createField(i,v);c.push(g),p++}m.set_items(c)}else{var _=r.createElement("TABLE");i.appendChild(_),a(_).addClass("atom-form-grid-row");var A=r.createElement("TBODY");_.appendChild(A);var b=r.createElement("TR");A.appendChild(b);for(var e=a(o).children(),d=new f(e);d.next();){var C=r.createElement("TD");b.appendChild(C),this.createField(C,d.current())}}}}}})}(u.AtomFormLayout.prototype),function(t){return i({name:"WebAtoms.AtomFormTab",base:t,start:function(){},methods:{}})}(u.AtomFormGridLayout.prototype),function(t){return i({name:"WebAtoms.AtomFormNoLayout",base:t,start:function(){},methods:{}})}(u.AtomForm.prototype),function(t){return i({name:"WebAtoms.AtomFormVerticalLayout",base:t,start:function(){},methods:{}})}(u.AtomFormLayout.prototype),function(t){return i({name:"WebAtoms.AtomTableLayout",base:t,start:function(t,e,n){this._cellWidth=e,this._cellHeight=n,this._columns=t},methods:{doLayout:function(t){var e,n=new f(a(t).children()),i=0,o=0,r=Math.ceil(n._array.length/this._columns)-1,s=r,l=this._columns*this._cellWidth,u=this._cellHeight*(r+1);for(t.style.position="relative",t.style.width=l+"px",t.style.height=u+"px",t.maxRows=r;n.next();)e=n.current(),e.style.position="absolute",e.style.left=i+"px",e.style.top=o+"px",e.style.width=this._cellWidth+"px",0>=s?(s=r,i+=this._cellWidth+10,o=0):(s--,o+=this._cellHeight)}}})}(u.AtomLayout.prototype);var U=function(t){return i({name:"WebAtoms.AtomViewBoxLayout",base:t,start:function(){},methods:{doLayout:function(t){for(var e,n={width:a(t).innerWidth()+"px",height:a(t).innerHeight()+"px"},i=new w(t);i.next();)e=i.current(),e.style.width=n.width,e.style.height=n.height,e.atomControl&&e.atomControl.updateUI()}}})}(u.AtomLayout.prototype);U.defaultInstance=new U,g.confirm=function(t,e){var n={Message:t,ConfirmValue:!1,Confirm:e?!0:!1},i=r.createElement("DIV");r.body.appendChild(i);var o=y.createControl(i,u.AtomWindow,n);o.set_windowWidth(380),o.set_windowHeight(120),o.set_windowTemplate(o.getTemplate("alertTemplate")),o.set_title(e?"Message":"Confirm"),o.set_next(function(){o.dispose(),a(i).remove(),n.ConfirmValue&&e&&e()}),o.refresh()},g.alert=t.__chromeCSP?function(t){g.confirm(t,null)}:function(t){alert(t)},a(r).ready(function(){var t=u.dispatcher;t.setupControls(),t.start()}),a(t).unload(function(){function t(e){if(e)if(e.atomControl)e.atomControl.dispose();else for(var n=new w(e);n.next();)t(n.current())}t(r.body)})}(window);
//# sourceMappingURL=atoms.min.map