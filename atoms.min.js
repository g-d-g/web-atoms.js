function mapLibrary(n,t,i){var u=n.indexOf("."),r;return u==-1?(r=t[n],r||(r=i,t[n]=r),r):(r=mapLibrary(n.substr(0,u),t,{}),mapLibrary(n.substr(u+1),r,i))}function createProperty(n,t){return t?function(){return this[n]}:function(t){this[n]=t}}function classCreator(n,t,i,r,u){var o=t?t.constructor:null,s=i||function(){},h=u,e=null,c,f;if(o){e=u?function(){for(var t in h)this["_"+t]=h[t];o.apply(this,arguments);this.__typeName=n;s.apply(this,arguments)}:function(){o.apply(this,arguments);this.__typeName=n;s.apply(this,arguments)};c=o.prototype;for(f in c)r[f]||c.hasOwnProperty(f)&&(r[f]=c[f])}else e=u?function(){this.__typeName=n;for(var t in h)this["_"+t]=h[t];s.apply(this,arguments)}:function(){this.__typeName=n;s.apply(this,arguments)};if(u)for(f in u)r["get_"+f]||(r["get_"+f]=createProperty("_"+f,!0)),r["set_"+f]||(r["set_"+f]=createProperty("_"+f));return e.__typeName=n,o&&(e.__baseType=o),e.prototype=r,e.prototype.constructor=e,r.hasOwnProperty("toString")||(e.prototype.toString=function(){return n}),mapLibrary(/\./.test(n)?n:"WebAtoms."+n,window,e),e}function classCreatorEx(n){return classCreator(n.name,n.base,n.start,n.methods,n.properties)}window.createClass=classCreatorEx;window.classCreatorEx=classCreatorEx,function(n){typeof define=="function"&&define.amd?define(["jquery"],n):typeof exports=="object"?n(require("jquery")):n(jQuery)}(function(n){var t=navigator.userAgent,u=/iphone/i.test(t),f=/chrome/i.test(t),i=/android/i.test(t),r;n.mask={definitions:{"9":"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},autoclear:!0,dataName:"rawMaskFn",placeholder:"_"};n.fn.extend({caret:function(n,t){var i;if(this.length!==0&&!this.is(":hidden"))return typeof n=="number"?(t=typeof t=="number"?t:n,this.each(function(){this.setSelectionRange?this.setSelectionRange(n,t):this.createTextRange&&(i=this.createTextRange(),i.collapse(!0),i.moveEnd("character",t),i.moveStart("character",n),i.select())})):(this[0].setSelectionRange?(n=this[0].selectionStart,t=this[0].selectionEnd):document.selection&&document.selection.createRange&&(i=document.selection.createRange(),n=0-i.duplicate().moveStart("character",-1e5),t=n+i.text.length),{begin:n,end:t})},unmask:function(){return this.trigger("unmask")},mask:function(t,e){var y,l,o,c,h,a,s,p,v;return!t&&this.length>0?(y=n(this[0]),v=y.data(n.mask.dataName),v?v():undefined):(e=n.extend({autoclear:n.mask.autoclear,placeholder:n.mask.placeholder,completed:null},e),l=n.mask.definitions,o=[],c=s=t.length,h=null,n.each(t.split(""),function(n,t){t=="?"?(s--,c=n):l[t]?(o.push(new RegExp(l[t])),h===null&&(h=o.length-1),n<c&&(a=o.length-1)):o.push(null)}),this.trigger("unmask").each(function(){function tt(){if(e.completed){for(var n=h;n<=a;n++)if(o[n]&&y[n]===w(n))return;e.completed.call(v)}}function w(n){return n<e.placeholder.length?e.placeholder.charAt(n):e.placeholder.charAt(0)}function b(n){while(++n<s&&!o[n]);return n}function ft(n){while(--n>=0&&!o[n]);return n}function it(n,t){var r,i;if(!(n<0)){for(r=n,i=b(t);r<s;r++)if(o[r]){if(i<s&&o[r].test(y[i]))y[r]=y[i],y[i]=w(i);else break;i=b(i)}d();v.caret(Math.max(h,n))}}function et(n){for(var r,u,t=n,i=w(n);t<s;t++)if(o[t])if(r=b(t),u=y[t],y[t]=i,r<s&&o[r].test(u))i=u;else break}function ot(){var t=v.val(),n=v.caret(),i;if(t.length<p.length){for(k(!0);n.begin>0&&!o[n.begin-1];)n.begin--;if(n.begin===0)while(n.begin<h&&!o[n.begin])n.begin++;v.caret(n.begin,n.begin)}else{for(i=k(!0);n.begin<s&&!o[n.begin];)n.begin++;v.caret(n.begin,n.begin)}tt()}function rt(){k();v.val()!=nt&&v.change()}function st(n){if(!v.prop("readonly")){var i=n.which||n.keyCode,f,r,t;p=v.val();i===8||i===46||u&&i===127?(f=v.caret(),r=f.begin,t=f.end,t-r==0&&(r=i!==46?ft(r):t=b(r-1),t=i===46?b(t):t),g(r,t),it(r,t-1),n.preventDefault()):i===13?rt.call(this,n):i===27&&(v.val(nt),v.caret(0,k()),n.preventDefault())}}function ht(t){var f,r,u,e,h,c;v.prop("readonly")||(f=t.which||t.keyCode,r=v.caret(),t.ctrlKey||t.altKey||t.metaKey||f<32)||f&&f!==13&&(r.end-r.begin!=0&&(g(r.begin,r.end),it(r.begin,r.end-1)),u=b(r.begin-1),u<s&&(e=String.fromCharCode(f),o[u].test(e)&&(et(u),y[u]=e,d(),h=b(u),i?(c=function(){n.proxy(n.fn.caret,v,h)()},setTimeout(c,0)):v.caret(h),r.begin<=a&&tt())),t.preventDefault())}function g(n,t){for(var i=n;i<t&&i<s;i++)o[i]&&(y[i]=w(i))}function d(){v.val(y.join(""))}function k(n){for(var r=v.val(),u=-1,f,t=0,i=0;t<s;t++)if(o[t]){for(y[t]=w(t);i++<r.length;)if(f=r.charAt(i-1),o[t].test(f)){y[t]=f;u=t;break}if(i>r.length){g(t+1,s);break}}else y[t]===r.charAt(i)&&i++,t<c&&(u=t);return n?d():u+1<c?e.autoclear||y.join("")===ut?(v.val()&&v.val(""),g(0,s)):d():(d(),v.val(v.val().substring(0,u+1))),c?t:h}var v=n(this),y=n.map(t.split(""),function(n,t){if(n!="?")return l[n]?w(t):n}),ut=y.join(""),nt=v.val();v.data(n.mask.dataName,function(){return n.map(y,function(n,t){return o[t]&&n!=w(t)?n:null}).join("")});v.one("unmask",function(){v.off(".mask").removeData(n.mask.dataName)}).on("focus.mask",function(){if(!v.prop("readonly")){clearTimeout(r);var n;nt=v.val();n=k();r=setTimeout(function(){v.get(0)===document.activeElement&&(d(),n==t.replace("?","").length?v.caret(0,n):v.caret(n))},10)}}).on("blur.mask",rt).on("keydown.mask",st).on("keypress.mask",ht).on("input.mask paste.mask",function(){v.prop("readonly")||setTimeout(function(){var n=k(!0);v.caret(n);tt()},0)});if(f&&i)v.off("input.mask").on("input.mask",ot);k()}))}})}),function(n){function ot(n,r){var u,n,f,e,o;if(n)if(n.constructor==String)location.href=n;else if(u=n,u.atomControl)u=u.atomControl,u.refresh?u.refresh(this.get_scope(),this):t.alert("no default action defined");else if(u._element)u.refresh(this.get_scope(),this);else if(typeof u=="function")u.call(this,this.get_scope(),this,r);else{if(u.length){for(ae=new i(u);ae.next();)this.invokeAction(ae.current(),r);return}if(n=u.timeOut||u.timeout,n){f=this;e=100;n.hasOwnProperty("length")&&n.length>1&&(e=n[0],n=n[1]);setTimeout(function(){f.invokeAction(n)},e);return}if(this.set_merge(u),n=u.confirm,n){o="Are you sure?";n.hasOwnProperty("length")&&(n.length>1?(o=n[0],n=n[1]):n=n[0]);var f=this,s=n,h=r;t.confirm(o,function(){f.invokeAction(s,h)})}if(n=u.alert,n&&t.alert(n),n=u.next,n){this.invokeAction(n,r);return}n=u.control;n&&b[n].refresh();n=u.window;n&&WebAtoms.AtomWindow.openNewWindow({url:n,localScope:!1,opener:this,scope:this.get_scope()});n=u.localWindow;n&&WebAtoms.AtomWindow.openNewWindow({url:n,localScope:!0,opener:this,scope:this.get_scope()})}}function st(n,t){function i(n){this._handler=n;var i=this;this.invoke=function(){try{i._handler.apply(i,i.args)}catch(n){console&&console.log(n)}finally{i.timeout=0;i.pending=!1}};this.handler=function(){i.pending||(i.pending=!0,i.args=arguments,i.timeout&&clearTimeout(i.timeout),i.timeout=setTimeout(i.invoke,t||500))}}var r=new i(n);return r.handler}var $=n.$,u=n.document,h={jsonML:{}},WebAtoms={},e,s,c,w,o,AtomEvaluator,ChildEnumerator,i,t,f,it,rt,d,g,AtomUI,a,y,p,AtomBinder,r,ut,b,ft,k,nt,AtomProperties,et,tt;n.WebAtoms=WebAtoms;n.Templates=h;e=h.jsonML;e["WebAtoms.AtomAutoCompleteBox.template"]=[["input",{"data-atom-presenter":"selectionBox",disabled:"disabled",type:"text","data-atom-init":"t1"}],["input",{"data-atom-presenter":"inputBox",type:"text",autocomplete:"off",autocorrect:"off","data-atom-init":"t2"}],["div",{"data-atom-presenter":"itemsPresenter","class":"atom-list-box",style:"position: absolute; z-index: 100;","data-atom-init":"t3"},["div",{"data-atom-template":"itemTemplate",style:"min-width:100px;","data-atom-init":"t4"}]]];e["WebAtoms.AtomCalendar.itemTemplate"]=[["div",{"data-atom-template":"itemTemplate","data-atom-init":"t5"},["span",{"data-atom-init":"t6"}]]];e["WebAtoms.AtomCalendar.template"]=[["section",{"class":"calendar"},["header",{},["button",{"class":"prev","data-atom-init":"t7"}],["select",{"data-atom-type":"AtomComboBox","class":"month","data-atom-init":"t8"}],["select",{"data-atom-type":"AtomComboBox","class":"year","data-atom-init":"t9"}],["button",{"class":"next","data-atom-init":"t10"}]],["ul",{"class":"days"},["li",{"class":"weekend"},"S"],["li",{},"M"],["li",{},"T"],["li",{},"W"],["li",{},"T"],["li",{},"F"],["li",{"class":"weekend"},"S"]],["section",{"class":"day-list","data-atom-presenter":"itemsPresenter"},]]];e["WebAtoms.AtomCheckBoxList.itemTemplate"]=[["div",{"data-atom-template":"itemTemplate"},["input",{type:"checkbox","data-atom-init":"t13"}],["span",{"data-atom-init":"t14"}]]];e["WebAtoms.AtomDataPager.template"]=[["button",{"class":"atom-pager-first-button",style:"float:left","data-atom-init":"t15"},"First"],["span",{style:"text-align:left"},["button",{"class":"atom-pager-prev-button","data-atom-init":"t16"},"Prev"],["span",{},"Goto: Page"],["select",{"data-atom-type":"AtomComboBox","data-atom-init":"t17"},],["button",{"class":"atom-pager-next-button","data-atom-init":"t18"},"Next"]],["button",{"class":"atom-pager-last-button",style:"float:right","data-atom-init":"t19"},"Last"]];e["WebAtoms.AtomDateField.popupTemplate"]=[["div",{"class":"atom-date-popup","data-atom-init":"t20"},["div",{"class":"atom-date-list-box"},["div",{"class":"calendar","data-atom-presenter":"calendarPresenter"},["select",{"data-atom-type":"AtomComboBox","class":"month","data-atom-init":"t22"}],["select",{"data-atom-type":"AtomNumberComboBox","class":"year","data-atom-init":"t23"}],["div",{"class":"days"},["span",{"class":"weekend-header"},"S"],["span",{},"M"],["span",{},"T"],["span",{},"W"],["span",{},"T"],["span",{},"F"],["span",{"class":"weekend-header"},"S"]],["div",{"class":"day-list","data-atom-type":"AtomItemsControl","data-atom-presenter":"itemsPresenter","data-atom-init":"t24"},["div",{"data-atom-template":"itemTemplate","data-atom-init":"t25"},["span",{"data-atom-init":"t26"}]]]]]]];e["WebAtoms.AtomDateField.template"]=[["div",{"class":"date-label","data-atom-init":"t27"}]];e["WebAtoms.AtomDateListBox.template"]=[["div",{"class":"atom-date-list-box"},["div",{"class":"calendar"},["select",{"data-atom-type":"AtomComboBox","class":"month","data-atom-init":"t28"}],["select",{"data-atom-type":"AtomComboBox","class":"year","data-atom-init":"t29"}],["div",{"class":"days"},["span",{"class":"weekend-header"},"S"],["span",{},"M"],["span",{},"T"],["span",{},"W"],["span",{},"T"],["span",{},"F"],["span",{"class":"weekend-header"},"S"]],["div",{"class":"day-list","data-atom-presenter":"itemsPresenter"},["div",{"data-atom-template":"itemTemplate","data-atom-init":"t31"},["span",{"data-atom-init":"t32"}]]]],["div",{"class":"list","data-atom-type":"AtomListBox","data-atom-init":"t33"},["div",{"data-atom-template":"itemTemplate","data-atom-init":"t34"},]]]];e["WebAtoms.AtomItemsControl.itemTemplate"]=[["span",{"data-atom-init":"t35"},"Item"]];e["WebAtoms.AtomLinkBar.itemTemplate"]=[["li",{"data-atom-init":"t36"},["a",{"data-atom-init":"t37"},]]];e["WebAtoms.AtomLinkBar.menuTemplate"]=[["ul",{"class":"menu","data-atom-type":"AtomLinkBar","data-atom-init":"t38"},["li",{"data-atom-template":"itemTemplate"},["a",{"data-atom-init":"t40"}]]]];e["WebAtoms.AtomNavigatorList.detailTemplate"]=[["iframe",{"class":"atom-navigator-list-iframe","data-atom-template":"detailTemplate","data-atom-init":"t41"}]];e["WebAtoms.AtomNavigatorList.template"]=[["div",{"data-atom-type":"AtomViewStack","data-atom-init":"t42"},["div",{"data-atom-type":"AtomDockPanel","data-atom-presenter":"gridPanel"},["div",{"data-atom-dock":"Fill","data-atom-presenter":"gridPresenter","class":"atom-navigator-list-grid"},]],["div",{"data-atom-presenter":"detailView","data-atom-type":"AtomDockPanel","data-atom-init":"t45"},["div",{"data-atom-dock":"Top","data-atom-presenter":"detailHeaderToolbar"},["input",{type:"button",value:"Back",style:"float: left","data-atom-init":"t47"}]]],["div",{"data-atom-presenter":"newView","data-atom-type":"AtomDockPanel","data-atom-init":"t48"},["div",{"data-atom-dock":"Top","data-atom-presenter":"newHeaderToolbar"},["input",{type:"button",value:"Back",style:"float: left","data-atom-init":"t50"}]]]]];e["WebAtoms.AtomRadioButtonList.itemTemplate"]=[["span",{},["input",{type:"radio","data-atom-name":"{$owner.groupName}","data-atom-init":"t51"}],["span",{"data-atom-init":"t52"}]]];e["WebAtoms.AtomSortableColumn.template"]=[["span",{"data-atom-init":"t53"}]];e["WebAtoms.AtomTabControl.template"]=[["div",{"data-atom-type":"AtomDockPanel"},["ul",{"data-atom-dock":"Top","data-atom-type":"AtomToggleButtonBar","data-atom-init":"t55"},["li",{"data-atom-template":"itemTemplate","data-atom-init":"t56"}]],["div",{"data-atom-dock":"Fill","data-atom-type":"AtomViewStack","data-atom-presenter":"itemsPresenter","data-atom-init":"t57"},]]];e["WebAtoms.AtomTimeEditor.template"]=[["span",{},"Hour:"],["input",{type:"number",min:"0",max:"12","data-atom-init":"t58"}],["span",{},"Minute:"],["input",{type:"number",min:"0",max:"59","data-atom-init":"t59"}],["ul",{"data-atom-type":"AtomToggleButtonBar","data-atom-init":"t60"},["li",{"data-atom-template":"itemTemplate","data-atom-init":"t61"}]]];e["WebAtoms.AtomToggleButtonBar.itemTemplate"]=[["li",{"data-atom-init":"t62"},]];e["WebAtoms.AtomWizard.template"]=[["div",{"data-atom-dock":"Fill","data-atom-type":"AtomViewStack","data-atom-presenter":"viewPresenter","data-atom-init":"t63"},],["div",{"data-atom-dock":"Bottom","class":"atom-wizard-command-bar"},["button",{"class":"atom-wizard-back-button","data-atom-init":"t65"},["span",{"data-atom-init":"t66"}]],["button",{"class":"atom-wizard-next-button","data-atom-init":"t67"},["span",{"data-atom-init":"t68"}]]]];e["WebAtoms.AtomYesNoCustom.template"]=[["ul",{"data-atom-type":"AtomYesNoControl","data-atom-presenter":"yesNo","data-atom-init":"t69"}],["input",{style:"vertical-align:top",type:"text","data-atom-presenter":"input","data-atom-init":"t70"}]];e["WebAtoms.AtomApplication.busyTemplate"]=[["div",{style:"position:absolute;left:0px;top:0px;z-index:10000; display:none","data-atom-init":"t71"},["div",{"class":"atom-busy-window",style:"position:absolute","data-atom-init":"t72"},["div",{"class":"atom-busy-image","data-atom-init":"t73"}],["div",{"data-atom-init":"t74"}],["div",{style:"height:3px; background-color:green","data-atom-init":"t75"}]]]];e["WebAtoms.AtomForm.errorTemplate"]=[["section",{"data-atom-type":"AtomItemsControl",style:"overflow:auto","data-atom-init":"t76"},["div",{"data-atom-template":"itemTemplate"},["span",{"data-atom-init":"t78"}]]]];e["WebAtoms.AtomFormGridLayout.fieldTemplate"]=[["table",{"class":"atom-form-grid-row","data-atom-type":"AtomFormField","data-atom-init":"t79"},["tbody",{},["tr",{},["td",{"class":"atom-form-grid-label","data-atom-init":"t80"}],["td",{"class":"atom-form-grid-required","data-atom-init":"t81"},"*"],["td",{"class":"atom-form-grid-content","data-atom-presenter":"contentPresenter","data-atom-init":"t82"},],["td",{"data-atom-init":"t83"},]]]]];e["WebAtoms.AtomFormLayout.fieldTemplate"]=[["tr",{"data-atom-type":"AtomFormField"},["td",{"class":"atom-form-label","data-atom-init":"t85"}],["td",{"class":"atom-form-required","data-atom-init":"t86"},],["td",{"class":"atom-form-content","data-atom-presenter":"contentPresenter"},["span",{style:"background-color:red;color:white; display:inline-block","data-atom-init":"t88"}]]]];e["WebAtoms.AtomFormVerticalLayout.fieldTemplate"]=[["tr",{"data-atom-type":"AtomFormField"},["td",{},["div",{},["span",{"class":"atom-form-label","data-atom-init":"t90"}],["span",{"class":"atom-form-required","data-atom-init":"t91"}]],["div",{"class":"atom-form-content","data-atom-presenter":"contentPresenter","data-atom-init":"t92"}],["div",{"class":"atom-form-error","data-atom-init":"t93"}]]]];e["WebAtoms.AtomWindow.alertTemplate"]=[["div",{"class":"atom-alert","data-atom-dock":"Fill"},["pre",{"data-atom-init":"t95"},],["div",{"class":"buttons","data-atom-init":"t96"},["button",{"class":"ok","data-atom-init":"t97"},"Ok"],["button",{"class":"yes","data-atom-init":"t98"},"Yes"],["button",{"class":"no","data-atom-init":"t99"},"No"]]]];e["WebAtoms.AtomWindow.frameTemplate"]=[["div",{"class":"atom-window-background","data-atom-init":"t100"},["div",{"class":"atom-window","data-atom-presenter":"windowDiv",style:"position:absolute","data-atom-type":"AtomDockPanel","data-atom-init":"t101"},["div",{"class":"atom-window-title","data-atom-dock":"Top","data-atom-presenter":"windowTitleDiv","data-atom-init":"t102"}],["div",{"class":"atom-window-close-button","data-atom-presenter":"windowCloseButton","data-atom-init":"t103"}]]]];e["WebAtoms.AtomWindow.windowTemplate"]=[["iframe",{"class":"atom-window-frame","data-atom-presenter":"iframe","data-atom-init":"t104"},]];WebAtoms.PageSetup=WebAtoms.PageSetup||{},function(){this.t1=function(n){this.bind(n,"styleDisplay",[["isPopupOpen"]],0,function(n){return n?"":"none"});this.bind(n,"value",["selectedText"])};this.t2=function(n){this.bind(n,"placeholder",["placeholder"]);this.bind(n,"value",["displayLabel"],!0,null,"keyup")};this.t3=function(n){this.bind(n,"styleLeft",[["offsetLeft"]],0,function(n){return n+2+"px"});this.bind(n,"styleTop",[["offsetTop"]],0,function(n){return n+24+"px"});this.bind(n,"styleDisplay",[["isPopupOpen"]],0,function(n){return n?"block":"none"})};this.t4=function(n){this.setLocalValue("text",t.get(this,"data")[t.get(this,"templateParent.labelPath")],n)};this.t5=function(n){this.bind(n,"class",[["data","isWeekEnd"],["data","isOtherMonth"],["data","isToday"],["scope","itemSelected"]],0,function(n,t,i,r){return{weekend:n,other:t,today:i,selected:r}})};this.t6=function(n){this.bind(n,"text",["data","label"])};this.t7=function(n){this.setLocalValue("eventClick",t.get(this,"prevMonthCommand"),n);AtomProperties.text(n,"<")};this.t8=function(n){this.setLocalValue("items",f.monthList,n);this.bind(n,"value",["templateParent","month"],!0)};this.t9=function(n){this.bind(n,"items",[["value"],["templateParent","startYear"],["value"],["templateParent","endYear"]],0,function(n,i,r,u){return t.range(n+i,r+u)});this.bind(n,"value",["templateParent","year"],!0)};this.t10=function(n){this.setLocalValue("eventClick",t.get(this,"nextMonthCommand"),n);AtomProperties.text(n,">")};this.t13=function(n){this.bind(n,"checked",["scope","itemSelected"],!0)};this.t14=function(n){this.setLocalValue("text",t.get(this,"data")[t.get(this,"templateParent.labelPath")],n)};this.t15=function(n){this.bind(n,"isEnabled",[["pages","length"],["currentPage"]],0,function(n,t){return n>1&&t});this.setLocalValue("eventClick",t.get(this,"goFirstCommand"),n)};this.t16=function(n){this.setLocalValue("eventClick",t.get(this,"goPrevCommand"),n);this.bind(n,"isEnabled",["currentPage"])};this.t17=function(n){this.bind(n,"items",["atomParent","pages"]);this.bind(n,"value",["atomParent","currentPage"],!0)};this.t18=function(n){this.setLocalValue("eventClick",t.get(this,"goNextCommand"),n);this.bind(n,"isEnabled",[["currentPage"],["pages","length"]],0,function(n,t){return n<t-1})};this.t19=function(n){this.setLocalValue("eventClick",t.get(this,"goLastCommand"),n);this.bind(n,"isEnabled",[["pages","length"],["currentPage"],["pages","length"]],0,function(n,t,i){return n>1&&t<i-1})};this.t20=function(n){this.bind(n,"styleLeft",[["offsetLeft"]],0,function(n){return n+"px"});this.bind(n,"styleTop",[["offsetTop"]],0,function(n){return n+25+"px"});this.bind(n,"class",[["isOpen"]],0,function(n){return n?"popup-open":"popup-closed"})};this.t22=function(n){this.setLocalValue("items",f.monthList,n);this.bind(n,"value",["templateParent","month"],!0)};this.t23=function(n){this.bind(n,"startNumber",[["templateParent","currentYear"],["templateParent","startYear"]],0,function(n,t){return n+t});this.bind(n,"endNumber",[["templateParent","currentYear"],["templateParent","endYear"]],0,function(n,t){return n+t});this.bind(n,"value",["templateParent","year"],!0)};this.t24=function(n){this.bind(n,"items",["templateParent","items"])};this.t25=function(n){this.setLocalValue("eventClick",t.get(this,"templateParent.templateParent.toggleDateCommand"),n);this.bind(n,"class",[["data","isWeekEnd"],["data","isOtherMonth"],["data","isToday"],["templateParent","templateParent","selectedItems"],["data","value"]],0,function(n,i,r,u,f){return{"list-item":!0,weekend:n,other:i,today:r,selected:t.query(u).any({value:f})}})};this.t26=function(n){this.bind(n,"text",["data","label"])};this.t27=function(n){this.bind(n,"class",[["isOpen"]],0,function(n){return n?"date-label-open":"date-label-closed"});this.bind(n,"eventClick",[["isOpen"]],0,function(n){return{owner:{isOpen:!n}}});this.bind(n,"text",[["selectedItem"],["selectedItem","dateLabel"]],0,function(n,t){return n?t:"SELECT"})};this.t28=function(n){this.setLocalValue("items",f.monthList,n);this.bind(n,"value",["templateParent","month"],!0)};this.t29=function(n){this.bind(n,"items",[["value"],["templateParent","startYear"],["value"],["templateParent","endYear"]],0,function(n,i,r,u){return t.range(n+i,r+u)});this.bind(n,"value",["templateParent","year"],!0)};this.t31=function(n){this.setLocalValue("eventClick",t.get(this,"templateParent.toggleDateCommand"),n);this.bind(n,"data",[["templateParent","items"],["scope","itemIndex"]],0,function(n,t){return n[t]});this.bind(n,"class",[["data","isWeekEnd"],["data","isOtherMonth"],["data","isToday"],["templateParent","selectedItems"],["data","value"]],0,function(n,i,r,u,f){return{"list-item":!0,weekend:n,other:i,today:r,selected:t.query(u).any({value:f})}})};this.t32=function(n){this.bind(n,"text",["data","label"])};this.t33=function(n){this.bind(n,"items",["templateParent","selectedItems"]);this.setLocalValue("labelPath","dateLabel",n);this.setLocalValue("valuePath","date",n);this.bind(n,"value",["templateParent","visibleDate"],!0)};this.t34=function(n){this.setLocalValue("text",t.get(this,"data.dateLabel"),n)};this.t35=function(n){this.bind(n,"text",[["data"],["atomParent","labelPath"]],0,function(n,t){return n[t]})};this.t36=function(n){this.setLocalValue("class",t.get(this,"data")[t.get(this,"templateParent.itemsPath")]?t.get(this,"data")[t.get(this,"templateParent.itemsPath")].length?"sub-menu":"":"",n)};this.t37=function(n){this.setLocalValue("href",t.get(this,"data")[t.get(this,"atomParent.valuePath")],n);this.setLocalValue("target",t.get(this,"data")[t.get(this,"atomParent.targetPath")],n);this.setLocalValue("text",t.get(this,"data")[t.get(this,"atomParent.labelPath")],n)};this.t38=function(n){this.bind(n,"items",[["data"],["templateParent","itemsPath"]],0,function(n,t){return n[t]});this.setLocalValue("menuTemplate",t.get(this,"templateParent.menuTemplate"),n);this.setLocalValue("menuDirection","vertical",n)};this.t40=function(n){this.setLocalValue("href",t.get(this,"data")[t.get(this,"templateParent.valuePath")],n);this.setLocalValue("text",t.get(this,"data")[t.get(this,"templateParent.labelPath")],n);this.setLocalValue("target",t.get(this,"data.target"),n);this.setLocalValue("eventClick",t.get(this,"data.action"),n)};this.t41=function(n){this.bind(n,"src",[["templateParent","displayMode"],["templateParent","displayMode"],["templateParent","newUrl"],["templateParent","detailUrl"]],0,function(n,t,i,r){return n==1?t==2?i:r:"about:none"})};this.t42=function(n){this.bind(n,"selectedIndex",["atomParent","displayMode"])};this.t45=function(n){this.bind(n,"data",["templateParent","selectedItem"])};this.t47=function(n){this.bind(n,"eventClick",["templateParent","backCommand"])};this.t48=function(n){this.bind(n,"data",["templateParent","newItemCopy"])};this.t50=function(n){this.bind(n,"eventClick",["templateParent","cancelAddCommand"])};this.t51=function(n){this.bind(n,"checked",["scope","itemSelected"],!0)};this.t52=function(n){this.setLocalValue("text",t.get(this,"data.label"),n)};this.t53=function(n){this.bind(n,"text",["label"])};this.t55=function(n){this.setLocalValue("showTabs","true",n);this.bind(n,"labelPath",["templateParent","labelPath"]);this.bind(n,"items",["templateParent","items"]);this.bind(n,"selectedIndex",["templateParent","selectedIndex"],!0)};this.t56=function(n){this.bind(n,"text",["data"])};this.t57=function(n){this.bind(n,"selectedIndex",["templateParent","selectedIndex"])};this.t58=function(n){this.bind(n,"value",["hours"],!0)};this.t59=function(n){this.bind(n,"value",["minutes"],!0)};this.t60=function(n){this.setLocalValue("items",[{label:"AM",value:"AM"},{label:"PM",value:"PM"}],n);this.bind(n,"value",["templateParent","ap"],!0)};this.t61=function(n){this.setLocalValue("text",t.get(this,"data.label"),n)};this.t62=function(n){this.setLocalValue("text",t.get(this,"data")[t.get(this,"atomParent.labelPath")],n)};this.t63=function(n){this.bind(n,"selectedIndex",["templateParent","currentStep"],!0)};this.t65=function(n){this.bind(n,"isEnabled",["canMoveBack"]);this.setLocalValue("eventClick",t.get(this,"goPrevCommand"),n);this.bind(n,"styleVisibility",[["currentStep"]],0,function(n){return n?"visible":"hidden"})};this.t66=function(n){this.bind(n,"text",["prevLabel"])};this.t67=function(n){this.bind(n,"class",[["nextClass"],["isLastStep"]],0,function(n,t){return n||(t?"finish-button":"")});this.setLocalValue("eventClick",t.get(this,"nextCommand"),n);this.bind(n,"isEnabled",["nextCommand"])};this.t68=function(n){this.bind(n,"text",[["isLastStep"],["finishLabel"],["nextLabel"]],0,function(n,t,i){return n?t:i})};this.t69=function(n){this.bind(n,"value",["templateParent","hasValue"],!0)};this.t70=function(n){this.bind(n,"isEnabled",["hasValue"]);this.bind(n,"placeholder",["placeholder"])};this.t71=function(n){this.bind(n,"styleWidth",[["appWidth"]],0,function(n){return n+"px"});this.bind(n,"styleHeight",[["appHeight"]],0,function(n){return n+"px"});this.bind(n,"styleDisplay",[["isBusy"]],0,function(n){return n?"block":"none"})};this.t72=function(n){this.bind(n,"styleLeft",[["appWidth"]],0,function(n){return n/2-100+"px"});this.bind(n,"styleTop",[["appHeight"]],0,function(n){return n/2-25+"px"})};this.t73=function(n){AtomProperties.absPos(n,"12,12,36,36")};this.t74=function(n){AtomProperties.absPos(n,"56,24,145,null");this.bind(n,"text",[["busyMessage"]],0,function(n){return n||"Loading..."})};this.t75=function(n){AtomProperties.absPos(n,"0,48");this.bind(n,"styleDisplay",[["isBusy"],["progress"]],0,function(n,t){return n&&t?"block":"none"});this.bind(n,"styleWidth",[["progress"]],0,function(n){return n+"%"})};this.t76=function(n){this.setLocalValue("items",t.get(this,"data"),n)};this.t78=function(n){this.setLocalValue("text",t.get(this,"data.label"),n)};this.t79=function(n){this.bind(n,"class",["fieldClass"]);this.bind(n,"styleDisplay",[["fieldVisible"]],0,function(n){return n?"":"none"})};this.t80=function(n){this.bind(n,"text",["label"]);this.bind(n,"styleMinWidth",[["atomParent","minLabelWidth"],["atomParent","minLabelWidth"]],0,function(n,t){return n?t+"px":undefined})};this.t81=function(n){this.bind(n,"class",[["required"]],0,function(n){return n?"atom-form-grid-required":"atom-form-grid-not-required"})};this.t82=function(n){this.bind(n,"class",[["error"]],0,function(n){return n?"atom-data-error":""})};this.t83=function(n){this.bind(n,"class",[["error"]],0,function(n){return n?"atom-data-error":""});this.bind(n,"text",[["error"]],0,function(n){return n||""});this.bind(n,"styleDisplay",[["error"]],0,function(n){return n?"":"none"})};this.t85=function(n){this.bind(n,"text",["label"]);this.bind(n,"styleMinWidth",[["atomParent","minLabelWidth"]],0,function(n){return n||undefined})};this.t86=function(n){this.bind(n,"text",[["required"]],0,function(n){return n?"*":""})};this.t88=function(n){this.bind(n,"text",[["errors"]],0,function(n){return t.csv(n,"label")||""})};this.t90=function(n){this.bind(n,"text",["label"])};this.t91=function(n){this.bind(n,"text",[["required"]],0,function(n){return n?"*":""})};this.t92=function(n){this.bind(n,"class",[["error"]],0,function(n){return n?"atom-data-error":""})};this.t93=function(n){this.bind(n,"text",[["error"]],0,function(n){return n||""})};this.t95=function(n){this.setLocalValue("text",t.get(this,"data.Message"),n)};this.t96=function(n){this.setLocalValue("class",t.get(this,"data.Confirm")?"confirm-buttons":"alert-buttons",n)};this.t97=function(n){this.setLocalValue("eventClick",t.get(this,"templateParent.closeCommand"),n)};this.t98=function(n){this.setLocalValue("eventClick",[{data:{ConfirmValue:!0}},t.get(this,"templateParent.closeCommand")],n)};this.t99=function(n){this.setLocalValue("eventClick",t.get(this,"templateParent.closeCommand"),n)};this.t100=function(n){this.bind(n,"styleWidth",[["appScope","owner","bodyWidth"]],0,function(n){return n+"px"});this.bind(n,"styleHeight",[["appScope","owner","appHeight"]],0,function(n){return n+"px"});this.bind(n,"styleDisplay",[["isOpen"]],0,function(n){return n?"block":"none"})};this.t101=function(n){this.bind(n,"styleWidth",[["atomParent","windowWidth"]],0,function(n){return n+"px"});this.bind(n,"styleHeight",[["atomParent","windowHeight"]],0,function(n){return n+"px"});this.bind(n,"styleLeft",[["appScope","owner","bodyWidth"],["atomParent","windowWidth"]],0,function(n,t){return(n-t)/2+"px"});this.bind(n,"styleTop",[["appScope","owner","bodyHeight"],["atomParent","windowHeight"]],0,function(n,t){return(n-t)/2+"px"})};this.t102=function(n){this.bind(n,"text",["atomParent","title"])};this.t103=function(n){this.setLocalValue("eventClick",t.get(this,"atomParent.cancelCommand"),n)};this.t104=function(n){this.setLocalValue("src",t.get(this,"templateParent.url"),n)}}.call(WebAtoms.PageSetup,n,WebAtoms);s={};n.$x=s;s.stop=function(n,t){return function(){if(n)throw new Error(t);}};s.stopIf=n.stop;s.timeout=function(n,t){return function(){var i=this;setTimeout(function(){i.invokeAction(t)},n)}};s.invoke=function(n,t,i){return function(){var r={},u;i===undefined?(u={},u[t]=i,r[n]=u):r[n]=t;this.invokeAction(r)}};s.data=function(n,t){s.invoke("data",n,t)};s.scope=function(n,t){s.invoke("scope",n,t)};s.localScope=function(n,t){s.invoke("localScope",n,t)};s.appScope=function(n,t){s.invoke("appScope",n,t)};s.owner=function(n,t){s.invoke("owner",n,t)};s.reveal=function(){return function(){}},function(n){var i=function(n){this.a=n;this.i=-1},t,r,u;i.prototype={next:function(){return this.i++,this.i<this.a.length},current:function(){return this.a[this.i]}};t={truef:function(){return!0},falsef:function(){return!1},get:function(n,i){var r,u;if(n)return(r=i.indexOf("."),r===-1)?n[i]:(u=i.substr(0,r),i=i.substr(r+1),t.get(n[u],i))},escapeRegex:function(n,i,r,u){if(!i)return{test:t.falsef};var f=i.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return n&&(f=n+f),r&&(f=f+r),new RegExp(f,u)},compare:function(n,r){var u;switch(n){case"==":case"=":return function(n){return n==r};case"<=":return function(n){return n<=r};case">=":return function(n){return n>=r};case"<":return function(n){return n<r};case">":return function(n){return n>r};case"between":return function(n){return n>=r[0]&&n<=r[1]};case"equals":return r=t.escapeRegex("^",r,"$","i"),function(n){return n?r.test(n):!r};case"contains":return r=t.escapeRegex("",r,"","i"),function(n){return n?r.test(n):!1};case"startswith":return r=t.escapeRegex("^",r,"","i"),function(n){return n?r.test(n):!r};case"endswith":return r=t.escapeRegex("",r,"$","i"),function(n){return n?r.test(n):!r};case"equals":return r=t.escapeRegex("^",r,"$"),function(n){return n?r.test(n):!r};case"containscs":return r=t.escapeRegex("",r,""),function(n){return n?r.test(n):!1};case"startswithcs":return r=t.escapeRegex("^",r,""),function(n){return n?r.test(n):!r};case"endswithcs":return r=t.escapeRegex("",r,"$"),function(n){return n?r.test(n):!r};case"~":return function(n){return r.test(n)};case"in":return function(n){var t,u;if(!n)return!1;for(t=new i(r);t.next();)if(u=t.current(),u==n)return!0;return!1};case"has":return function(n){var t,u;if(!n)return!1;for(t=new i(n);t.next();)if(u=t.current(),u==r)return!0;return!1};case"any":return u=t.filter(r),function(n){var t,r;if(!n)return!1;for(t=new i(n);t.next();)if(r=t.current(),u(r))return!0;return!1};case"all":return u=t.filter(r),function(n){if(!n)return!1;for(var t=new i(n);t.next();)if(!u(item))return!1;return!0};default:return function(){return!1}}},isString:function(n){return typeof n=="string"||n instanceof String},sort:function(n){if(!t.isString(n))return n;var i=n.split(",");return i=i.map(function(n){var t=n.split(" "),i=t[1]||"asc";return{field:t[0],desc:/desc/i.test(i),cs:/^cs/i.test(i)}}),function(n,r){var e,h;if(n==null||n==undefined)return r==null||r==undefined?0:1;if(r==null||r==undefined)return 1;for(e=0;e<i.length;e++){var o=i[e],s=o.field,u=n[s],f=r[s];if(o.desc&&(h=u,u=f,f=h),u!=f){if(!u)return f?-1:0;if(!f)return u?1:0;if(t.isString(u)){if(o.cs)return u.localeCompare(f);if(u=u.toLowerCase(),f=f.toLowerCase(),u==f)continue;return u.localeCompare(f)}}}return 0}},build:function(n,i,r,u,f){var s,a,o,v,e,l,h,c;if(i==="$or"){s=t.filter(r,!0);n.push(function(n){return s(n)});return}if(i==="$and"){s=t.filter(r,!1);n.push(function(n){return s(n)});return}if(i==="$not"){a=t.filter(r,f);n.push(function(n){return!a(n)});return}o=i.split(" ");o.length===1&&(o=i.split(":"));v=o[0];e="==";o.length===2&&(e=o[1]);l=function(n){return t.get(n,v)};e.indexOf("!")!==0?(h=t.compare(e,r),c=function(n){var t=l(n);return h(t)},n.push(c)):(e=e.substr(1),h=t.compare(e,r),c=function(n){var t=l(n);return!h(t)},n.push(c))},filter:function(n,r){var f,u,e;if(n===!1)return t.falsef;if(!n)return t.truef;f=[];for(u in n)n.hasOwnProperty(u)&&(e=n[u],t.build(f,u,e,n,r));return function(n){for(var t=new i(f),e=[],o,u;t.next();)if(o=t.current(),u=o(n),e.push(u),u){if(r)return!0}else if(!r)return!1;for(t=new i(e);t.next();)if(!t.current())return!1;return!0}}};n.$f=t.filter;Array.prototype.filter||(Array.prototype.filter=function(n){for(var i,r=[],t=0;t<this.length;t++)i=this[t],n(i,t)&&r.push(i);return r});r=Array.prototype.filter;Array.prototype.filter=function(n){return n instanceof Function||typeof n=="function"?r.call(this,n):r.call(this,$f(n))};u=Array.prototype.sort;Array.prototype.sort=function(n){var i=t.sort(n);return u.call(this,i)}}(n);c={debug:!1,baseUrl:"",log:"",ajax:{versionUrl:!0,versionKey:"__wav",version:(new Date).toDateString(),headers:{}}};n.AtomConfig=c;w=function(t){n.console&&console.log(t);c.log+=t+"\r\n"};n.log=w;o={browserName:"",version:"1.0",majorVersion:1,isMobile:!1,userAgent:"",detect:function(){var o=navigator.appVersion,n=navigator.userAgent;this.userAgent=n;var r=navigator.appName,i=""+parseFloat(navigator.appVersion),u=parseInt(navigator.appVersion,10),e,t,f;(t=n.indexOf("Opera"))!=-1?(r="Opera",i=n.substring(t+6),(t=n.indexOf("Version"))!=-1&&(i=n.substring(t+8))):(t=n.indexOf("MSIE"))!=-1?(r="Microsoft Internet Explorer",i=n.substring(t+5)):(t=n.indexOf("Chrome"))!=-1?(r="Chrome",i=n.substring(t+7)):(t=n.indexOf("Safari"))!=-1?(r="Safari",this.isMobile=n.indexOf("iPhone")!=-1,i=n.substring(t+7),(t=n.indexOf("Version"))!=-1&&(i=n.substring(t+8))):(t=n.indexOf("Firefox"))!=-1?(r="Firefox",i=n.substring(t+8)):(e=n.lastIndexOf(" ")+1)<(t=n.lastIndexOf("/"))&&(r=n.substring(e,t),i=n.substring(t+1),r.toLowerCase()==r.toUpperCase()&&(r=navigator.appName));(f=i.indexOf(";"))!=-1&&(i=i.substring(0,f));(f=i.indexOf(" "))!=-1&&(i=i.substring(0,f));u=parseInt(""+i,10);isNaN(u)&&(i=""+parseFloat(navigator.appVersion),u=parseInt(navigator.appVersion,10));this.browserName=r;this.majorVersion=u;this.isMobile=/android|mobile|ios|iphone/gi.test(n)},isFF:!1,isChrome:!1,isIE:!1,isSafari:!1,isMac:!1,init:function(){this.isMac=/mac os x/gi.test(this.userAgent)&&!/iphone|ipad/gi.test(this.userAgent);switch(this.browserName){case"Firefox":this.supportsUpload=this.majorVersion>=4;this.isFF=!0;break;case"Chrome":this.supportsUpload=this.majorVersion>=6;this.isChrome=!0;break;case"Microsoft Internet Explorer":this.supportsUpload=this.majorVersion>=10;this.isIE=!0;break;case"Safari":this.isSafari=!0;this.isMobile||(this.supportsUpload=this.majorVersion>=5)}this.supportsFlash=!this.isMobile}};n.AtomBrowser=o;o.detect();o.init();AtomEvaluator={ecache:{},becache:{},parse:function(n){var i=this.becache[n];if(i)return i;var u=[],f=[],e=n.replace(/(?:(\$)(window|appScope|scope|data|owner|localScope))(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*/gi,function(n){var t="v"+(u.length+1);return n=n.indexOf("$owner.")==0?n.substr(7):n.indexOf("owner.")==0?n.substr(6):n.substr(1),u.push(n.split(".")),f.push(t),t}),r="return "+e+";",o=r;try{r=AtomEvaluator.compile(f,r)}catch(s){t.alert("Error executing \n"+o+"\nOriginal: "+n);throw s;}return i={length:f.length,method:r,path:u,original:e},this.becache[n]=i,i},compile:function(n,t){var r=n.join("-")+":"+t,i=this.ecache[r];return i?i:(n.push("Atom"),n.push("AtomPromise"),i=new Function(n,t),this.ecache[r]=i,i)}};n.AtomEvaluator=AtomEvaluator;ChildEnumerator=null;o.isIE&&o.majorVersion<9?(ChildEnumerator=function(n){this.index=-1;this.nextItem=n.firstChild;this.findNext();this.item=null},ChildEnumerator.prototype={findNext:function(){for(var n=this.nextItem;n&&n.nodeType!==1;)n=n.nextSibling;this.nextItem=n;this.index++},isFirst:function(){return this.index===1},isLast:function(){return this.item&&!this.nextItem},next:function(){return(this.item=this.nextItem,!this.item)?!1:(this.nextItem=this.item.nextSibling,this.findNext(),this.item?!0:!1)},current:function(){return this.item}},n.ChildEnumerator=ChildEnumerator):(ChildEnumerator=function(n){this.nextItem=n.firstElementChild;this.item=null;this.first=!0},ChildEnumerator.prototype={isFirst:function(){return!this.item.previousElementSibling},isLast:function(){return this.item&&!this.nextItem},next:function(){return(this.item=this.nextItem,!this.item)?!1:(this.nextItem=this.item.nextElementSibling,this.item?!0:!1)},current:function(){return this.item}},n.ChildEnumerator=ChildEnumerator);i=function(){return classCreator("AtomEnumerator",null,function(n){this._array=n;this.i=-1},{next:function(){return this.i=this.i+1,this.i<this._array.length},current:function(){return this._array[this.i]},currentIndex:function(){return this.i},isFirst:function(){return this.i==0},isLast:function(){return this.i==this._array.length-1},reset:function(){this.i=-1}})}();n.AtomEnumerator=i;t={refreshWindowCommand:function(){location.reload(!0)},time:function(){return(new Date).getTime()},get:function(n,i){var r=i.indexOf("."),u;return r!=-1?(u=i.substr(0,r),n=AtomBinder.getValue(n,u),i=i.substr(r+1),t.get(n,i)):AtomBinder.getValue(n,i)},set:function(n,i,r){var u,f;if(n){if(u=i.indexOf("."),u!=-1)return f=i.substr(0,u),n=AtomBinder.getValue(n,f),i=i.substr(u+1),t.set(n,i,r);AtomBinder.setValue(n,i,r)}},csv:function(n,r,u){var f,e,o;for(u||(u=", "),f=[],e=new i(n);e.next();)o=e.current(),f.push(t.get(o,r));return f.join(u)},range:function(n,t,i){var u=[],r;for(i=i||1,r=n;r<=t;r+=i)u.push({label:r,value:r});return u},merge:function(n,i,r,u){var e,f;if(n){if(e=u?AtomBinder.getClone(i):i,r)for(f in e)t.set(n,f,AtomBinder.getValue(e,f));else for(f in e)n[f]=e[f];return n}},url:function(n,t,i){var e=n,f=[],o,u,r;if(t){for(u in t)if(t.hasOwnProperty(u)){if(r=t[u],r===undefined)continue;if(r===null)continue;r&&r.constructor!=String&&typeof r=="object"&&(r=JSON.stringify(r));f.push(u+"="+encodeURIComponent(r))}f.length&&(o=e.indexOf("?"),e+=o==-1?"?":"&");e+=f.join("&")}if(i){f=[];for(u in i)if(i.hasOwnProperty(u)){if(r=i[u],r===undefined||r===null)continue;f.push(u+"="+encodeURIComponent(r))}f.length&&(e+="#"+f.join("&"))}return e},encodeParameters:function(n){var u=[],i,t,r;for(i in n)i.indexOf("_")!=0&&(t=n[i],t!==undefined)&&t!==null&&(r=typeof t,r=="string"||r=="number"||r=="boolean")&&u.push(i+"="+encodeURIComponent(t));return u.join("&")},tableLayout:function(n,t,i){return new WebAtoms.AtomTableLayout(n,t,i)},toDash:function(n){return n.replace(/([A-Z])/g,function(n){return"-"+n.toLowerCase()})},secureUrl:function(){for(var t,n="",i=0;i<arguments.length;i++){if(t=arguments[i],t===null||t===undefined)return undefined;n+=t}return/^\/\//.test(n)?u.location.protocol+n:("https:"==u.location.protocol&&(n=n.replace(/http\:\/\//,"https://")),n)}};t.resolve=function(n,u){var h=!u,c,e,f,o,s;if(!n)return n;if(h&&(u=new r,u.list=[],u.done=function(i){t.remove(u.list,i);u.list.length==0&&u.pushValue(n)}),c=typeof n,c=="object")if(typeof n.length!="undefined"){for(e=0;e<n.length;e++)if(f=n[e],f){if(o=n,s=e,f instanceof r||f.constructor==r){u.list.push(f);f.failed(function(n){u.done(n)});f.then(function(n){o[s]=n.value();u.done(n)});continue}t.resolve(f,u)}}else for(e in n)if(f=n[e],f){if(f instanceof r||f.constructor==r){u.list.push(f);f.failed(function(n){u.done(n)});o=n;s=e;f.then(function(n){o[s]=n.value();u.done(n)});continue}t.resolve(f,u)}if(u.list.length){if(h)u.onInvoke(function(){for(var n=new i(u.list);n.next();)n.current().invoke(u._invoker)});return u}return n};n.Atom=t,function(){for(var i,f=/\+/g,e=/([^&=]+)=?([^&]*)/g,r=function(n){return decodeURIComponent(n.replace(f," "))},o=n.location.search.substring(1),u={};i=e.exec(o);)u[r(i[1])]=r(i[2]);t.pageQuery=u}();f={zoneOffsetMinutes:(new Date).getTimezoneOffset(),zoneOffset:(new Date).getTimezoneOffset()*6e4,toLocalTime:function(n){return n.toJSON()},m_names:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],setTime:function(n,t){var i,r,f,u;return!n||!t?n:(i=t.split(":"),r=parseInt(i[0]),i=i[1].split(" "),f=parseInt(i[0]),i[1]=="PM"&&r!=12&&(r+=12),u=new Date(n.getFullYear(),n.getMonth(),n.getDate()),u.setHours(r),u.setMinutes(f),u)},toMMDDYY:function(n){var t=n.getMonth()+1,u=n.getFullYear(),i=n.getDate(),r="";return r+=t>9?t:"0"+t,r+="/"+(i>9?i:"0"+i),r+("/"+u)},toShortDateString:function(n){if(!n)return"";if(n.constructor==String)if(/^\/date\(/gi.test(n))n=n.substr(6),n=new Date(parseInt(n,10));else throw new Error("Invalid date format "+n);return this.m_names[n.getMonth()]+" "+n.getDate()+", "+n.getFullYear()},toDateTimeString:function(n){if(!n)return"";n.constructor==String&&(n=n.substr(6),n=new Date(parseInt(n,10)));var t=f.toShortDateString(n);return t+" - "+f.toTimeString(n)},toTimeString:function(n){var i,r,t;return(n=f.parse(n),!n)?"":(i=n.getHours(),r="AM",i==12?r="PM":i>12&&(i=i-12,r="PM"),t=n.getMinutes(),t<10?t="0"+t:(t=t+"",t.length==1&&(t=t+"0")),i+":"+t+" "+r)},smartDate:function(n){var t,i,r;if(!n)return null;if(t=f.parse(n),i=new Date,i.getFullYear()===t.getFullYear()&&i.getMonth()===t.getMonth()){r=i.getDate()-t.getDate();switch(r){case-1:return"Tomorrow ("+f.toTimeString(t)+")";case 0:return"Today ("+f.toTimeString(t)+")";case 1:return"Yesterday ("+f.toTimeString(t)+")"}}return f.toDateTimeString(t)},smartDateUTC:function(n){return f.smartDate(n)},jsonDate:function(n){var t=f.parse(n);return{Year:t.getFullYear(),Month:t.getMonth()+1,Date:t.getDate(),Hours:t.getHours(),Minutes:t.getMinutes(),Seconds:t.getSeconds(),Offset:f.zoneOffsetMinutes}},toUTC:function(n){if(!n)return"";n=f.parse(n);return new Date(n.getTime()+f.zoneOffset)},parse:function(n){var u;if(!n)return null;if(n.constructor!==String)return n;if(/^\/date\([\-0-9]+\)\//gi.test(n))n=new Date(parseInt(n.substr(6),10));else{if(/^\/dateiso/gi.test(n)){n=n.substr(9);n=n.substr(0,n.length-1);var r=n.split("T"),t=r[0],i=r[1];return t=t.split("-"),i=i.split(":"),u=new Date(t[0],parseInt(t[1])-1,t[2],i[0],i[1],parseFloat(i[2])),new Date(u.getTime()+f.zoneOffset)}n=Date.parse(n)}return n}};n.AtomDate=f;f.monthList=[{label:"January",value:1},{label:"February",value:2},{label:"March",value:3},{label:"April",value:4},{label:"May",value:5},{label:"June",value:6},{label:"July",value:7},{label:"August",value:8},{label:"September",value:9},{label:"October",value:10},{label:"November",value:11},{label:"December",value:12}];it={toFileSize:function(n){return n?(n.constructor==String&&(n=parseInt(n,10)),n>1073741824)?Math.round(n/1073741824)+" GB":n>1048576?Math.round(n/1048576)+" MB":n>1024?Math.round(n/1024)+" KB":n+" B":""}};n.AtomFileSize=it;rt={toSmallPhoneString:function(n){var t,i;if(!n)return"";t=n.split(":",6);i=t[2];i="("+(/^\+/.test(i)?"":"+")+t[2]+") ";var r=t[3],u=t[4],f=t[5];return r?i+r:""},toPhoneString:function(n){var i;if(!n)return"";var t=n.split(":",6),e="(+"+t[2]+") ",r=t[3],u=t[4],f=t[5];return r?(i=e+r,u&&(i+=" (ext: "+u+")"),f&&(i+=" ("+f+")"),i):""}};n.AtomPhone=rt;$f.get=t.get;$f.compileSelect=function(n){return n?n.constructor==String?function(i){return t.get(i,n)}:function(i){var f={},r,u;for(r in n)u=n[r],r=JSON.stringify(r),f[r]=u?t.get(i,u):t.get(i,r);return f}:function(n){return n}};d={firstOrDefault:function(n){for(var i=$f(n),t;this.next();)if(t=this.current(),i(t))return t;return null},first:function(n){for(var i=$f(n),t;this.next();)if(t=this.current(),i(t))return t;throw new Error("Item not found in collection");},where:function(n){for(var u=$f(n),r=[],t;this.next();)t=this.current(),u(t)&&r.push(t);return new i(r)},toArray:function(){for(var n=[];this.next();)n.push(this.current());return n},any:function(n){return this.firstOrDefault(n)?!0:!1},select:function(n){for(var u=$f.compileSelect(n),t=[],r;this.next();)r=this.current(),t.push(u(r));return new i(t)},join:function(n){for(var t=[];this.next();)t.push(this.current());return t.join(n)},count:function(n){if(n)return this.where(n).count();for(var t=0;this.next();)t++;return t},sum:function(n){for(var r=0,u=this,i;u.next();)i=u.current(),n&&(i=t.get(i,n)),r+=+(i||0);return r},groupBy:function(n){for(var s=$f.compileSelect(n),u=this,f={},e=[];u.next();){var o=u.current(),r=s(o),i=f[r];i||(i=[],f[r]=i,e.push({key:r,items:i}));i.push(o)}return t.query(e)}};n.AtomQuery=d;for(g in d)i.prototype[g]=d[g];t.query=function(n){return n.length!==undefined?new i(n):n};AtomUI={nodeValue:o.isIE&&o.majorVersion<9?"nodeValue":"value",attributeMap:function(n,t){var u,r,f={},e=new i(n.attributes);if(t){while(e.next())u=e.current(),r=u.nodeName,/^data\-/i.test(r)&&(r=r.substr(5)),t.test(r)&&(t.lastIndex=0,f[r]={value:u[AtomUI.nodeValue],node:u});return f}while(e.next())u=e.current(),r=u.nodeName,/^data\-/i.test(r)&&(r=r.substr(5)),f[r]={value:u[AtomUI.nodeValue],node:u};return f},attr:function(n,t,i){if(i!==undefined)return/^(atom|style)\-/.test(t)&&(t="data-"+t),n.setAttribute(t,i),i;return n.getAttribute("data-"+t)||n.getAttribute(t)},removeAttr:function(n,t){n.removeAttribute(t);n.removeAttribute("data-"+t)},getAtomType:function(n){return AtomUI.attr(n,"atom-type")},cloneNode:o.isIE&&o.majorVersion<8?function(t){for(var o=n.document,u=o.createElement(t.nodeName),s=new i(t.attributes),f,h,e,r,c;s.next();){f=s.current();try{if(h=f.nodeName,e=f[AtomUI.nodeValue],!e)continue;u.setAttribute(h,e)}catch(l){}}for(r=t.firstChild;r;)r.nodeType==3?(c=o.createTextNode(r.nodeValue),u.appendChild(c)):r.nodeType==1&&u.appendChild(AtomUI.cloneNode(r)),r=r.nextSibling;return u}:function(n){return n.cloneNode(!0)},findPresenter:function(n){for(var r=new ChildEnumerator(n),t,u,i;r.next();){if(t=r.current(),u=AtomUI.attr(t,"atom-presenter"),u)return t;if(i=AtomUI.findPresenter(t),i)return i}return null},parseUrl:function(n){for(var r={},e=n.split("&"),u=new i(e);u.next();){var f=u.current().split("="),o=f[0],t=f[1];t&&(t=decodeURIComponent(t));t=AtomUI.parseValue(t);r[o]=t}return r},parseValue:function(n){var t;return/^[0-9]+$/.test(n)?(t=parseInt(n,10),isNaN(t)||(n=t),n):/^[0-9]+\.[0-9]+/gi.test(n)?(t=parseFloat(n),isNaN(t)||(n=t),n):/true/.test(n)?!0:/false/.test(n)?!1:n},cancelEvent:function(n){var t=n.target;if(!t||!/input/gi.test(t.nodeName)||!/checkbox/gi.test(t.type))return n.preventDefault?n.preventDefault():n.stop(),n.returnValue=!1,n.stopPropagation(),!1},assignID:function(n){return n.id||(n.id="__waID"+AtomUI.getNewIndex()),n.id},atomParent:function(t){return t.atomControl?t.atomControl:t===u||t===n||!t.parentNode?null:AtomUI.atomParent(t._logicalParent||t.parentNode)},toNumber:function(n){return n?n.constructor==String?parseFloat(n):n:0},isNode:function(t){try{if(n.XMLHttpRequest&&t instanceof XMLHttpRequest)return!0}catch(i){}return t===n||t===u?!0:typeof Node=="object"?t instanceof Node:typeof t=="object"&&typeof t.nodeType=="number"&&typeof t.nodeName=="string"},createDelegate:function(n,t){return this.getDelegate(n,t,!0)},getDelegate:function(n,t,i){var r,u,f;if(t&&t.constructor!=String)throw new Error("methodName has to be string");if(r=n.__delegates,!r){if(!i)return null;r={};n.__delegates=r}if(u=r[t],!u){if(!i)return null;if(f=n[t],!f)throw new Error("method "+t+" not found");u=function(){return f.apply(n,arguments)};r[t]=u}return u},__index:1e3,getNewIndex:function(){return this.__index=this.__index+1,this.__index},contains:function(n,t){for(var r=n.length,i=0,i=0;i<r;i++)if(n[i]==t)return!0;return!1},removeAllChildren:function(n){while(n.hasChildNodes()){var t=n.lastChild;if(!t)break;t.atomControl&&(t.atomControl.dispose(),delete t.atomControl);$(t).remove()}},isWebkit:function(){return n.navigator.userAgent.toLowerCase().indexOf("webkit")==-1?!1:!0},isWeirdControl:function(n){return n.nodeName=="BUTTON"||n.nodeName=="SELECT"||n.nodeName=="INPUT"&&n.getAttribute("type")=="submit"},parseCSS:function(n,t){var i=parseInt($(n).css(t),10);return isNaN(i)?0:i},setItemRect:function(n,t){var i=this.isWeirdControl(n);t.width&&(t.width-=this.parseCSS(n,"marginLeft")+this.parseCSS(n,"marginRight"),i||(t.width-=this.parseCSS(n,"borderLeftWidth")+this.parseCSS(n,"borderRightWidth"),t.width-=this.parseCSS(n,"paddingLeft")+this.parseCSS(n,"paddingRight")),t.width<0&&(t.width=0),n.style.width=t.width+"px");t.height&&(t.height-=this.parseCSS(n,"marginTop")+this.parseCSS(n,"marginBottom"),i||(t.height-=this.parseCSS(n,"borderTopWidth")+this.parseCSS(n,"borderBottomWidth"),t.height-=this.parseCSS(n,"paddingTop")+this.parseCSS(n,"paddingBottom")),t.height<0&&(t.height=0),n.style.height=t.height+"px");t.left&&(n.style.left=t.left+"px");t.top&&(n.style.top=t.top+"px")},getPresenterOwner:function(n,t){var r,u;if(n._presenters)for(r=new i(n._presenters);r.next();)if(u=r.current(),u==t)return n;return this.getPresenterOwner(n.get_atomParent(),t)},createCss:function(n){var t,i,r;if(!n)return"";if(n.constructor==String)return n;t=[];for(i in n)(r=n[i],r)&&t.push(i);return t.join(" ")},createControl:function(n,t,i,r){if(!n.atomControl){if(t?t.constructor==String&&(t=WebAtoms[t]):(t=AtomUI.getAtomType(n),t=WebAtoms[t]),t){var u=new t(n);return i&&(u._data=i),r&&(u._scope=r),u.createChildren(),i&&u.init(),u}return null}}};n.AtomUI=AtomUI;AtomUI.isIE7=n.navigator.userAgent.indexOf("MSIE 7.0")!=-1;AtomUI.isIE8=n.navigator.userAgent.indexOf("MSIE 8.0")!=-1;n.AtomUri=function(n){var i,u="",e="",t=n.split("?");i=t[0];t.length==2?(u=t[1]||"",t=u.split("#"),u=t[0],e=t[1]||""):(t=i.split("#"),i=t[0],e=t[1]||"");var o=location.protocol,f=location.host,s=location.port,r=i.indexOf("//");r!==-1&&(o=i.substr(0,r),i=i.substr(r+2),r=i.indexOf("/"),r!==-1&&(f=i.substr(0,r),i=i.substr(r+1),t=f.split(":"),t.length>1&&(f=t[0],s=t[1])));this.host=f;this.protocol=o;this.port=s;this.path=i;this.query=AtomUI.parseUrl(u);this.hash=AtomUI.parseUrl(e)};a={stack:[],startOrder:2e3,show:function(n,t,i,r){if(t.style.zOrder=this.startOrder++,i==0){var u=$(n).offset();t.style.position="absolute";t.style.left=u.left+"px";t.style.top=u.top+$(n).outerHeight(!0)+"px"}t.style.visibility="visible";this.stack.push({parent:n,element:t,removeHandler:r})},peek:function(){var n=null;return this.stack.length>0&&(n=this.stack[this.stack.length-1]),n},hide:function(n){var i=this.peek(),t;i&&i.element===n&&(n.style.visibility="hidden",t=this.stack.pop(),t.removeHandler&&t.removeHandler(t.element))},clicked:function(n){var i=n.target,t=a.peek();if(t){while(i&&i!=t.element&&i!=t.parent)i=i.parentNode;i!=t.element&&i!=t.parent&&(t.element.style.visibility="hidden",this.stack.pop(),t.removeHandler&&t.removeHandler(t.element))}}};n.AtomPopup=a;n.simulateParentClick=function(){var n=null,t;try{n=frameElement}catch(i){return}n&&parent&&(t=parent.$,t(frameElement).click(),n.simulateParentClick&&n.simulateParentClick())};$(n).click(function(t){a.clicked(t);n.simulateParentClick()});Array.prototype.enumerator=function(){return new i(this)};Array.prototype.indexOf||(Array.prototype.indexOf=function(n){for(var t=0,t=0;t<this.length;t++)if(n==this[t])return t;return-1});y={split:function(n,t){t&&t.constructor==String&&(t=$.trim(t));for(var e=n.split(t),u=[],f=new i(e),r;f.next();)r=f.current(),r&&r.constructor==String&&(r=$.trim(r)),u.push(r);return u},getValues:function(n,t){var f,r=n,u;if(t)for(r=[],u=new i(n);u.next();)f=u.current(),r.push(f[t]);return r},intersect:function(n,t,r){for(var f=[],e=new i(r),o,u;e.next();)o=e.current(),u=this.getMatch(n,t,o),u!=undefined&&f.push(u);return f},getMatch:function(n,t,r){for(var e=new i(n),u,f;e.next();)if(u=e.current(),f=u,t&&(f=u[t]),f==r)return u},remove:function(n,t){for(var r=new i(n),u;r.next();)if(u=r.current(),u==t){n.splice(r.currentIndex(),1);return}}};n.AtomArray=y;p=function(){return classCreator("WebAtoms.AtomScope",null,function(n,t,i){this.owner=n;this.parent=t;i&&(this.__application=i);this.__application==this.owner&&(this._v=0,this.refreshCommand=function(){appScope._v=appScope._v+1;AtomBinder.refreshValue(appScope,"_v")});this._refreshValue=function(n){AtomBinder.refreshValue(this,n);this.__application===this.owner&&this.__application._onRefreshValue(this,n)}},{setValue:function(n,t,i){if(AtomBinder.getValue(this,n)==t){i&&this._refreshValue(n);return}var r=this["set_"+n];r?r.apply(this,[t]):this[n]=t;this._refreshValue(n)}})}();AtomBinder={getClone:function(n){var r={},i,t,u;if(typeof n=="object"){typeof n.length!="undefined"&&(r=[]);for(i in n)if(t=n[i],t!==undefined){if(t===null){r[i]=null;continue}/^\_\$\_/gi.test(i)||(u=typeof t,u=="object"?r[i]=t.constructor==Date?"/DateISO("+f.toLocalTime(t)+")/":AtomBinder.getClone(t):u=="string"?r[i]=t:u=="number"?r[i]=t:u=="boolean"?r[i]=t==!0?!0:!1:u=="date"&&(r[i]=t.getTime()))}}return r},setValue:function(n,t,i){var r,u;(n||i!==undefined)&&(r=AtomBinder.getValue(n,t),r!==i)&&(u=n["set_"+t],u?u.apply(n,[i]):n[t]=i,AtomBinder.refreshValue(n,t,r,i))},refreshValue:function(n,t){var r=AtomBinder.get_WatchHandler(n,t),u,f;if(r!=undefined&&r!=null){for(u=new i(r);u.next();)f=u.current(),f(n,t);n._$_watcher&&n._$_watcher._onRefreshValue(n,t)}},getValue:function(n,t){if(n==null)return null;var i=n["get_"+t];return i?i.apply(n):n[t]},add_WatchHandler:function(n,t,i){if(n!=null){var r=AtomBinder.get_WatchHandler(n,t);r.push(i)}},get_WatchHandler:function(n,t){var i,r;return n==null?null:(i=n._$_handlers,i||(i={},n._$_handlers=i),r=i[t],(r==undefined||r==null)&&(r=[],i[t]=r),r)},remove_WatchHandler:function(n,t,r){var u,f;if(n!=null&&n._$_handlers!==undefined&&n._$_handlers!==null&&(u=n._$_handlers[t],u!=undefined&&u!=null))for(f=new i(u);f.next();)if(f.current()==r){u.splice(f.currentIndex(),1);return}},invokeItemsEvent:function(n,t,r,u){var e=AtomBinder.get_WatchHandler(n,"_items"),f,o;if(e){for(f=new i(e);f.next();)o=f.current(),o(t,r,u);n._$_watcher&&n._$_watcher._onRefreshItems(n,t,r,u);AtomBinder.refreshValue(n,"length")}},clear:function(n){n.length=0;AtomBinder.invokeItemsEvent(n,"refresh",0,null)},addItem:function(n,t){var i=n.length;n.push(t);AtomBinder.invokeItemsEvent(n,"add",i,t)},insertItem:function(n,t,i){n.splice(t,0,i);AtomBinder.invokeItemsEvent(n,"add",t,i)},addItems:function(n,t){for(var r=new i(t);r.next();)AtomBinder.addItem(n,r.current())},removeItem:function(n,t){var i=n.indexOf(t);i!=-1&&(n.splice(i,1),AtomBinder.invokeItemsEvent(n,"remove",i,t))},removeAtIndex:function(n,t){if(t!=-1){var i=n[t];n.splice(t,1);AtomBinder.invokeItemsEvent(n,"remove",t,i)}},refreshItems:function(n){AtomBinder.invokeItemsEvent(n,"refresh",-1,null)},add_CollectionChanged:function(n,t){if(n!=null){var i=AtomBinder.get_WatchHandler(n,"_items");i.push(t)}},remove_CollectionChanged:function(n,t){var f,r,u;if(n!=null&&n._$_handlers&&(f="_items",r=n._$_handlers[f],r!=undefined&&r!=null))for(u=new i(r);u.next();)if(u.current()==t){r.splice(u.currentIndex(),1);return}},setError:function(n,t,i){var r=AtomBinder.getValue(n,"__errors");r||AtomBinder.setValue(n,"__errors",{});AtomBinder.setValue(r,t,i)}};n.AtomBinder=AtomBinder;t.clone=AtomBinder.getClone;t.add=AtomBinder.addItem;t.insert=AtomBinder.insertItem;t.remove=AtomBinder.removeItem;t.refresh=AtomBinder.refreshValue;t.refreshArray=AtomBinder.refreshItems;t.clearArray=AtomBinder.clear,function(){return classCreator("WebAtoms.AtomComponent",null,function(){this._eventHandlers=[]},{bindEvent:function(n,t,i,r,u){var e,f;n!=null&&(typeof i=="function"&&(u=i),u=u||AtomUI.createDelegate(this,i),e={element:n,name:t,methodName:i,handler:u},r&&(e.key=r),AtomUI.isNode(n)?$(n).bind(t,null,u):n.addEventListener?n.addEventListener(t,u,!1):(f=n["add_"+t],f==null?(f=AtomBinder["add_"+t],r?f.apply(AtomBinder,[n,r,u]):f.apply(AtomBinder,[n,u])):f.apply(n,[u])),this._eventHandlers.push(e))},unbindEvent:function(n,t,r,u){for(var o=new i(this._eventHandlers),s=[],e,f;o.next();)(f=o.current(),n&&n!==f.element)||t&&t!==f.name||r&&r!==f.methodName||u&&u!==f.key||(AtomUI.isNode(f.element)?$(f.element).unbind(f.name,f.handler):f.element.removeEventListener?f.element.removeEventListener(t,f.handler,!1):(e=f.element["remove_"+f.name],e==null?(e=AtomBinder["remove_"+f.name],f.key?e.apply(AtomBinder,[f.element,f.key,f.handler]):e.apply(AtomBinder,[f.element,f.handler])):e.apply(f.element,[f.handler])),s.push(f));if(s.length==this._eventHandlers.length)this._eventHandlers.length=0;else for(o=new i(s);o.next();)f=o.current(),y.remove(this._eventHandlers,f)},init:function(){},dispose:function(){this.unbindEvent(null,null,null);this.__delegates&&(this.__delegates=null)}})}();r=function(){this._success=[];this._failed=[];this._cached=!1;this._process=null;this._calls=0;this._showProgress=!0;this._showError=!0;var n=this;this.success=function(){n.onSuccess.apply(n,arguments)};this.error=function(){n.onError.apply(n,arguments)}};n.AtomPromise=r;r.prototype={onSuccess:function(n){var i,t;for(this._value=n,this._process&&(this._value=this._process(this._value)),i=this._success,t=0;t<i.length;t++)i[t](this)},onError:function(){var t,n;for(this.errors=arguments,t=this._failed,n=0;n<t.length;n++)t[n](this)},then:function(n){return this._success.push(n),this},process:function(n){return this._process=n,this},failed:function(n){return this._failed.push(n),this},value:function(n){if(n!==undefined){this._value=n;return}return this._value},onInvoke:function(n){return this._invoke=n,this},invoke:function(){if(!this._persist)return this.invokePromise(),this;var n=this;return this.promiseTimeout=setTimeout(function(){n.invokePromise()},100),this},invokePromise:function(){if(this.promiseTimeout=null,this._showProgress&&(atomApplication.setBusy(!0),this._calls===0)){var n=function(){atomApplication.setBusy(!1)};this.then(n);this.failed(n)}return this._calls++,this._invoke(this),this},pushValue:function(n){var t=this;this._cached=!0;setTimeout(function(){t.onSuccess.apply(t,[n])},1)},showProgress:function(n){return this._showProgress=n,this},showError:function(n){return this._showError=n,this},persist:function(n){return this._persist=n===undefined?!0:n,this},abort:function(){if(this.promiseTimeout){clearTimeout(this.promiseTimeout);this.promiseTimeout=null;return}this._failed.length=0;this._success.length=0;this._showProgress&&atomApplication.setBusy(!1);this.handle&&this.handle.abort()}};r.getUrl=function(n){var t=location.href,i=t.indexOf("#");return i!==-1&&(t=t.substr(0,i)),n?(i=t.lastIndexOf("/"),i!==-1&&(t=t.substr(0,i+1)),/^(http|https)\:\/\//gi.test(n))?n:/^\//gi.test(n)?n:/^\./gi.test(n)?(n=n.substr(1),/\/$/gi.test(t)&&/^\//gi.test(n)&&(n=n.substr(1)),t+n):t+n:t};r.parseDates=function(n){var e,t,i,u;if(!n)return n;if(e=typeof n,e==="object"){if(typeof n.length!="undefined"){for(t=0;t<n.length;t++)n[t]=r.parseDates(n[t]);return n}for(i in n)(u=n[i],u)&&(n[i]=r.parseDates(u))}return(typeof n=="string"||n.constructor===String)&&/^\/date\(/gi.test(n)&&/\)\/$/gi.test(n)?f.parse(n):n};r.ajax=function(n,u,f){var e=new r,k,a,v,y,o,l,d,p,g,b,nt,s,h;if(f||(f={type:"GET",dataType:"text",data:null}),c.ajax.versionUrl&&f.versionUrl!==undefined&&f.versionUrl&&(u=u||{},u[c.ajax.versionKey]=c.ajax.version),f.success=e.success,f.error=e.error,f.cache===undefined&&(f.cache=!1),k=n,a=c.ajax.headers,a){f.headers||(f.headers={});for(s in a)h=a[s],f.headers[s]=h,c.debug&&w("Header set: "+s+"="+h)}if(v=c.ajax.statusCode,v){y=f.statusCode||{};for(s in v)h=v[s],y[s]||(y[s]=h);f.statusCode=y}if(o=f,l=o.data,l&&(o.data=AtomBinder.getClone(l)),d=c.ajax.jsonPostEncode,d?o=d(o):o.data={formModel:JSON.stringify(o.data)},p=o.attachments,p&&p.length){for(g=new FormData,b=new i(p);b.next();)g.append("file"+b.currentIndex(),b.current());if(l)for(s in l)g.append(s,l[s]);o.type="POST";o.xhr=function(){var n=$.ajaxSettings.xhr();return n.upload&&n.upload.addEventListener("progress",function(n){if(n.lengthComputable){var t=Math.round(n.loaded*100/n.total);AtomBinder.setValue(atomApplication,"progress",t)}},!1),n};o.cache=!1;o.contentType=!1;o.processData=!1}if(u){if(nt={},!o.sendRawQueryString)for(s in u){if(h=u[s],h&&typeof h=="object"){if(h=JSON.stringify(AtomBinder.getClone(h)),h===undefined)continue;if(h===null)continue}nt[s]=h}k=t.url(n,nt)}if(n)e.onInvoke(function(){e.handle=$.ajax(k,o)});return e.failed(function(){var n=e.errors[0].responseText;n&&e.errors[2]==="Internal Server Error"||(n=e.errors[2]);e.error={msg:n};e._showError&&e.error.msg&&t.alert(e.error.msg)}),e.then(function(n){var t=n.value();t=r.parseDates(t);t&&t.items&&t.merge&&(t.items.total=t.total,t=t.items,n.value(t))}),e.showError(!0),e.showProgress(!0),e};r.get=function(n,t,i){return i=i||{},i.type=i.type||"get",i.dataType=i.dataType||"text",r.ajax(n,t,i,"get")};r.plugins={};r.json=function(n,t,i){var u,f,e;return i=i||{},i.type=i.type||"get",i.dataType=i.dataType||"json",u=null,f=n.indexOf("://"),f!==-1&&(e=n.substr(0,f),/http|https/i.test(e)||(n=n.substr(f+3),u=r.plugins[e])),u=u||r.ajax,u(n,t,i,"json")};r.cache={};r.cacheInProgress={};r.cachedPromise=function(t,i){var u=r.cache[t];if(!u&&n.sessionStorage&&(u=n.sessionStorage["__AP"+t],u&&(u=JSON.parse(u),r.cache[t]=u)),u){i.onInvoke(function(){i.pushValue(u)});return i}return i.then(function(i){r.cache[t]=i.value();n.sessionStorage&&(n.sessionStorage["__AP"+t]=JSON.stringify(i.value()))}),i};r.cachedJson=function(n,t,i){var o=new Date,e=c.ajax.version,u=c.ajax.versionKey+"="+e,f;return n.indexOf("?")===-1?u="?"+u:/\&$/.test(n)||(u="&"+u),n+=u,i=i||{},i.cache=!0,i.ifModified=!0,i.versionUrl=!1,f=r.ajax(n,t,i,"json"),r.cachedPromise(n,f)};r.configCache={};r.configLabel=function(n,t,u){var f;if(t===null||t===undefined)return"";u=u||{};var s=u.valuePath||"value",e=u.labelPath||"label",o=u.isNumber||!1;o&&typeof t!="number"&&(t=parseFloat(t));f=new r;f.onInvoke(function(){var u=r.configCache[n],h;if(u){u=u[t];u=u?u[e]:"";f.pushValue(u);return}h=r.cachedJson(n);h.then(function(u){for(var c="",h={},a=new i(u.value()),l;a.next();)l=a.current(),c=l[s],o&&typeof c!="number"&&(c=parseFloat(c)),h[c]=l;r.configCache[n]=h;h=h[t];h=h?h[e]:"";f.pushValue(h)});h.invoke()});return f};r.prototype.insertItem=function(n,t,i){return this.then(function(r){var u=r.value();u._$_itemInserted||(i&&(u=u[i]),n===-1?u.push(t):u.splice(n||0,0,t),u._$_itemInserted=!0)})};ut={list:function(){},add:function(){},remove:function(){},clear:function(){},set:function(){},get:function(){}};r.plugins["local-storage"]=function(n,t,i){var u=n.split("/"),e=u[0],o=u[1],f=new r;f.onInvoke(function(n){var r=ut,u=r[o](e,t,i.data);n.pushValue(u)});return f},function(n){return classCreatorEx({name:"WebAtoms.AtomBinding",base:n,start:function(n,t,r,u,f,e,o,s){var c,l,a,h;if(this.element=t,this.control=n,this.vf=o,this.key=r,this.events=s,$.isArray(u)){for(this.pathList=[],this.path=[],h=new i(u);h.next();){if(c=h.current(),!$.isArray(c)){this.path.push({path:c,value:null});continue}for(l=new i(c),a=[];l.next();)a.push({path:l.current(),value:null});this.pathList.push(a)}this.path.length?this.pathList=null:this.path=null}else for(h=new i(u.split(".")),this.path=[];h.next();)this.path.push({path:h.current(),value:null});this.twoWays=f;this.jq=e;this._isUpdating=!1},methods:{onPropChanged:function(){var n;if(this.path!=null&&this.path.length!=0){for(var u=new i(this.path),t=this.control,r=null;u.next();){if(r=u.current(),r.value=t,!t)return;u.isLast()||(t=AtomBinder.getValue(t,r.path))}if(n=null,this.jq)switch(this.key){case"valueAsDate":n=this.element.valueAsDate;break;case"checked":n=this.element.checked?!0:!1;break;default:n=$(this.element).val()}else n=AtomBinder.getValue(this.control,this.key);AtomBinder.setValue(t,r.path,n)}},onDataChanged:function(){var t,r,u,n;if(!this._isUpdating&&arguments!==undefined&&arguments.length!=0)if(r=this.control,this.pathList){for(n=[],t=new i(this.pathList);t.next();)n.push(this.evaluate(r,t.current()));for(t=new i(n);t.next();)if(t.current()===undefined)return;this.setValue(n)}else u=this.path,n=this.evaluate(r,u),n!==undefined&&this.setValue(n)},evaluate:function(n,t){for(var u=null,r=null,f=new i(t),e;n&&f.next();)r=f.current(),u=AtomBinder.getValue(n,r.path),/scope|appScope|atomParent|templateParent|localScope/gi.test(r.path)||(e=this,r.value?r.value!=n&&(this.unbindEvent(r.value,"WatchHandler",null,r.path),this.bindEvent(n,"WatchHandler","onDataChanged",r.path)):this.bindEvent(n,"WatchHandler","onDataChanged",r.path)),r.value=n,n=u;return u===undefined&&c.debug&&w("Undefined:"+this.control._element.id+" -> "+$.map(t,function(n){return n.path}).join(".")),u},onValChanged:function(){var n=this;WebAtoms.dispatcher.callLater(function(){n.onPropChanged(null,null)})},setup:function(){if(this.twoWays)if(this.jq){if(this.bindEvent(this.element,"change","onValChanged"),this.bindEvent(this.element,"blur","onValChanged"),this.events)for(var n=new i(this.events.split(","));n.next();)this.bindEvent(this.element,n.current(),"onValChanged")}else this.bindEvent(this.control,"WatchHandler","onPropChanged",this.key);this.onDataChanged(this,null)},setValue:function(n){!this.pathList&&this.vf&&(n=[n]);this.vf&&(n.push(t),n.push(r),n=this.vf.apply(this,n));n instanceof r&&(n._persist=!0);this._lastValue=n;this._isUpdating=!0;this.control.setLocalValue(this.key,n,this.element,!0);this._isUpdating=!1}}})}(WebAtoms.AtomComponent.prototype);b={};n.allControls=b,function(t){return classCreator("WebAtoms.AtomDispatcher",t,function(){this._paused=!1;this.queue=[];this.onTimeout=function(){var t,i;if(!this._paused){if(this.queue.length==0){t=atomApplication._element;(t.style.visibility=="hidden"||$(t).css("visibility")=="hidden")&&(t.style.visibility="visible",t.atomControl.updateUI());return}i=this.queue.shift();i();n.setTimeout(this._onTimeout,1)}};var t=this;this._onTimeout=function(){t.onTimeout()}},{pause:function(){this._paused=!0},start:function(){this._paused=!1;n.setTimeout(this._onTimeout,1)},callLater:function(n){this.queue.push(n);this._paused||this.start()},setupControls:function(){var n=$("[data-atom-type],[atom-type]").first()[0],t,i;(n.atomControl==undefined||n.atomControl==null)&&(t=AtomUI.getAtomType(n),$(n).removeAttr("atom-type"),$(n).removeAttr("data-atom-type"),i=new WebAtoms[t](n),i.setup())}})}();WebAtoms.dispatcher=new WebAtoms.AtomDispatcher;ft=function(n){this.value=n;this.list={};this.errors=[];this.set=function(n,t){this.list[n]=t;this.errors=null};this.reset=function(){this.errors=null;this.invoke(!0)};this.clear=function(){this.errors=[]};this.invoke=function(n){var i,r,t;if(!n&&this.errors)return this.errors;i=[];for(r in this.list)(t=this.list[r],t)&&(t=t(),t&&i.push(t));return i.length?(this.errors=i,this.refresh(),i):(this.refresh(),null)};this.refresh=function(n){var t,i;if(!this.refreshing){this.refreshing=!0;try{n=n||this.value;t=n.atomControl;t&&AtomBinder.refreshValue(t,"errors")}finally{this.refreshing=!1}i=n.parent;i&&this.refresh(i)}}};n.errors={list:[],set:function(n,i,r){var u=t.query(this.list).firstOrDefault({value:n});u||(u=new ft(n),this.list.push(u));u.set(i,r)},clear:function(n,i){var u=t.query(this.list).firstOrDefault({value:n}),r;if(u&&u.clear(),this.refresh(n),i)for(r=new ChildEnumerator(n);r.next();)this.clear(r.current(),i)},get:function(n,i){var r=[],o=t.query(this.list).firstOrDefault({value:n}),u,e,f;if(o&&(u=o.invoke(),u&&u.length&&(r=r.filter(function(n){return n}).concat(u.map(function(t){return{label:t,value:n}}))),r&&r.length))return r;if(i)for(e=new ChildEnumerator(n);e.next();)f=this.get(e.current(),i),f&&f.length&&(r=r.concat(f));return r&&r.length?r:undefined},refresh:function(n){var i=t.query(this.list).firstOrDefault({value:n});i&&i.refresh()},reset:function(n){var r=t.query(this.list).firstOrDefault({value:n}),i;r&&r.reset();i=n.parent;i&&this.reset(i)}};k=n.errors,function(t){return classCreator("WebAtoms.AtomUIComponent",t,function(){},{get_owner:function(){return this},get_appScope:function(){return appScope},get_scope:function(){if(this._scope===undefined){var n=this.get_atomParent(this._element._logicalParent||this._element.parentNode);return n?n._localScope||n.get_scope():appScope}return this._scope},get_localScope:function(){if(this._localScope===undefined){var n=this.get_atomParent(this._element._logicalParent||this._element.parentNode);if(n)return n.get_localScope();throw new Error("Local Scope does not exist");}return this._localScope},set_scope:function(t){var u=this._localScope||this.get_scope(),i,r;for(i in t){if(/^(application|owner|app|parent)$/gi.test(i))throw new Error("Invalid name for the scope property");(r=t[i],u!=n.appScope||n.atomApplication._ready||i.indexOf("_")!=0&&r!==undefined&&r!==null&&/string|number|boolean/i.test(typeof r)&&(atomApplication._defaultScope[i]=r),u[i]===undefined)&&(u[i]=r)}},get_name:function(){return this._name},getTemplate:function(n){var t=this["_"+n];return t!==undefined&&t!==null?t:(t=h.get(this.constructor,n),!t)?null:(this["_"+n]=t,t)}},{next:null,value:undefined})}(WebAtoms.AtomComponent.prototype);h.compiled={};h.compileElement=function(n){var r=new i(n),t,f,e;if(r.next(),t=r.current(),f=u.createElement(t),!r.next())return f;if(t=r.current(),t)for(e in t)f.setAttribute(e,t[e]);while(r.next()){if(t=r.current(),!t)break;t.constructor==String?f.appendChild(u.createTextNode(t)):f.appendChild(h.compileElement(t))}return f};h.compileJsonML=function(n){if(n.length==1)return h.compileElement(n[0]);for(var t=[],r=new i(n);r.next();)t.push(h.compileElement(r.current()));return t};h.compile=function(n,t,i){var r=u.createElement("div");return r.innerHTML=i,$(r).children().length==1&&(i=AtomUI.cloneNode(r.firstElementChild||r.children[0])),i};h.get=function(n,t){var r=n.__typeName+"."+t,i=this.compiled[r];return i?i:(i=h.jsonML[r],i?i=h.compileJsonML(i):n.__baseType&&(i=h.get(n.__baseType,t)),!i)?null:(this.compiled[r]=i,i)};h.compileType=function(n){var r=n.__typeName,u=r.split("."),t,f,o,e,i;if(u=u[u.length-1],t=this.compiled[r],t)return t;if(t={},f=this[r]||this[u],f)for(i in f)t[i]=this.compile(n,i,f[i]);if(n.__baseType){o=this.compileType(n.__baseType);for(e in o)t[e]||(t[e]=o[e])}return this.compiled[r]=t,i=this,delete i[r],delete i[u],t};nt={"{":function(n,u,f,e){var o,h,c,s;if(f=f.substr(1,f.length-2),o=AtomEvaluator.parse(f),o.path)for(h=new i(o.path),f=[];h.next();){for(c=new i(h.current()),s=n;c.next();)s=AtomBinder.getValue(s,c.current());f.push(s)}else f=[f];f.push(t);f.push(r);f=o.method.apply(null,f);n.setLocalValue(u,f,e)},"[":function(ctrl,key,value,element){value=value.substr(1,value.length-2);var be=AtomEvaluator.parse(value);be.length==0?(value=eval(value),AtomBinder.setValue(ctrl,key,value)):be.length==1&&be.path[0]==be.original?ctrl.bind(element,key,value,!1):ctrl.bind(element,key,be.path,!1,be.method)},"$[":function(n,t,i,r){var f=i.lastIndexOf("]"),u=null;f<i.length-1&&(u=i.substr(f+2),u=u.substr(0,u.length-1));i=i.substr(0,f);i=i.substr(2);/^(@|\$)/g.test(i)&&(i=i.substr(1));n.bind(r,t,i,!0,null,u)},"^[":function(n,t,i,r){i=i.substr(2,i.length-3);/^(@|\$)/g.test(i)&&(i=i.substr(1));n.bind(r,t,i,!0,null,"keyup,keydown,keypress,blur,click")}};AtomProperties={any:function(n,t,i){AtomUI.attr(n,i,t)},isEnabled:function(n,t){t?AtomUI.removeAttr(n,"disabled"):AtomUI.attr(n,"disabled","disabled")},checked:function(n,t){n.checked!=t&&(n.checked=t?!0:!1)},value:function(n,t){/date|datetime/gi.test(n.type)?n.valueAsDate=f.parse(t):$(n).val(t)},valueAsDate:function(n,t){n.valueAsDate=f.parse(t)},text:function(n,t){n.innerHTML="";var i=u.createTextNode(t);n.appendChild(i)},error:function(n,t){var i=t;typeof i!="function"&&(i=function(){return t});k.set(n,"error",i)},validate:function(n){var u=n.control,t=n.element,i=n.key,f=n.value,r=n.eventName,e=n.valueFunction,o=function(){var i=e.call(u,t);return n.validator(i)};f?(k.set(t,i,o),r&&u.bindEvent(t,r,function(){k.reset(t)},i)):(k.set(t,i,null),r&&u.unbindEvent(t,r,null,i))},required:function(n,t){var i=function(){return $(n).val()},r=function(n){return n?"":"Required"};AtomProperties.validate({control:this,element:n,key:"required",value:t,eventName:"change",valueFunction:i,validator:r})},regex:function(n,value){var t=function(){return $(n).val()},i=function(v){var r=value;return(typeof r=="string"||r.constructor==String)&&(/^\//.test(r)||/(\/)|(\/i)$/.test(r)||(r="/"+r+"/"),r=eval(r)),r.test(v)?"":"Invalid"};AtomProperties.validate({control:this,element:n,value:value,key:"regex",eventName:"change",valueFunction:t,validator:i})},dataType:function(n,t){var i=function(){return $(n).val()},r=function(n){var i=null,r="Invalid";return/email/i.test(t)&&(i=/^(([^<>()\[\]\\.,;:\s@\"]+(\.[^<>()\[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,r="Invalid email"),i.test(n)?"":r};AtomProperties.validate({control:this,element:n,value:t,key:"dataType",eventName:"change",valueFunction:i,validator:r})},mask:function(n,t){t?t.constructor===String?$(n).mask(t):$(n).mask(t.mask,t.settings):$(n).unmask()},html:function(n,t){n.innerHTML=t},absPos:function(n,t){AtomProperties.setPosition(!0,n,t)},relPos:function(n,t){AtomProperties.setPosition(!1,n,t)},"class":function(n,t){n.atomClass&&$(n).removeClass(n.atomClass);t&&(t=AtomUI.createCss(t),t&&$(n).addClass(t),n.atomClass=t)},setPosition:function(a,e,val){var l=val,left,top,width,height;l.constructor==String&&(l=eval("["+l+"]"));e.style.position=a?"absolute":"relative";left=l[0];top=l[1];left!==null&&(e.style.left=left+"px");top!==null&&(e.style.top=top+"px");l.length>2&&(width=l[2],height=l[3],width!==undefined&&width!==null&&(e.style.width=width+"px"),height!==undefined&&height!==null&&(e.style.height=height+"px"))}};n.AtomProperties=AtomProperties,function(f){return classCreatorEx({name:"WebAtoms.AtomControl",base:f,start:function(n){n.atomControl=this;this._element=n;this.dispatcher=WebAtoms.dispatcher;this.bindings=[];this._isVisible=!0;var t=n.id;t&&appScope&&(/^\_\_waID/.test(t)||(appScope[t]=this));AtomUI.assignID(n);b[t]=this},properties:{layout:null,loadNext:null,next:null,merge:undefined,value:undefined},methods:{set_merge:function(n){var i,r,f,u;if((this._mergeData2=null,n)&&(i=n.data,i&&(t.merge(this.get_data(),i,!0),this._mergeData2=i),i=n.scope,i&&t.merge(this.get_scope(),i,!0),i=n.appScope,i&&t.merge(this.get_appScope(),i,!0),i=n.localScope,i&&t.merge(this.get_localScope(),i,!0),i=n.owner,i&&t.merge(this,i,!0),r=n.timeOut||n.timeout,r)){f=this;u=100;r.hasOwnProperty("length")&&r.length>1&&(u=r[0],r=r[1]);setTimeout(function(){f.set_merge(r)},u);return}},invokeAction:function(n,t){try{ot.call(this,n,t)}catch(i){alert(i);console.error&&console.error(i)}},refresh:function(){},get_element:function(){return this._element},clearBinding:function(n,t){for(var r=new i(this.bindings),u,f=[];r.next();)(u=r.current(),n&&u.element!=n)||t&&u.key!=t||(u.dispose(),f.push(u));for(r=new i(f);r.next();)y.remove(this.bindings,r.current())},addBinding:function(n,t,i,r,u,f,e,o){this.clearBinding(t,i);var s=new WebAtoms.AtomBinding(n,t,i,r,u,f,e,o);this.bindings.push(s);s.setup()},get_errors:function(){return n.errors.get(this._element,!0)},get_atomParent:function(t){if(t==null)if(this._element._logicalParent||this._element.parentNode)t=this._element._logicalParent||this._element.parentNode;else return null;return t.atomControl?t.atomControl:t===u||t===n||!t.parentNode?null:this.get_atomParent(t._logicalParent||t.parentNode)},get_templateParent:function(n){if(n||(n=this._element),n._templateParent)return n._templateParent;var t=n._logicalParent||n.parentNode;if(!t)throw new Error("Could not find templateParent");return this.get_templateParent(n._logicalParent||n.parentNode)},get_data:function(){if(this._data===undefined){var n=this.get_atomParent(this._element._logicalParent||this._element.parentNode);if(n)return n.get_data()}return this._data},set_data:function(n){this._data=n;this.mergeData();this.updateChildBindings(this._element)},mergeData:function(){this._mergeData2&&t.merge(this.get_data(),this._mergeData2,!0)},updateChildBindings:function(n){for(var r=new ChildEnumerator(n),t,i;r.next();){if(t=r.current(),t.atomControl&&t.atomControl._created){if(i=t.atomControl,i._data!==undefined)continue;AtomBinder.refreshValue(i,"data");i.mergeData()}this.updateChildBindings(t)}},initProperties:function(){if(!this._disposed){var n=this.get_element();this.setProperties(n);this._created=!0;this.onCreated();this.onLoaded()}},createChildren:function(){var n,u,f,r,t;this.onCreateChildren(this._element);if(n=this.getTemplate("template"),n&&(u=new ChildEnumerator(this._element),!u.next())){if(n.constructor==String)this._element.innerHTML=n,f=this,$(this._element).children().each(function(){this._templateParent=f});else if(AtomUI.isNode(n))n=AtomUI.cloneNode(n),n._templateParent=this,this._element.appendChild(n);else for(r=new i(n);r.next();)t=r.current(),t=AtomUI.cloneNode(t),t._templateParent=this,this._element.appendChild(t);this.onCreateChildren(this._element)}},onCreateChildren:function(n){for(var o=new ChildEnumerator(n),t,i,r,u,f,s,e;o.next();){if(t=o.current(),i=AtomUI.attributeMap(t,/^atom\-(template|presenter|type|template\-name)$/gi),r=i["atom-template"],r){t.removeAttributeNode(r.node);n.templateOwner=!0;this["_"+r.value]=t;n.removeChild(t);continue}if(u=i["atom-template-name"],u){t.removeAttributeNode(u.node);this._scopeTemplates=this._scopeTemplates||{};this._scopeTemplates[u.value]=t;n.removeChild(t);continue}if(f=i["atom-presenter"],f&&(s=AtomUI.getPresenterOwner(this,f.value),s["_"+f.value]=t),e=i["atom-type"],e)AtomUI.createControl(t,e.value);else this.onCreateChildren(t)}},onLoaded:function(){},onUpdateUI:function(){this._layout?this._layout.doLayout(this._element):this.updateChildUI(this.get_element())},updateUI:function(){var n=this;this.dispatcher.callLater(function(){n.onUpdateUI()})},updateChildUI:function(n){var i,t;for(n||(n=this._element),i=new ChildEnumerator(n);i.next();){if(t=i.current(),t.atomControl){t.atomControl.updateUI();continue}this.updateChildUI(t)}},onCreated:function(){this.updateUI()},setProperties:function(n){var t,f,r,y=n.attributes,u=new i(y),e=[],a="value",s,h,v,c,l;for(o.isIE&&o.majorVersion<9&&(a="nodeValue"),s={},h=null;u.next();){if(r=u.current(),t=r.nodeName,f=r[a],t==="data-atom-init"){h=f;e.push(r);continue}if(/^data\-atom/.test(t)&&(t=t.substr(5)),!/^atomControl$/g.test(t)){if(/^atom\-type$/.test(t)){e.push(r);continue}/^(atom|bind|style|event)\-/g.test(t)&&(/^(style|event)\-/g.test(t)||(t=t.substr(5)),f)&&(/(^style$|dock)/.test(t)||e.push(r),t=$.camelCase(t),s[t]=f)}}h&&(v=WebAtoms.PageSetup[h],v.call(this,n));for(t in s)this.setValue(t,s[t],!0,n);for(u=new i(e);u.next();)n.removeAttributeNode(u.current());for(c=new ChildEnumerator(n);c.next();)(l=c.current(),l.atomControl)||this.setProperties(l)},setValue:function(n,t,i,r){if(t&&t.constructor==String){var f=t[0],u=nt[f];if(u){u(this,n,t,r);return}if(f+=t[1],u=nt[f],u){u(this,n,t,r);return}}this.setLocalValue(n,t,r)},setLocalValue:function(n,t,i,u){var o,e,s,c,f,l,h;if(t!==undefined){if(t&&t instanceof r){i._promisesQueue=i._promisesQueue||{};o=i._promisesQueue[n];o&&o.abort();i._promisesQueue[n]=t;t._persist&&(this._promises=this._promises||{},this._promises[n]=t);e=this;t.then(function(t){i._promisesQueue[n]==t&&(i._promisesQueue[n]=null);i._promisesQueue[n]=null;e.setLocalValue(n,t.value(),i,!0);e._loadNext&&e.invokeAction(e._loadNext)});t.failed(function(t){i._promisesQueue[n]==t&&(i._promisesQueue[n]=null)});t.invoke();return}if(this._element==i&&(s=this["set_"+n],s!=null)){if(u&&(c=AtomBinder.getValue(this,n),c==t))return;s.apply(this,[t]);u&&AtomBinder.refreshValue(this,n);return}if(/^style/g.test(n)&&n.length>5){f=n.substr(5);f=String.fromCharCode(f.charCodeAt(0)).toLowerCase()+f.substr(1);i.style[f]=t;return}if(/^event/g.test(n)&&n.length>5){f=n.substr(5);f=String.fromCharCode(f.charCodeAt(0)).toLowerCase()+f.substr(1);l=this;this.unbindEvent(i,f);this.bindEvent(i,f,null,null,function(n){l.invokeAction(t,n)});return}h=AtomProperties[n]||AtomProperties.any;h&&h.call(this,i||this._element,t,n)}},bind:function(t,i,r,u,f,e){var s,c,o,h;if(r==null){this.clearBinding(t,i);return}s=this;r&&r.constructor==String&&/^window\./g.test(r)&&(s=n);c=this.get_element();o=c!=t;o||(h=this["get_"+i],(h==undefined||h==null)&&(o=!0));switch(i){case"value":/input/gi.test(t.nodeName)&&(o=!0);this.addBinding(s,t,"value",r,u,o,f,e);break;case"text":this.addBinding(s,t,"text",r,!1,!0,f,e);break;default:this.addBinding(s,t,i,r,u,o,f,e)}},onInitialized:function(){},init:function(){var s,r,i,u,h,e;f.init.apply(this,arguments);var t=this.get_element(),o=AtomUI.attributeMap(t,/^atom\-(name|local\-scope)$/gi),n=o["atom-name"];if(n?(t.removeAttributeNode(n.node),n=n.value):(s=t.id,/^\_\_waID/.test(s)||(n=t.id)),n){if(/^(app|window|owner|scope|localScope|parent)$/gi.test(n))throw new Error("Invalid Control Name '"+n+"'");i=this.get_scope();AtomBinder.setValue(i,n,this);this._name=n}if(ls=o["atom-local-scope"],ls&&(this._localScope=new p(this,this.get_scope(),atomApplication),this._scope=this._localScope,this._name&&(this._localScope[this._name]=this),t.removeAttributeNode(ls.node)),r=this._scopeTemplates,r){i=this.get_scope();for(u in r)h=r[u],AtomBinder.setValue(i,u,h)}e=this;WebAtoms.dispatcher.callLater(function(){e.initProperties()});this.initChildren(this._element);WebAtoms.dispatcher.callLater(function(){e.onInitialized()})},dispose:function(n){if(n){var t=n.atomControl;t?t.dispose():(this.clearBinding(n),this.disposeChildren(n));$(n).remove();return}this._disposed=!0;this.disposeChildren(this._element);this.clearBinding();this.bindings.length=0;f.dispose.apply(this,arguments)},disposeChildren:function(n){for(var r=o.isIE&&o.majorVersion<9,i=new ChildEnumerator(n),t;i.next();)t=i.current(),t.atomControl?(t.atomControl.dispose(),r?t.atomControl=undefined:delete t.atomControl):(this.clearBinding(t),this.unbindEvent(t),this.disposeChildren(t));try{n.innerHTML=""}catch(u){$(n).html("")}},get_innerTemplate:function(){return this._template},set_innerTemplate:function(n){if(this._template!==n||!this._created){if(!this._created){var t=this;WebAtoms.dispatcher.callLater(function(){t.set_innerTemplate(n)});return}this._template=n;this.disposeChildren(this._element);this.createChildren();this.setProperties(this._element);this.initChildren(this._element);this.updateUI()}},initChildren:function(n){for(var u=new ChildEnumerator(n),t,f,e=[],r;u.next();){if(t=u.current(),t.nodeName=="SCRIPT"){if(r=$.trim(t.innerHTML),/^\(\{/.test(r)&&/\}\)$/.test(r))try{r=new Function("return "+r+";")();this.set_scope(r)}catch(o){w(JSON.stringify(o));alert(JSON.stringify(o))}e.push(t);continue}f=t.atomControl;f?f.init():this.initChildren(t)}for(u=new i(e);u.next();)n.removeChild(u.current())}}})}(WebAtoms.AtomUIComponent.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomItemsControl",base:n,start:function(){this._selectedItems=[];this._selectedElements=[];this._selectedIndexSet=!1;this._onUIChanged=!1;this._itemsPresenter=null;this._itemsPanel=null;this._presenters=["itemsPresenter"];this._childItemType=WebAtoms.AtomControl},properties:{allowSelectFirst:!1,allowMultipleSelection:!1,uiVirtualize:!1,defaultValue:null,autoScrollToSelection:!1,selectAll:undefined,labelPath:"label",valuePath:"value",sortPath:null,valueSeparator:null,postData:null,postUrl:null,confirm:!1,confirmMessage:null,filter:null,items:null,itemTemplate:null},methods:{get_postData:function(){return this._postData||this.get_selectedItem()},get_allValues:function(){if(this._valueSeparator&&this._valuePath){for(var n=[],r=this._valuePath,u=function(n){return n[r]},i=t.query(this.get_dataItems());i.next();)n.push(u(i.current()));return n.join(this._valueSeparator)}},get_value:function(){var n,t;return this._allowMultipleSelection?(n=this._selectedItems,n.length==0)?this._value!==undefined?this._value:null:(n=y.getValues(n,this._valuePath),this._valueSeparator&&(n=n.join(this._valueSeparator)),n):(t=this.get_selectedItem(),!t)?this._value!==undefined?this._value:null:(this._valuePath&&(t=t[this._valuePath]),t)},set_value:function(n){var r,u,t;if(this._value=n,n===undefined||n===null){AtomBinder.clear(this._selectedItems);return}for(r=this.get_dataItems(),this._allowMultipleSelection&&this._valueSeparator?(n.constructor!=String&&(n=""+n),n=y.split(n,this._valueSeparator)):n=[n],u=y.intersect(r,this._valuePath,n),this._selectedItems.length=0,t=new i(u);t.next();)this._selectedItems.push(t.current());AtomBinder.refreshItems(this._selectedItems)},set_sortPath:function(n){if(this._sortPath=n,n)this.onCollectionChangedInternal("refresh",-1,null)},set_selectAll:function(n){var t,r;if(n!==undefined&&n!==null){if(this._selectedItems.length=0,t=this.get_dataItems(),n&&t)for(r=new i(t);r.next();)this._selectedItems.push(r.current());this._selectAll=!0;AtomBinder.refreshItems(this._selectedItems)}},refresh:function(){this._promises&&this._promises.items&&this._promises.items.invoke()},set_defaultValue:function(n){this.get_value()||AtomBinder.setValue(this,"value",n)},invokePost:function(){var n,i,t;if(this._onUIChanged&&(!this._confirm||confirm(this._confirmMessage))){if(!this._postUrl){this.invokeAction(this._next);return}(n=this.get_postData(),n!==null&&n!==undefined)&&(n=AtomBinder.getClone(n),i=this,t=r.json(this._postUrl,null,{type:"POST",data:n}),t.then(function(){i.invokeNext()}),t.invoke())}},invokeNext:function(){this.invokeAction(this._next)},set_filter:function(n){if(n!=this._filter&&(this._filter=n,this._filteredItems=null,this.hasItems()))this.onCollectionChangedInternal("refresh",-1,null)},isSelected:function(n){for(var t=new i(this._selectedItems),r=null;t.next();)if(r=t.current(),r==n)return!0;return!1},get_dataItems:function(){var n=this._items,r,u,f,e,o;if(this.hasItems()){if(r=this._filter,r){if(u=[],typeof r=="object")u=t.query(n).where(r).toArray();else for(f=new i(n);f.next();)e=f.current(),r(e,f.currentIndex())&&u.push(e);this._filteredItems=u;n=u}return o=this._sortPath,o&&(n=n.sort(o)),n}return $(this._itemsPresenter).children()},getIndexOfDataItem:function(n){if(n==null)return-1;for(var r=this.get_dataItems(),t=new i(r);t.next();)if(t.current()==n)return t.currentIndex();return-1},getDataItemAtIndex:function(n){return n==-1?null:this.get_dataItems()[n]},get_childAtomControls:function(){for(var r=this._itemsPresenter||this._element,t=[],i=new ChildEnumerator(r),n;i.next();)(n=i.current(),n=!n||n.atomControl,n)&&t.push(n);return t},get_selectedChild:function(){var i=this.get_selectedItem(),n,t;if(!this.hasItems())return i;for(n=new ChildEnumerator(this._itemsPresenter);n.next();)if(t=n.current(),t.atomControl.get_data()==i)return t;return null},set_allowSelectFirst:function(n){n=n?n!="false":n;this._allowSelectFirst=n},get_selectedItem:function(){return this._selectedItems.length>0?this._selectedItems[0]:null},set_selectedItem:function(n){n?(this._selectedItems.length=1,this._selectedItems[0]=n):this._selectedItems.length=0;AtomBinder.refreshItems(this._selectedItems)},get_selectedItems:function(){return this._selectedItems},set_selectedItems:function(){throw new Error("Not yet implemented");},get_selectedIndex:function(){var n=this.get_selectedItem();return this.getIndexOfDataItem(n)},set_selectedIndex:function(n){AtomBinder.setValue(this,"selectedItem",this.getDataItemAtIndex(n))},updateChildSelections:function(){},bringSelectionIntoView:function(){var t,n,i;if(!this._allowSelectFirst||this.get_selectedIndex()!=0)for(t=new ChildEnumerator(this._itemsPresenter);t.next();)if(n=t.current(),i=n.atomControl?n.atomControl.get_data():n,this.isSelected(i)){n.scrollIntoView();return}},updateSelectionBindings:function(){AtomBinder.refreshValue(this,"value");AtomBinder.refreshValue(this,"selectedItem");AtomBinder.refreshValue(this,"selectedItems");AtomBinder.refreshValue(this,"selectedIndex");this._selectedItems.length||this._selectAll===!0&&(this._selectAll=!1,AtomBinder.refreshValue(this,"selectAll"))},onSelectedItemsChanged:function(n,t,i){this._onUIChanged||(this.updateChildSelections(n,t,i),this._autoScrollToSelection&&this.bringSelectionIntoView());this.updateSelectionBindings();this.updateUI();this.invokePost()},hasItems:function(){return this._items!=undefined&&this._items!=null},get_items:function(){return this._items},set_items:function(n){var t=this;if(this._items&&this.unbindEvent(this._items,"CollectionChanged",null),this._items=n,this._filteredItems=null,n!=null){this.bindEvent(this._items,"CollectionChanged",function(){t.onCollectionChangedInternal.apply(t,arguments)});this.onCollectionChangedInternal("refresh",-1,null)}},set_itemTemplate:function(n){this._itemTemplate=n;this.onCollectionChangedInternal("refresh",-1,null)},onCollectionChangedInternal:function(n,i,r){if(this._created){t.refresh(this,"allValues");var u=this.get_value();if(this.hasItems()){this.onCollectionChanged(n,i,r);u||this._allowSelectFirst||AtomBinder.clear(this._selectedItems)}if(u!=null){if(this.set_value(u),this.get_selectedIndex()!=-1)return;this._value=undefined}this.selectDefault()}},selectDefault:function(){if(this._allowSelectFirst&&this.get_dataItems().length>0){this.set_selectedIndex(0);return}this.updateSelectionBindings()},onScroll:function(){this.scrollTimeout&&clearTimeout(this.scrollTimeout);var n=this;this.scrollTimeout=setTimeout(function(){n.scrollTimeout=0;n.onCollectionChangedInternal("refresh",-1,null)},1e3)},onCollectionChanged:function(n,t,r){var a,h,f,s,o,y,e,at,p,g,b,ht,rt,ct,c,l,lt;if(/remove/gi.test(n)){for(s=new ChildEnumerator(this._itemsPresenter);s.next();)if(o=s.current(),o.atomControl&&o.atomControl.get_data()==r){o.atomControl.dispose();$(o).remove();break}this.updateUI();return}if(a=this.get_scope(),h=this.getTemplate("itemTemplate"),h&&(h=AtomUI.getAtomType(h),h&&(this._childItemType=h)),/add/gi.test(n)){for(WebAtoms.dispatcher.pause(),f=new i(this._items),s=new ChildEnumerator(this._itemsPresenter);f.next();){if(s.next(),o=s.current(),f.currentIndex()==t){y=this.createChildElement(a,this._itemsPresenter,r,f,o);this.applyItemStyle(y,r,f.isFirst(),f.isLast());break}if(f.isLast()){y=this.createChildElement(a,this._itemsPresenter,r,f);this.applyItemStyle(y,r,f.isFirst(),f.isLast());break}}WebAtoms.dispatcher.start();this.updateUI();return}e=this._itemsPresenter;at=this.get_dataItems();this.disposeChildren(e);WebAtoms.dispatcher.pause();var ut=this.get_dataItems(!0),d=[],f=new i(ut);if(0){this._itemsPresenter==this._element&&(p=u.createElement("DIV"),g=$(p),g.addClass("atom-virtual-container"),g.css("width","100%"),this._element.innerHTML="",this._element.appendChild(p),this._itemsPresenter=p,e=this._itemsPresenter);var v=this._itemsPresenter.parentElement,nt=v.scrollTop,ft=v.scrollHeight;this.unbindEvent(v,"scroll");var vt=ut.length,et=$(this._itemsPresenter).innerWidth(),yt=this.getTemplate("itemTemplate"),ot=$(yt),w=ot.outerHeight(!0),tt=ot.outerWidth(!0),pt=Math.floor(et/tt),it=Math.ceil(vt/pt);it=it*w+100;$(this.itemsPresenter).height(it);b=u.createElement("DIV");b.style.height=w+"px";b.style.width=tt+"px";var kt=$(e).innerWidth(),k=Math.ceil(et/tt),wt=Math.ceil(nt/w),bt=Math.ceil(ft/w),st=wt*k;for(k?console.log(JSON.stringify({itemsPerLine:k,st:nt,sh:ft,si:st})):console.log("itemsPerLine is zero"),ht=(bt+1)*k;f.next();)rt=f.currentIndex(),rt<st||rt>ht?e.appendChild(b.cloneNode(!0)):(c=f.current(),l=this.createChildElement(a,e,c,f),d.push(l),this.applyItemStyle(l,c,f.isFirst(),f.isLast()));v.scrollTop=nt;ct=this;this.bindEvent(v,"scroll",function(){ct.onScroll()})}else for(this.getTemplate("itemTemplate");f.next();)c=f.current(),l=this.createChildElement(a,e,c,f),d.push(l),this.applyItemStyle(l,c,f.isFirst(),f.isLast());lt=this;WebAtoms.dispatcher.callLater(function(){for(var r=[],t=new ChildEnumerator(e),u,n;t.next();)n=t.current(),u=d.filter(function(t){return n==t}),u.pop()!=n&&r.push(n);for(t=new i(r);t.next();)n=t.current(),lt.dispose(n),$(n).remove()});WebAtoms.dispatcher.start();AtomBinder.refreshValue(this,"childAtomControls")},set_innerTemplate:function(){this._itemsPresenter=this._element;n.set_innerTemplate.apply(this,arguments);this.onCollectionChangedInternal("mode",-1,null)},applyItemStyle:function(){},createChildElement:function(n,t,i,r,u){var e=AtomUI.cloneNode(this._itemTemplate),f,o;return e._logicalParent=t,e._templateParent=this,e._isDirty=!0,WebAtoms.dispatcher.callLater(function(){u?t.insertBefore(e,u):t.appendChild(e)}),f=new p(this,n,n.__application),r&&(f.itemIsFirst=r.isFirst(),f.itemIsLast=r.isLast(),f.itemIndex=r.currentIndex(),f.itemExpanded=!1,f.data=i,f.get_itemSelected=function(){return f.owner.isSelected(i)},f.set_itemSelected=function(){f.owner.toggleSelection(i,!0)}),o=AtomUI.createControl(e,this._childItemType,i,f),e},toggleSelection:function(n){this._onUIChanged=!0;this._value=undefined;this._allowMultipleSelection?AtomUI.contains(this._selectedItems,n)?AtomBinder.removeItem(this._selectedItems,n):AtomBinder.addItem(this._selectedItems,n):(this._selectedItems.length=1,this._selectedItems[0]=n,AtomBinder.refreshItems(this._selectedItems));this._onUIChanged=!1},onUpdateUI:function(){var t,i,r;for(n.onUpdateUI.call(this),t=new ChildEnumerator(this._itemsPresenter);t.next();)(i=t.current(),i.atomControl)&&(r=i.atomControl.get_data(),AtomBinder.refreshValue(i.atomControl.get_scope(),"itemSelected"),this.applyItemStyle(i,r,t.isFirst(),t.isLast()))},onCreated:function(){if(this._items)this.onCollectionChangedInternal("refresh",-1,null);var n=this;this.dispatcher.callLater(function(){n._autoScrollToSelection&&n.bringSelectionIntoView()})},init:function(){var u=this.get_element(),r,t;this._itemsPresenter||(this._itemsPresenter=this._element);r=this;this.bindEvent(this._selectedItems,"CollectionChanged",function(){r.onSelectedItemsChanged.apply(r,arguments)});n.init.apply(this,arguments);t=this;this.removeItemCommand=function(n,i){if(i){var r=i.get_data();AtomBinder.removeItem(t._items,r)}};this.removeSelectedCommand=function(){for(var r=t.get_selectedItems().slice(0),n=new i(r);n.next();)AtomBinder.removeItem(t.get_items(),n.current())};this.removeAllCommand=function(){AtomBinder.clear(t.get_items())}}}})}(WebAtoms.AtomControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomButton",base:n,start:function(n){this._sendData=!1;$(n).addClass("atom-button")},properties:{sendData:!1},methods:{onClickHandler:function(n){return AtomUI.cancelEvent(n),this._next&&(this._sendData&&this._next&&AtomBinder.setValue(this._next,"data",this.get_data()),this.invokeAction(this._next)),!1},init:function(){var t=this._element;this.bindEvent(t,"click","onClickHandler");n.init.apply(this)}}})}(WebAtoms.AtomControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomListBox",base:n,start:function(){this._labelPath="label";this._valuePath="value";this._autoScrollToSelection=!1},properties:{autoSelectOnClick:!0},methods:{setClass:function(){var n=$(this._element);n.addClass("atom-list-box")},onClick:function(n){if(this._autoSelectOnClick)this.onSelectItem(null,null,n)},get_itemWidth:function(){if(!this._items||!this._items.length)return 0;var n=$(this._element).innerWidth();return n/this._items.length},applyItemStyle:function(n,t,i,r){var u=$(n);(u.removeClass("selected-item list-item first-item last-item"),t)&&(u.addClass("list-item"),i&&u.addClass("first-item"),r&&u.addClass("last-item"),this.isSelected(t)&&u.addClass("selected-item"))},onCreated:function(){this.bindEvent(this._itemsPresenter,"click","onClick");n.onCreated.call(this)},invokePost:function(){this.get_selectedIndex()!=-1&&n.invokePost.apply(this,arguments)},onSelectItem:function(n,t,i){for(var e=i?i.target:null,o=this._itemsPresenter,r=e||t._element,f;r.parentNode!=null&&r.parentNode!=o;)r=r.parentNode;r!=u&&(f=r,this.hasItems()&&(f=r.atomControl.get_data()),this.toggleSelection(f))},updateChildSelections:function(){var t=this._element,i;/select/i.test(t.tagName)?(i=this.get_selectedIndex(),t.selectedIndex!=i&&WebAtoms.dispatcher.callLater(function(){t.selectedIndex=i})):n.updateChildSelections.apply(this,arguments)},init:function(){this.setClass();n.init.call(this);var t=this,i=this._element;/select/i.test(i.tagName)&&(this.set_allowSelectFirst(!0),this.bindEvent(i,"change",function(){AtomBinder.setValue(t,"selectedIndex",i.selectedIndex)}));this.selectCommand=function(){t.onSelectItem.apply(t,arguments)};this.selectAllCommand=function(){t.set_selectAll(!0)};this.clearSelectionCommand=function(){t.set_selectedIndex(-1)}}}})}(WebAtoms.AtomItemsControl.prototype),function(t){return classCreatorEx({name:"WebAtoms.AtomAutoCompleteBox",base:t,start:function(n){$(n).addClass("atom-auto-complete-box");this._presenters=["itemsPresenter","inputBox","selectionBox"];this._mouseCapture=0},properties:{isPopupOpen:!1,autoOpen:!1,selectedText:"",placeholder:undefined,keyPressed:undefined,displayLabel:undefined},methods:{get_offsetLeft:function(){return $(this._element).offset().left},get_offsetTop:function(){return $(this._element).offset().top},get_offsetWidth:function(){return $(this._inputBox).offset().width},set_itemsUrl:function(n){var t="[ !$owner.keyPressed ? undefined : AtomPromise.json('"+n+"').showProgress(false) ]";this.setValue("items",t,!0,this._element)},set_isPopupOpen:function(t){if(this._isPopupOpen=t,t){AtomBinder.refreshValue(this,"offsetTop");AtomBinder.refreshValue(this,"offsetLeft");AtomBinder.refreshValue(this,"offsetWidth");var i=this;this.trySelect();this.bindEvent(n,"click",function(){i.onWindowClick.apply(i,arguments)})}else this.unbindEvent(n,"click")},onSelectedItemsChanged:function(){this._onUIChanged&&this._selectedItems.length>0&&this.refreshLabel();t.onSelectedItemsChanged.apply(this,arguments)},onClick:function(){t.onClick.apply(this,arguments);this._backupValue=this.get_value();this.refreshLabel();this._backupLabel=this.get_displayLabel();AtomBinder.setValue(this,"keyPressed",!1);AtomBinder.setValue(this,"isPopupOpen",!1)},restoreSelection:function(){AtomBinder.setValue(this,"isPopupOpen",!1);this._backupValue?(AtomBinder.setValue(this,"value",this._backupValue),AtomBinder.setValue(this,"displayLabel",this._backupLabel),this._backupValue=null):AtomBinder.setValue(this,"selectedIndex",-1)},onKeyUp:function(n){var t,i;AtomBinder.setValue(this,"isPopupOpen",!0);switch(n.keyCode){case 27:AtomBinder.setValue(this,"keyPressed",!1);this.restoreSelection();return;case 13:return AtomBinder.setValue(this,"keyPressed",!1),AtomBinder.setValue(this,"isPopupOpen",!1),this._backupValue=this.get_value(),this.refreshLabel(),this._backupLabel=this.get_displayLabel(),AtomUI.cancelEvent(n);case 37:break;case 38:AtomBinder.setValue(this,"keyPressed",!1);this.moveSelection(!0);return;case 39:break;case 40:AtomBinder.setValue(this,"keyPressed",!1);this.moveSelection(!1);return;default:t=this;this.dispatcher.callLater(function(){t.trySelect()})}this.oldTimeout&&clearTimeout(this.oldTimeout);i=this;this.oldTimeout=setTimeout(function(){AtomBinder.setValue(i,"keyPressed",!0)},500)},trySelect:function(){var r,n;if(this._items&&this._items.length!=0){var u=new i(this._items),f=this._labelPath,t=this._displayLabel;for(t&&(t=t.toLowerCase());u.next();)if(r=u.current(),n=r,f&&(n=n[f]),n.toLowerCase().indexOf(t)==0){AtomBinder.setValue(this,"selectedItem",r);AtomBinder.setValue(this,"selectedText",n);this.bringSelectionIntoView();return}}},moveSelection:function(n){if(this._items&&this._items.length){var t=this.get_selectedIndex();t==-1&&(this.backupLabel=this.get_displayLabel());t=n?t-1:t+1;n&&t==-2&&(t=this._items.length-1);n||t!=this._items.length||(t=-1);AtomBinder.setValue(this,"selectedIndex",t);t==-1?AtomBinder.setValue(this,"displayLabel",this.backupLabel||""):this.refreshLabel()}},refreshLabel:function(){var t=this.get_selectedItem(),n=t;n&&this._labelPath&&(n=n[this._labelPath]);AtomBinder.setValue(this,"displayLabel",n||"")},onWindowClick:function(n){for(var i=this._element,r=this._itemsPresenter,t=n.target;t.parentNode!=null&&t!=i&&t!=r;)t=t.parentNode;t!=i&&t!=r&&this.restoreSelection()},onInputFocus:function(){this._autoOpen&&(this._backupValue=this.get_value(),this._backupLabel=this.get_displayLabel(),AtomBinder.setValue(this,"isPopupOpen",!0),$(this._inputBox).select())},onInputBlur:function(){if(!this._mouseCapture){var n=this;setTimeout(function(){n._isPopupOpen&&(AtomBinder.setValue(n,"isPopupOpen",!1),n.restoreSelection())},10)}},onCreated:function(){this._itemsPresenter._logicalParent=this._element;$(this._itemsPresenter).remove();u.body.appendChild(this._itemsPresenter);$(this._itemsPresenter).addClass("auto-complete-popup");t.onCreated.apply(this,arguments);this.bindEvent(this._itemsPresenter,"mouseover","onMouseOver");this.bindEvent(this._itemsPresenter,"mouseout","onMouseOut")},onMouseOver:function(){this._mouseCapture++},onMouseOut:function(){var n=this;setTimeout(function(){n._mouseCapture--},1e3)},init:function(){t.init.apply(this,arguments);this.bindEvent(this._inputBox,"focus","onInputFocus");this.bindEvent(this._inputBox,"blur","onInputBlur");this.bindEvent(this._inputBox,"keyup","onKeyUp")},dispose:function(){this._itemsPresenter&&(this.disposeChildren(this._itemsPresenter),$(this._itemsPresenter).remove(),this._itemsPresenter=null);t.dispose.call(this)}}})}(WebAtoms.AtomListBox.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomComboBox",base:n,start:function(){this._labelPath="label";this._valuePath="value";this._allowSelectFirst=!0},methods:{invokePost:function(){this.get_selectedIndex()>0&&n.invokePost.apply(this,arguments)},invokeNext:function(){n.invokeNext.apply(this,arguments);this._postUrl&&(AtomBinder.setValue(this,"selectedIndex",0),this.updateChildSelections())},onSelectionChanged:function(){this._onUIChanged=!0;var n=this.get_element();this.set_selectedIndex(n.selectedIndex);this._onUIChanged=!1},updateChildSelections:function(){var n=this._element;n.selectedIndex=this.get_selectedIndex()},onCollectionChanged:function(){var f=this.get_element(),e=this.get_dataItems(),u;f.options.length=e.length;for(var r=new i(e),o=this._labelPath,s=this._valuePath,t=null,n=null,h=this.get_value();r.next();)u=r.current(),t=u,n=u,o&&(t=t[o]),s&&(n=n[s]),f.options[r.currentIndex()]=new Option(t,n,!1,n==h)},verifyTemplates:function(){},init:function(){var t=this.get_element();this.bindEvent(t,"change","onSelectionChanged");n.init.apply(this,arguments)}}})}(WebAtoms.AtomItemsControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomDateListBox",base:n,start:function(){this._monthList=f.monthList;var n=new Date;this._month=n.getMonth()+1;this._year=n.getFullYear();this._selectedItems=[];this._presenters=["itemsPresenter"];this._startYear=-5;this._endYear=10;this._currentYear=(new Date).getFullYear();this._value=null},properties:{month:0,year:0,selectedItems:[],startYear:-5,endYear:0,currentYear:0,monthList:null,items:undefined,month:null,visibleDate:undefined},methods:{set_month:function(n){this._month=n;this.updateList()},set_year:function(n){this._year=n;this.updateList()},set_visibleDate:function(n){n&&(this._visibleDate=n,this._year=n.getFullYear(),this._month=n.getMonth()+1,this.updateList(),AtomBinder.refreshValue(this,"year"),AtomBinder.refreshValue(this,"month"))},init:function(){n.init.apply(this);var t=this;this.toggleDateCommand=function(){t.toggleDate.apply(t,arguments)}},onLoaded:function(){var u=this.getTemplate("itemTemplate"),e=this.get_scope(),o=this._itemsPresenter,n=this.getTemplate("itemTemplate"),f,t,i,r,s;if(n&&(n=AtomUI.getAtomType(n),n||(n=WebAtoms.AtomControl)),this.updateList(),u)for(f=this._items,t=0;t<42;t++)i=AtomUI.cloneNode(u),i._templateParent=this,r=new p(this,e,atomApplication),r.itemIndex=t,$(o).append(i),s=AtomUI.createControl(i,n,f[t],r)},toggleDate:function(n,t){var i=t.get_data(),r=$.inArray(i.value,$.map(this._selectedItems,function(n){return n.value}));r>-1?AtomBinder.removeAtIndex(this._selectedItems,r):AtomBinder.addItem(this._selectedItems,i);AtomBinder.refreshValue(this,"value");AtomBinder.refreshValue(this,"selectedItems");this.invokeAction(this._next)},getItemClass:function(n){var r=$.inArray(n.value,$.map(this._selectedItems,function(n){return n.value}))>-1,i=n.date.getDay(),u=i==0||i==6,t="atom-date-list-box-day-list-item ";return t+=u?"atom-date-list-box-weekend ":"",t+=r?"atom-date-list-box-selected ":"atom-date-list-box-item ",t+(this._month==n.date.getMonth()+1?"":"atom-date-list-box-day-list-item-other")},set_value:function(n){var e,t,i,r,u;if(n!==undefined){if(this._selectedItems.length=0,n!==null)for(e=n.split(","),t=0;t<e.length;t++)(i=e[t],i)&&(r=i.split("/"),u=new Date(parseInt(r[2],10),parseInt(r[0],10)-1,parseInt(r[1],10)),this._selectedItems.push({date:u,dateLabel:f.toShortDateString(u),value:i,label:u.getDate()}));this._created&&(AtomBinder.refreshItems(this._selectedItems),AtomBinder.refreshValue(this,"value"),AtomBinder.refreshValue(this,"selectedItems"))}},get_value:function(){return $.map(this._selectedItems,function(n){return n.value}).join(",")},updateList:function(){var i;if(this._month&&this._year){var e=new Date,a=new Date(this._year,this._month-1,1),t=new Date(this._year,this._month-1,1);t.getDay()&&(i=t.getDay()-1,i=-i,t.setDate(i));for(var s=t.getMonth(),h=t.getFullYear(),o=[],r=0,c=this._month-1,r=0;r<42;r++){var l=r+t.getDate(),n=new Date(h,s,l),u=n.getDay();u=u==0||u==6;o.push({label:n.getDate(),isWeekEnd:u,isToday:e.getDate()==n.getDate()&&e.getMonth()==n.getMonth()&&e.getFullYear()==n.getFullYear(),isOtherMonth:n.getMonth()!=c,dateLabel:f.toShortDateString(n),value:f.toMMDDYY(n),date:n})}this._items=o;AtomBinder.refreshValue(this,"items");AtomBinder.refreshValue(this,"selectedItems");this._created&&AtomBinder.refreshValue(this,"value")}}}})}(WebAtoms.AtomControl.prototype),function(t){var r=n.AtomUI;return classCreatorEx({name:"WebAtoms.AtomDockPanel",base:t,start:function(n){$(n).addClass("atom-dock-panel")},properties:{resizeOnChildResized:!1,contentWidth:0},methods:{resizeChild:function(n){n.atomControl?n.atomControl.updateUI():this.updateChildUI(n)},calculateSize:function(){var e=this.get_element(),u=$(e),n={width:u.width(),height:u.height()},t,f,i,s,h;if(!this._resizeOnChildResized)return n;for(t=0,f=new ChildEnumerator(e);f.next();){i=f.current();s=r.attr(i,"atom-dock");switch(s){case"Bottom":case"Fill":case"Top":h=o.isIE&&o.majorVersion<10?i.offsetHeight:$(i).outerHeight(!0);t+=h}}return n.height<t&&(n.height=t,u.height(n.height)),n},onUpdateUI:function(){var v=this.get_element(),b=$(v),s=0,h=parseInt($(v).css("paddingTop"),10),p=this.calculateSize(),c=p.height,e=p.width,w,t,n,a,f,y,o,l,u;for(this._contentWidth&&(s=(e-this._contentWidth)/2,e=this._contentWidth),w=[],f={top:[],bottom:[],left:[],right:[],fill:[]},isScriptOrStyle=/script|style/i,y=new ChildEnumerator(v);y.next();)if(o=y.current(),!isScriptOrStyle.test(o.tagName)){if(l=$(o),l.is(".dock-left,[dock$='Left']")){f.left.push(o);continue}if(l.is(".dock-right,[dock$='Right']")){f.right.push(o);continue}if(l.is("header,.dock-top,[dock$='Top']")){f.top.push(o);continue}if(l.is("footer,.dock-bottom,[dock$='Bottom']")){f.bottom.push(o);continue}if(l.is("section,.dock-fill,[dock$='Fill']")){f.fill.push(o);continue}}for(t=new i(f.top);t.next();)n=t.current(),a=$(n).outerHeight(!0),r.setItemRect(n,{top:h,left:s,width:e}),h+=a,c-=a,this.resizeChild(n);for(t=new i(f.bottom.reverse());t.next();)n=t.current(),a=$(n).outerHeight(!0),c-=a,r.setItemRect(n,{left:s,top:h+c,width:e}),this.resizeChild(n);for(t=new i(f.left);t.next();)n=t.current(),u=$(n).outerWidth(!0),e-=u,r.setItemRect(n,{top:h,left:s,height:c}),s+=u,this.resizeChild(n);for(t=new i(f.right.reverse());t.next();)n=t.current(),u=$(n).outerWidth(!0),e-=u,r.setItemRect(n,{left:e+s,top:h,height:c}),this.resizeChild(n);for(t=new i(f.fill);t.next();)n=t.current(),u=$(n).css("max-width"),u&&(u=parseFloat(u),u>0&&(e=u)),r.setItemRect(n,{left:s,top:h,width:e,height:c}),this.resizeChild(n)}}})}(WebAtoms.AtomControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomPostButton",base:n,start:function(){},properties:{postData:null,postResult:null,postUrl:null,next:null,confirm:!1,confirmMessage:null,mergeData:null},methods:{get_postData:function(){return this._postData||this.get_data()},onClickHandler:function(n){if(this._confirm){var i=this;t.confirm(this._confirmMessage,function(){i.onConfirmed(n)});return}this.onConfirmed(n)},onConfirmed:function(){var t,i,f,u,e;if(!this._postUrl){n.onClickHandler.apply(this,arguments);return}if(t=this.get_postData(),t!==null&&t!==undefined){if(i=this._mergeData,i)for(f in i)t[f]=i[f];u=this;e=function(n){AtomBinder.setValue(u,"postResult",n.value());u.invokeAction(u._next)};r.json(this._postUrl,null,{type:"POST",data:t}).then(e).invoke()}}}})}(WebAtoms.AtomButton.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomToggleButtonBar",base:n,start:function(){this._allowSelectFirst=!0;this._allowMultipleSelection=!1;this._showTabs=!1;this._autoScrollToSelection=!1},properties:{showTabs:!1},methods:{setClass:function(){var n=$(this._element);n.removeClass("atom-tab-bar atom-toggle-button-bar");n.addClass(this._showTabs?"atom-tab-bar":"atom-toggle-button-bar")},set_showTabs:function(n){this._showTabs=n;this.setClass()}}})}(WebAtoms.AtomListBox.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomViewStack",base:n,start:function(){this._swipeDirection="left-right"},properties:{selectedIndex:-1,previousIndex:-1,swipeDirection:"left-right"},methods:{bringSelectionIntoView:function(){},set_swipeDirection:function(n){var t=this._swipeDirection;t&&$(this._element).removeClass(t);this._swipeDirection=n;n&&$(this._element).addClass(n)},set_selectedIndex:function(n){if(this._isAnimating){var t=this;setTimeout(function(){t.set_selectedIndex(n)},50);return}n!=this._selectedIndex&&(this._previousIndex=this._selectedIndex,this._selectedIndex=n,this.updateUI())},get_selectedChild:function(){return this._selectedChild},onUpdateUI:function(){var s=this._element,v=new ChildEnumerator(s),h=this.get_selectedIndex(),u=this._previousIndex,y=WebAtoms.dispatcher,r,n,t,f,e,i,p,l,c,a,o;for(y.pause(),r=-1,c=this;v.next();)r=r+1,f=v.current(),e=$(f),e.addClass("view-stack-child"),u==-1&&e.addClass("hidden"),r==h?n=f:r==u?t=f:e.addClass("hidden");n&&(i=$(s).innerWidth(),p=$(s).innerHeight(),this._selectedChild=n,AtomUI.setItemRect(n,{width:i,height:p}),l=n.atomControl,l&&l.updateUI(),t&&t!=n?(c=this,a=this._swipeDirection,a!=null&&/none/i.test(a)?($(t).addClass("hidden"),$(n).removeClass("hidden")):(o=[n,t],$(o).removeClass("hidden"),this._isAnimating=!0,h<u?$(n).css("left",-i):$(n).css("left",i),$(o).addClass("animate-left-property"),setTimeout(function(){$(n).css("left",0);h<u?$(t).css("left",i):$(t).css("left",-i);setTimeout(function(){c._isAnimating=!1;$(o).removeClass("animate-left-property");$(t).addClass("hidden")},800)},50))):$(n).removeClass("hidden"));y.start()},init:function(){var t=this.get_element();$(t).addClass("atom-view-stack");n.init.call(this);t=this.get_element();t.parentNode.atomControl||$(t).addClass("atom-view-stack-fill");$(t).addClass(this._swipeDirection)}}})}(WebAtoms.AtomControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomForm",base:n,start:function(){this._success=null;this._submit=null;this._errors=null;this._attachments=null},properties:{result:null,mergeData:null,mergeResult:!0,postUrl:null,postData:null,successMessage:null,clearData:!1,errorTemplate:null},methods:{createFormLayout:function(){},preparePostData:function(){var r=this.get_element(),i=this._postData||this.get_data(),n=this._mergeData,t;if(n)for(t in n)i[t]=n[t];return i},onSubmit:function(){var n=this.get_errors(),i,u;if(n&&n.length){this.invokeAction({localWindow:{path:this.getTemplate("errorTemplate"),prop:{data:n,title:"Form Errors"}}});return}i=this.preparePostData();u=r.getUrl(this._postUrl);r.json(u,{_tv:t.time()},{type:"POST",data:i}).then(this._success).invoke()},onSuccess:function(n){var r=n.value(),u,i;if(AtomBinder.setValue(this,"result",r),this._mergeResult){u=this.get_data();for(i in r)AtomBinder.setValue(u,i,r[i])}if(this._clearData){u=this.get_data();for(i in this._clearData)AtomBinder.setValue(u,i,r[i])}this._successMessage&&t.alert(this._successMessage);this.invokeAction(this._next)},onKeyUp:function(n){if((!n.target||!n.target.nodeName||!/textarea/gi.test(n.target.nodeName))&&n.keyCode==13){var t=this;/input/gi.test(n.target.nodeName)&&$(n.target).change();WebAtoms.dispatcher.callLater(function(){t.onSubmit()})}},isValid:function(){for(var r=this.get_element(),n=new ChildEnumerator(r),t=!0,i;n.next();)i=n.current(),this.validate(i)||(t=!1);return t},validateField:function(n){var t=n.target;this.validate(t)},validate:function(e,ef){var req,re,dt,ae,isValid;ef||(ef=$(e).data("field-error"));var ctrl=e.atomControl,val=null,skip=!1;if(ctrl){if(ctrl.constructor==WebAtoms.AtomFormField)return ctrl.validate();val=AtomBinder.getValue(ctrl,"value")}else/input|select|textarea/i.test(e.nodeName)?val=$(e).val():skip=!0;if(!skip){if(req=AtomUI.attr(e,"atom-required"),req&&!val)return AtomProperties.text(ef,"Required"),$(e).addClass("atom-data-error"),!1;if(re=AtomUI.attr(e,"atom-regex"),re)re=eval("("+re+")");else if(dt=AtomUI.attr(e,"atom-data-type"),dt)switch(dt){case"email":re=/^(([^<>()\[\]\\.,;:\s@\"]+(\.[^<>()\[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/}if(re&&!re.test(val))return $(ef).text("Invalid"),$(e).addClass("atom-data-error"),!1;$(ef).text("");$(e).removeClass("atom-data-error")}for(ae=new ChildEnumerator(e),isValid=!0;ae.next();)this.validate(ae.current(),ef)||(isValid=!1);return isValid},init:function(){var i,t;n.init.call(this);t=this;this._success=function(){t.onSuccess.apply(t,arguments)};this._submit=function(){WebAtoms.dispatcher.callLater(function(){t.onSubmit.apply(t,arguments)})};i=this.get_element();this.submitCommand=this._submit;this.bindEvent(i,"keyup","onKeyUp");$(i).find("input[type=submit]").bind("click",null,this._submit);$(i).find("button[type=submit]").bind("click",null,this._submit);t=this;this._vh=function(){t.validateField.apply(t,arguments)};$(i).find("input,select,textarea").bind("blur",null,this._vh)}}})}(WebAtoms.AtomControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomFormLayout",base:n,start:function(){this._useTable=!0;this._errorItems=[];this._minLabelWidth=0},properties:{minLabelWidth:0},methods:{createField:function(n,t){var s=!1,u=AtomUI.attributeMap(t,/^(atom\-(init|type|label|is\-valid|field\-(value|visible|class)|error))$/i),e=u["atom-type"],r,f,o,h,i,c;if(e){u["atom-type"]=null;switch(e.value){case"AtomFormField":s=!0;break;case"AtomFormGridLayout":case"AtomFormTab":return n.appendChild(t),AtomUI.createControl(t,e.value)}}if(r=AtomUI.cloneNode(this._fieldTemplate),f=AtomUI.findPresenter(r),f){if(s)for(o=new ChildEnumerator(t);o.next();)f.appendChild(o.current());else f.appendChild(t);AtomUI.removeAttr(f,"atom-presenter")}else r.contentElement=t;n.appendChild(r);for(h in u)(i=u[h],i)&&(t.removeAttributeNode(i.node),r.setAttributeNode(i.node));return u=AtomUI.attributeMap(r,/^atom\-(field\-value|is\-valid)$/i),u["atom-field-value"]||u["atom-is-valid"]||(i=AtomUI.attr(t,"atom-value"),i&&/^\$\[/gi.test(i)&&(i=i.substr(2),/^\$/gi.test(i)||(i="$"+i),i="["+i,c=i.indexOf("]"),i=i.substr(0,c+1),AtomUI.attr(r,"atom-field-value",i))),AtomUI.createControl(r,WebAtoms.AtomFieldType)},createChildren:function(){var n=this._element,r,t,f,e;for($(n).addClass("atom-form"),r=new i($(n).children()),t=u.createElement("TABLE"),$(t).addClass("atom-form-table"),f=u.createElement("TBODY"),AtomUI.removeAllChildren(n),n.appendChild(t),t.appendChild(f),this.getTemplate("fieldTemplate");r.next();)(e=r.current(),e)&&this.createField(f,e)}}})}(WebAtoms.AtomControl.prototype),function(){return classCreatorEx({name:"WebAtoms.AtomLayout",start:function(){},methods:{doLayout:function(){}}})}(),function(n){return classCreatorEx({name:"WebAtoms.AtomWindow",base:n,start:function(){this._presenters=["windowDiv","windowTitleDiv","windowCloseButton","iframe","windowPlaceholder"]},properties:{opener:null,openerData:null,windowTemplate:null,isOpen:!1,windowHeight:300,windowWidth:500,url:undefined,title:undefined,windowUrl:undefined,cancelNext:undefined},methods:{get_openerData:function(){var n=this.get_opener();if(n)return n.get_data()},onCloseCommand:function(){AtomBinder.setValue(this,"isOpen",!1);var t=this._value,n=this;this._value=null;WebAtoms.dispatcher.callLater(function(){AtomBinder.setValue(n,"value",t);n.invokeAction(n._next);n.disposeChildren(n._element)})},onCancelCommand:function(){AtomBinder.setValue(this,"isOpen",!1);var n=this;WebAtoms.dispatcher.callLater(function(){n.invokeAction(n._cancelNext);n.disposeChildren(n._element)})},refresh:function(n,t){this.openWindow(n,t)},openWindow:function(n,t){var u=this.getTemplate("frameTemplate"),f,r,e;u=AtomUI.cloneNode(u);var s=$(u),o=s.find("[data-atom-presenter=windowDiv],[atom-presenter=windowDiv]").get(0),h=s.find("[data-atom-presenter=windowTitleDiv],[atom-presenter=windowTitleDiv]").get(0),i=this.getTemplate("windowTemplate");if($(i).addClass("atom-window-template"),AtomUI.attr(i,"atom-dock")||AtomUI.attr(i,"atom-dock","Fill"),i.length)for(f=0;f<i.length;f++)o.appendChild(i[f]);else o.appendChild(i);r=this.getTemplate("commandTemplate");r&&(AtomUI.attr(r,"atom-dock","Bottom"),r.setAttribute("class","atom-wizard-command-bar"),o.appendChild(r));this.set_innerTemplate(u);this._iframe&&(this._iframe.atomWindow=this);t&&(this._opener=t,AtomBinder.refreshValue(this,"opener"),AtomBinder.refreshValue(this,"openerData"));e=this;WebAtoms.dispatcher.callLater(function(){var n,t;if(AtomBinder.setValue(e,"isOpen",!0),!e._url&&(n=$(e._windowPlaceholder).find("input"),n.length>0)){t=n.get(0);try{t.focus()}catch(i){}}})},init:function(){$(this._element).addClass("atom-window-placeholder");n.init.call(this);var t=this;this.closeCommand=function(){t.onCloseCommand.apply(t,arguments)};this.cancelCommand=function(){t.onCancelCommand.apply(t,arguments)};this.openCommand=function(){t.openWindow.apply(t,arguments)};WebAtoms.dispatcher.callLater(function(){var n=t._element;n._logicalParent||(n._logicalParent=n.parentNode,$(n).remove(),u.body.appendChild(n))})}}})}(WebAtoms.AtomControl.prototype);WebAtoms.AtomWindow.openNewWindow=function(n){var e=u.createElement("DIV"),h=AtomUI.assignID(e),r,i,o,s,f;n.localScope&&e.setAttribute("data-atom-local-scope","true");e._logicalParent=n.opener;u.body.appendChild(e);r=AtomUI.createControl(e,WebAtoms.AtomWindow);i=n.url;i.length!==undefined?(n.next=i[1],n.url=i[0],i=new AtomUri(n.url)):(i={path:i.path,query:i.prop,hash:i.scope},n.url.next&&(n.next=n.url.next));r._next=[n.next||{},function(){WebAtoms.dispatcher.callLater(function(){r.dispose();$(e).remove()})}];o=i.path;AtomUI.isNode(o)||(o=t.get(n.scope,i.path));s=$(AtomUI.cloneNode(o));f=s.children("[atom-template=commandTemplate],[data-atom-template=commandTemplate]").get(0);f&&(AtomUI.removeAttr(f,"atom-template"),r._commandTemplate=f,$(f).remove());f=s.children("[atom-template=windowTemplate],[data-atom-template=windowTemplate]").get(0);f?(AtomUI.removeAttr(f,"atom-template"),r._windowTemplate=f):(AtomUI.removeAttr(o,"atom-template"),r._windowTemplate=o);r.init();WebAtoms.dispatcher.callLater(function(){var o=r.get_scope(),e=i.hash,f;for(var u in e)e.hasOwnProperty(u)&&t.set(o,u,e[u]);f=i.query;for(u in f)f.hasOwnProperty(u)&&t.set(r,u,f[u]);r.openWindow(n.scope,n.opener)})},function(n){return classCreatorEx({name:"WebAtoms.AtomCalendar",base:n,start:function(n){$(n).addClass("atom-calendar");var t=new Date;this._month=t.getMonth()+1;this._year=t.getFullYear();this._startYear=-5;this._endYear=10;this._currentYear=(new Date).getFullYear();this._value=null},properties:{month:0,year:0,startYear:-5,endYear:0,currentYear:0,visibleDate:undefined},methods:{set_month:function(n){this._month=n;this.updateCalendar()},set_year:function(n){this._year=n;this.updateCalendar()},set_visibleDate:function(n){n&&n!=this._visibleDate&&(this._visibleDate=n,this._year=n.getFullYear(),this._month=n.getMonth()+1,this.updateCalendar(),AtomBinder.refreshValue(this,"year"),AtomBinder.refreshValue(this,"month"))},onCreated:function(){n.onCreated.call(this);var t=this;WebAtoms.dispatcher.callLater(function(){t.updateCalendar()})},applyItemStyle:function(){},updateCalendar:function(){var i;if(this._created){var e=new Date,a=new Date(this._year,this._month-1,1),t=new Date(this._year,this._month-1,1);t.getDay()&&(i=t.getDay()-1,i=-i,t.setDate(i));for(var s=t.getMonth(),h=t.getFullYear(),o=[],r=0,c=this._month-1,r=0;r<42;r++){var l=r+t.getDate(),n=new Date(h,s,l),u=n.getDay();u=u==0||u==6;o.push({label:n.getDate(),isWeekEnd:u,isToday:e.getDate()==n.getDate()&&e.getMonth()==n.getMonth()&&e.getFullYear()==n.getFullYear(),isOtherMonth:n.getMonth()!=c,dateLabel:f.toShortDateString(n),value:f.toMMDDYY(n),date:n})}AtomBinder.setValue(this,"items",o)}},changeMonth:function(n){var i=this._month;i+=n;i>12&&(i=1,t.set(this,"year",this._year+1));i==0&&(t.set(this,"year",this._year-1),i=12);AtomBinder.setValue(this,"month",i)},init:function(){n.init.call(this);var t=this;this.nextMonthCommand=function(){t.changeMonth(1)};this.prevMonthCommand=function(){t.changeMonth(-1)}}}})}(WebAtoms.AtomListBox.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomCheckBoxList",base:n,start:function(){this._allowMultipleSelection=!0;this._valueSeparator=", ";this._dataElements=[]},methods:{init:function(){n.init.call(this);$(this._element).addClass("atom-check-box-list")}}})}(WebAtoms.AtomItemsControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomDataPager",base:n,properties:{itemsPath:"items",totalPath:"total",pageSize:25,currentPage:0,items:null,total:0,pages:[]},start:function(){this._presenters=["pageList"];var n=this,t=AtomBinder;this.goFirstCommand=function(){t.setValue(n,"currentPage",0)};this.goLastCommand=function(){t.setValue(n,"currentPage",n._pages.length-1)};this.goNextCommand=function(){t.setValue(n,"currentPage",n.get_currentPage()+1)};this.goPrevCommand=function(){t.setValue(n,"currentPage",n.get_currentPage()-1)}},methods:{preparePages:function(){var u,t,n;if(this._items&&this._total&&this._pageSize){var f=this._items.length,r=this._total,i=Math.ceil(r/this._pageSize);if(i!=this._pages.length){for(u=this._pageSize,t=[],n=0;n<i;n++)t.push({value:n,label:n+1});AtomBinder.setValue(this,"pages",t)}}},set_items:function(n){if((n!=this._items&&this._items&&this.unbindEvent(this._items,"CollectionChanged","onCollectionChangedInternal"),n)&&(this._items=n,n!=null&&this._created)){this.bindEvent(this._items,"CollectionChanged","onCollectionChangedInternal");this.onCollectionChangedInternal("refresh",-1,null)}},onCollectionChangedInternal:function(){var n=this._items,t;n.length===undefined?(t=n[this._itemsPath],AtomBinder.setValue(this,"total",n[this._totalPath]),AtomBinder.setValue(this,"value",t)):(n.total&&AtomBinder.setValue(this,"total",n.total),AtomBinder.setValue(this,"value",n));this.preparePages()},onCreated:function(){if(this._items){this.bindEvent(this._items,"CollectionChanged","onCollectionChangedInternal");this.onCollectionChangedInternal("refresh",-1,null)}},set_currentPage:function(n){this._currentPage=n;AtomBinder.refreshValue(this,"pageStart")},get_pageStart:function(){return this._currentPage*this._pageSize},set_pageSize:function(n){this._pageSize=n;this.preparePages()},set_total:function(n){this._total!=n&&(this._total=n)},init:function(){$(this._element).addClass("atom-data-pager");n.init.apply(this,arguments)}}})}(WebAtoms.AtomControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomDateControl",base:n,start:function(){},properties:{startYear:-1,endYear:10},methods:{resetYears:function(){var i=this._year,t=new Date,f=t.getFullYear(),e,r,u,n;for(f+=this._startYear,e=t.getFullYear()+this._endYear,r=this._value,r||(r=t),i.options.length=0,u=1,i.options[0]=new Option("Select","",!1,!1),t=(this._value||new Date).getFullYear(),n=f;n<=e;n++)i.options[u]=new Option(n,n,!1,t==n),u++},set_value:function(n){n&&n.constructor==String&&(n=new Date(parseInt(n.substr(6))));this._value=n;this.setDate()},setDate:function(){if(this._value){var n=this._value,t=n.getMonth()+1,i=n.getDate(),r=n.getFullYear();this.setComboValue(this._month,t);this.setComboValue(this._year,r);this.setComboValue(this._date,i)}},setComboValue:function(n,t){for(var r=new i(n.options);r.next();)if(r.current().value==t){n.selectedIndex=r.currentIndex();break}},set_startYear:function(n){this._startYear=n;this.resetYears()},set_endYear:function(n){this._endYear=n;this.resetYears()},onDataChange:function(){var n=$(this._year).val(),i=$(this._month).val(),r=$(this._date).val(),u;try{n&&i&&r?(u=new Date(n,i-1,r,9,0,0),this._value=u):this._value=null}catch(f){t.alert(f)}AtomBinder.refreshValue(this,"value")},setMonths:function(){var u=f.monthList,t=this._month.options,n,r;for(t.length=0,n=new i(u),t[0]=new Option("Select","",!1,!1);n.next();)r=n.current(),t[n.currentIndex()+1]=new Option(r.label,r.value,!1,!1);this.setDate();AtomBinder.refreshValue(this,"value")},init:function(){var i=this._element,r,t;for(this._date=u.createElement("SELECT"),this._month=u.createElement("SELECT"),this._year=u.createElement("SELECT"),i.style.height="25px",i.appendChild(this._date),i.appendChild(this._month),i.appendChild(this._year),r=this._date.options,r[0]=new Option("Select","",!1,!1),t=1;t<32;t++)r[t]=new Option(t,t,!1,!1);this.resetYears();this.bindEvent(this._date,"change","onDataChange");this.bindEvent(this._month,"change","onDataChange");this.bindEvent(this._year,"change","onDataChange");this.setMonths();n.init.apply(this,arguments)}}})}(WebAtoms.AtomControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomDateField",base:n,start:function(n){this._presenters=["calendarPresenter","itemsPresenter"];$(n).addClass("atom-date-field")},properties:{isOpen:!1,time:"9:00 AM"},methods:{get_offsetLeft:function(){return $(this._element).offset().left},get_offsetTop:function(){return $(this._element).offset().top},onPopupRemoved:function(){AtomBinder.setValue(this,"isOpen",!1)},set_isOpen:function(n){if(this._isOpen=n,n){this.getTemplate("popupTemplate");this.popup=AtomUI.cloneNode(this._popupTemplate);this.popup._logicalParent=this._element;this.popup._templateParent=this;u.body.appendChild(this.popup);this.onCreateChildren(this.popup);this.setProperties(this.popup);this.initChildren(this.popup);var i=this;this._refreshInterval=setInterval(function(){AtomBinder.refreshValue(i,"offsetLeft");AtomBinder.refreshValue(i,"offsetTop")});a.show(this._element,this.popup,-1,function(){t.set(i,"isOpen",!1)})}else this._refreshInterval&&clearInterval(this._refreshInterval),this.popup&&(this.disposeChildren(this.popup),$(this.popup).remove(),this.popup=null)},dispose:function(){this.set_isOpen(!1);n.dispose.call(this)},get_isOpen:function(){return this._isOpen},get_selectedItem:function(){return this._selectedItems.length?this._selectedItems[0]:null},set_time:function(n){if(!this._set_timeCalled){if(this._set_timeCalled=!0,n){this._time=n;var t=f.setTime(this.get_value(),n);AtomBinder.setValue(this,"value",t)}this._set_timeCalled=!1}},set_value:function(n){n=f.parse(n);this._value=n;AtomBinder.setValue(this,"time",f.toTimeString(n));this._selectedItems.length=0;n&&(this._selectedItems.push({date:n,dateLabel:f.toShortDateString(n),value:f.toMMDDYY(n),label:n.getDate()}),this.set_visibleDate(n));this._created&&(AtomBinder.refreshItems(this._selectedItems),AtomBinder.refreshValue(this,"value"),AtomBinder.refreshValue(this,"selectedItem"),AtomBinder.refreshValue(this,"selectedItems"))},get_value:function(){return this._selectedItems.length?this._selectedItems[0].date:this._value},toggleDate:function(n,t){var i=t.get_data();this._selectedItems.length=0;AtomBinder.addItem(this._selectedItems,i);AtomBinder.refreshValue(this,"value");AtomBinder.refreshValue(this,"selectedItem");AtomBinder.refreshValue(this,"selectedItems");AtomBinder.setValue(this,"isOpen",!1)}}})}(WebAtoms.AtomDateListBox.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomDeleteButton",base:n,start:function(){this._confirm=!0;this._confirmMessage="Are you sure you want to delete this item?"},methods:{},properties:{}})}(WebAtoms.AtomPostButton.prototype),function(n){return createClass({name:"WebAtoms.AtomFrameView",base:n,start:function(n){var t=this;$(n).addClass("atom-frame-view");this._items=[];this._layout=WebAtoms.AtomViewBoxLayout.defaultInstance;this.backCommand=function(){t.onBackCommand.apply(t,arguments)}},properties:{url:"",replaceUrl:"",layout:null,items:[],removeOnBack:!0},methods:{set_replaceUrl:function(n){var r=new i(this._items),t;for(this.set_url(n);r.next();)t=r.current(),t.url!=n&&this.replaceItemWithUrl(t)},set_url:function(n){var f,r,c,i,h;if(n){if(/replace\:/.test(n)){this.set_replaceUrl(n.substr(8));this._url=n;return}var e=n.indexOf("?"),u=n,o="",s=this;if(e!==-1&&(u=n.substr(0,e),o=n.substr(e+1)),f=this._items,r=t.query(f).firstOrDefault({url:u}),r)t.set(this,"selectedIndex",r.index),this.updateUI();else{if(c=t.get(this,"scope"),i=c[u],!i){console&&console.error&&console.error("Page Template "+i+" not found");return}i=AtomUI.cloneNode(i);i._logicalParent=this._element;r={url:u,index:f.length,opener:this._url,element:i};t.add(f,r);h=AtomUI.createControl(i,AtomUI.getAtomType(i)||WebAtoms.AtomControl);r.control=h;WebAtoms.dispatcher.callLater(function(){h.init();s._element.appendChild(i);t.set(s,"selectedIndex",r.index);s.updateUI()})}o&&this.invokeAction({appScope:AtomUI.parseUrl(o)});this._url=n}},replaceItemWithUrl:function(n,t){if(t&&this.set_url(t),n){var i=this;setTimeout(function(){i.removeItem(n)},1e3)}},removeItem:function(n){t.remove(this._items,n);n.control.dispose();$(n.element).remove();for(var r=new i(this._items);r.next();)n=r.current(),n.index=r.currentIndex()},onBackCommand:function(){var n=this._selectedIndex,i,r;n&&(i=t.query(this._items).firstOrDefault({index:n}),i&&(r=this,n=n-1,t.set(this,"selectedIndex",n),r._removeOnBack&&this.replaceItemWithUrl(i,i.opener)))},init:function(){n.init.call(this);var i=this,t=this._url;t&&WebAtoms.dispatcher.callLater(function(){i.set_url(t)})}}})}(WebAtoms.AtomViewStack.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomLinkBar",base:n,start:function(){this._allowSelectFirst=!1;var n=this;this.openMenuCommand=function(){n.openMenu.apply(n,arguments)}},properties:{itemsPath:"items",selectCurrent:!0,targetPath:"",menuTemplate:null,menuDirection:"horizontal"},methods:{setClass:function(){var n=$(this._element);n.removeClass("atom-tab-bar atom-link-bar");n.addClass(this._showTabs?"atom-tab-bar":"atom-link-bar")},set_menuDirection:function(n){var t=$(this._element);t.removeClass("vertical horizontal");t.addClass(n);this._menuDirection=n},onClick:function(){},openMenu:function(n){var e=n.target,f=this.get_atomParent(e),r,t,i;f!=null&&(r=f.get_data(),r[this._itemsPath])&&(t=this._subMenu,t?a.hide(t._element):(i=this.getTemplate("menuTemplate"),t=AtomUI.cloneNode(i),t._templateParent=this,t.style.position="absolute",u.body.appendChild(t),i=AtomUI.getAtomType(i)||WebAtoms.AtomControl,t=AtomUI.createControl(t,i,r),this._subMenu=t),AtomBinder.setValue(t,"data",r),a.show(f._element,t._element,0),AtomUI.cancelEvent(n))},selectDefault:function(){this._items&&this._selectCurrent&&(this._value||(AtomBinder.setValue(this,"value",location.pathname),this.get_selectedIndex()==-1&&this.selectItem(this._items),this.updateSelectionBindings()))},selectItem:function(n,t){for(var f=new i(n),e=this._valuePath,o=location.pathname.toLowerCase(),r,u;f.next();)if(r=f.current(),u=r,e&&(u=u[e]),u){if(o==u.toLowerCase())return t||AtomBinder.setValue(this,"selectedItem",r),!0;if(r.links&&this.selectItem(r.links,!0))return AtomBinder.setValue(this,"selectedItem",r),!0}return!1},dispose:function(){this._subMenu&&(this._subMenu.dispose(),this._subMenu=null);n.dispose.apply(this,arguments)},init:function(){n.init.apply(this,arguments);this.bindEvent(this._element,"click","openMenuCommand");this.set_menuDirection("horizontal")}}})}(WebAtoms.AtomToggleButtonBar.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomMultiButtonList",base:n,start:function(){this._dataElements=[]},properties:{labelPath:"label",valuePath:"value",options:null,isRadio:!1,items:null},methods:{set_options:function(n){if(this._options=n,n)this.onCollectionChangedInternal("refresh",-1,null)},set_value:function(n){this._value=n;this.updateSelections()},set_items:function(n){if(this._items&&this.unbindEvent(this._items,"CollectionChanged","onCollectionChangedInternal"),this._items=n,n!=null){this.bindEvent(this._items,"CollectionChanged","onCollectionChangedInternal");this.onCollectionChangedInternal("refresh",-1,null)}},onCollectionChangedInternal:function(n,t,i){var r=this.get_value();this.onCollectionChanged(n,t,i);this.set_value(r)},onCollectionChanged:function(){var n,t,r;if(this._items&&this._options){for(this._dataElements=[],this.unbindEvent(null,"change","onDataChange"),n=new i(this._items),t=this.get_scope();n.next();)r=n.current(),this.createChildElement(t,this._element,r);this.updateUI()}},updateSelections:function(){var f,r,n,t,e,u;if(this._dataElements&&this._dataElements.length!=0){for(n=new i(this._dataElements);n.next();)f=n.current(),f.checked=!1;if(this._value)for(e=this._value.split(","),n.reset();n.next();)for(u=n.current(),r=new i(e);r.next();)t=r.current(),t=$.trim(t),u.value==t&&(u.checked=!0)}},onDataChange:function(){for(var t=new i(this._dataElements),r=[],n,u;t.next();)n=t.current(),u=$(n).val(),n.checked&&r.push(u);this._value=r.join(", ");AtomBinder.refreshValue(this,"value")},createChildElement:function(n,t,r){var f=u.createElement("SPAN"),h,o,c,a,s,y,e,p;for(t.appendChild(f),t=f,f=u.createElement("SPAN"),h=this.get_labelPath(),o=this.get_valuePath(),l=r,v=r,h&&(l=r[h]),o&&(v=r[o]),c=null,this._isRadio&&(c="_g"+AtomUI.getNewIndex()),t.appendChild(f),a=new i(this._options);a.next();)s=a.current(),o&&(s=s[o]),y=v+"."+s,e=u.createElement("INPUT"),this._isRadio?(AtomUI.attr(e,"type","radio"),AtomUI.attr(e,"name",c)):AtomUI.attr(e,"type","checkbox"),$(e).val(y),f.appendChild(e),this.bindEvent(e,"change","onDataChange"),this._dataElements.push(e);f=u.createElement("SPAN");t.appendChild(f);p=u.createTextNode(l);f.appendChild(p)}}})}(WebAtoms.AtomControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomNavigatorList",base:n,start:function(){this._displayMode=0;this._presenters=["gridPanel","gridPresenter","itemsPresenter","detailHeaderPresenter","newHeaderPresenter","detailPresenter","newPresenter","newView","detailView","newHeaderToolbar","detailHeaderToolbar"];this._layout=new WebAtoms.AtomViewBoxLayout;this._newItem={}},properties:{autoShowDetail:!0,currentPage:null,pageSize:undefined,newItem:null,newUrl:null,detailUrl:null,displayMode:null},methods:{get_newItemCopy:function(){return this._newItemCopy},onBackCommand:function(){AtomBinder.setValue(this,"displayMode",0);this.updateDisplayMode();AtomBinder.setValue(this,"selectedIndex",-1)},onCancelAddNewCommand:function(){this.onBackCommand();AtomBinder.refreshValue(this,"newItemCopy");this.refresh()},onAddCommand:function(){AtomBinder.setValue(this,"selectedIndex",-1);AtomBinder.setValue(this,"displayMode",2);var n=this._newItem||{};this._newItemCopy=AtomBinder.getClone(n);AtomBinder.refreshValue(this,"newItemCopy");this.updateDisplayMode()},onSelectedItemsChanged:function(){n.onSelectedItemsChanged.apply(this,arguments);this._autoShowDetail&&this.showDetailCommand()},addTemplate:function(n,t,i){if(i){n.appendChild(t);t._templateParent=this;this.onCreateChildren(n);this.initChildren(n)}else{n.appendChild(t);t._templateParent=this;this.onCreateChildren(n)}},updateDisplayMode:function(){var f=this._displayMode;if(f==0){this._detailPresenter&&(this._detailView.atomControl.dispose(this._detailPresenter),this._detailPresenter=null);this._newPresenter&&(this._newView.atomControl.dispose(this._newPresenter),this._newPresenter=null);this._detailHeaderPresenter&&(this._detailView.atomControl.dispose(this._detailHeaderPresenter),this._detailHeaderPresenter=null);this._newHeaderPresenter&&(this._newView.atomControl.dispose(this._newHeaderPresenter),this._newHeaderPresenter=null);return}var i=null,t=this.getTemplate("detailTemplate"),r=null,n,u="";f==1?(i=this._detailView,r=this._detailHeaderToolbar,n=this.getTemplate("detailHeaderTemplate"),u="_detail"):(i=this._newView,r=this._newHeaderToolbar,n=this.getTemplate("newHeaderTemplate"),u="_new");r&&n&&(n=AtomUI.cloneNode(n),this.addTemplate(r,n,!0),this[u+"HeaderPresenter"]=n);i&&t&&(t=AtomUI.cloneNode(t),this.addTemplate(i,t,!0),this[u+"Presenter"]=t)},createChildren:function(){var r,f,u,t,i;n.createChildren.call(this);this.getTemplate("gridTemplate");this.getTemplate("detailTemplate");this.getTemplate("searchTemplate");this.getTemplate("detailHeaderTemplate");this.getTemplate("newHeaderTemplate");this.getTemplate("headerTemplate");this.getTemplate("footerTemplate");r=this.get_scope();this._newView.atomControl._scope=new p(this,r);this._detailView.atomControl._scope=new p(this,r);f=AtomUI.cloneNode(this._gridTemplate);this.addTemplate(this._gridPresenter,f);u=this._detailTemplate;AtomUI.attr(u,"atom-dock")||AtomUI.attr(u,"atom-dock","Fill");this._headerTemplate&&(t=AtomUI.cloneNode(this._headerTemplate),t.setAttribute("atom-dock","Top"),$(t).addClass("atom-navigator-list-header"),t._templateParent=this,this.addTemplate(this._gridPanel,t));this._footerTemplate&&(i=AtomUI.cloneNode(this._footerTemplate),i.setAttribute("atom-dock","Bottom"),$(i).addClass("atom-navigator-list-footer"),this.addTemplate(this._gridPanel,i))},init:function(){n.init.call(this);var t=this;this.backCommand=function(){t.onBackCommand.apply(t,arguments)};this.addCommand=function(){t.onAddCommand.apply(t,arguments)};this.cancelAddCommand=function(){t.onCancelAddNewCommand.apply(t,arguments)};this.showDetailCommand=function(){var n=t.get_selectedItem();n&&(AtomBinder.setValue(t,"displayMode",1),t.updateDisplayMode())}}}})}(WebAtoms.AtomListBox.prototype),function(t){var i=n.AtomUI;return classCreatorEx({name:"WebAtoms.AtomNumberComboBox",base:t,start:function(){},properties:{showPrompt:!1,startNumber:undefined,endNumber:undefined,step:1},methods:{set_startNumber:function(n){this._startNumber=n;this.resetNumbers()},set_endNumber:function(n){this._endNumber=n;this.resetNumbers()},set_step:function(n){n&&(this._step=n,this.resetNumbers())},onLoaded:function(){this.resetNumbers()},resetNumbers:function(){if(this._created&&this._startNumber!==undefined&&this._endNumber!==undefined){var n=i.toNumber(this._startNumber),r=i.toNumber(this._endNumber),u=i.toNumber(this._step),t=[];for(this._showPrompt&&t.push({label:"Select",value:0});n<=r;n+=u)t.push({label:n,value:n});this.set_items(t)}}}})}(WebAtoms.AtomComboBox.prototype),function(t){var u=n.document,r=n.$;return classCreatorEx({name:"WebAtoms.AtomPhoneControl",base:t,start:function(){this._value=""},properties:{countries:[{label:"(US +1)",code:1,country:"US",format:"999-999-9999"},{label:"(CA +1)",code:1,country:"CA",format:"999-999-9999"},{label:"(IN +91)",code:91,country:"IN",format:"99-99-999999"},{label:"(UK +44)",code:44,country:"UK",format:"999-999-9999"},]},methods:{set_value:function(n){this._value=n;this._countries&&this.setupValues()},setupValues:function(){var f,t;if(!this._value){r(this.num).val("");r(this.ext).val("");r(this.msg).val("");return}for(var n=this._value.split(":",6),e=n[1],u=new i(this._countries);u.next();)if(f=u.current(),f.country==e){this.cs.selectedIndex=u.currentIndex();break}t=(n[3]||"").split(".").join("-");t=="--"&&(t="");r(this.num).val(t);r(this.ext).val(n[4]);r(this.msg).val(n[5]);this.onFormat()},onDataChange:function(){var n="v2:",u=this.cs.selectedIndex,i=this._countries[u],t;n+=i.country+":"+i.code;t=r(this.num).val().split("-").join(".");n+=":"+t;n+=":"+r(this.ext).val();n+=":"+r(this.msg).val();this._value=t?n:"";AtomBinder.refreshValue(this,"value")},set_countries:function(n){this._countries=n;this.onFormat()},onCountryChange:function(){this.onDataChange();this.onFormat()},onFormat:function(){var e,u,t,f,n;if(!this._isFormatting){for(this._isFormatting=!0,e=this._countries,u=this.cs.options,u.length=0,t=new i(e);t.next();)n=t.current(),n.valueIndex||(n.label=n.label,n.valueIndex=t.currentIndex()),u[t.currentIndex()]=new Option(n.label,n.valueIndex,!1,!1);(this.setupValues(),f=this.cs,f.selectedIndex!=-1)&&(n=this._countries[f.selectedIndex],n.format?r(this.num).mask(n.format):r(this.num).unmask(),this._isFormatting=!1)}},init:function(){var n,i,f;this.cs=u.createElement("SELECT");this.num=u.createElement("INPUT");this.num.type="text";this.ext=u.createElement("INPUT");this.ext.type="text";r(this.ext).attr("placeholder","Ext.");this.msg=u.createElement("INPUT");this.msg.type="text";r(this.msg).attr("placeholder","Message");n=this.get_element();n.appendChild(this.cs);n.appendChild(this.num);n.appendChild(this.ext);n.appendChild(this.msg);i=this;this.onKeyUpLater=function(n){var t=n;i.onDataChange(t)};this.bindEvent(this.cs,"change","onCountryChange");this.bindEvent(this.num,"change","onDataChange");this.bindEvent(this.num,"keyup","onKeyUpLater");this.bindEvent(this.num,"keypress","onKeyUpLater");this.bindEvent(this.ext,"change","onDataChange");this.bindEvent(this.msg,"change","onDataChange");r(this._element).addClass("atom-phone-control");r(this.num).addClass("atom-pc-num");r(this.msg).addClass("atom-pc-msg");r(this.cs).addClass("atom-pc-cs");r(this.ext).addClass("atom-pc-ext");t.init.call(this);f=this;WebAtoms.dispatcher.callLater(function(){f.onFormat()})}}})}(WebAtoms.AtomControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomRadioButtonList",base:n,start:function(){this._allowMultipleSelection=!1},properties:{groupName:""},methods:{init:function(){this._groupName="__g"+AtomUI.getNewIndex();n.init.call(this)}}})}(WebAtoms.AtomItemsControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomSortableColumn",base:n,start:function(){},properties:{direction:"",defaultDirection:"",label:"",sortField:null},methods:{set_direction:function(n){this._direction=n;var t=$(this._element);t.removeClass("atom-sort-asc atom-sort-desc");n&&t.addClass("atom-sort-"+n.toLowerCase())},set_value:function(n){this._value=n;this.refreshUI()},refreshUI:function(){if(this._value){if(this._value.indexOf(this._sortField)==-1){AtomBinder.setValue(this,"direction","");return}this._value.lastIndexOf("desc")!=this._value.length-4?AtomBinder.setValue(this,"direction","asc"):AtomBinder.setValue(this,"direction","desc")}},onClick:function(){this._direction?this._direction=="asc"?AtomBinder.setValue(this,"direction","desc"):AtomBinder.setValue(this,"direction","asc"):AtomBinder.setValue(this,"direction",this._defaultDirection);AtomBinder.setValue(this,"value",this._sortField+" "+this._direction)},init:function(){n.init.call(this);this.bindEvent(this._element,"click","onClick");$(this._element).addClass("atom-column")},onUpdateUI:function(){this.refreshUI()}}})}(WebAtoms.AtomControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomTabButtonBar",base:n,start:function(){this._allowMultipleSelection=!1;this._showTabs=!0},methods:{}})}(WebAtoms.AtomLinkBar.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomTabControl",base:n,start:function(){this._presenters=["itemsPresenter"];this._layout=WebAtoms.AtomViewBoxLayout.defaultInstance;this.selectedIndex=0;this.labelPath="label"},properties:{items:null},methods:{createChildren:function(){var r,t,u,f;if(n.createChildren.call(this),this._itemsPresenter!=this._element){for(r=[],t=new ChildEnumerator(this._element);t.next();)u=t.current(),this._element.removeChild(u),r.push(u);if(this._template){f=AtomUI.cloneNode(this._template);f._templateParent=this;this._element.appendChild(f);this.onCreateChildren(this._element)}for(t=new i(r);t.next();)this._itemsPresenter.appendChild(t.current());if(this._template)this.onCreateChildren(this._itemsPresenter)}}}})}(WebAtoms.AtomControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomTimePicker",base:n,start:function(){w("AtomTimePicker is Depricated !!!, use AtomTimeEditor")},properties:{displayLabel:"9:00 AM"},methods:{init:function(){var r,t,u,f,i;for(this._autoOpen=!0,r=[],t=0;t<=23;t++)u="AM",f=t,t>11&&(u="PM",t>12&&(f=t-12)),i=f+":00 "+u,r.push({label:i,value:i}),i=f+":30 "+u,r.push({label:i,value:i});this._items=r;n.init.call(this)}}})}(WebAtoms.AtomAutoCompleteBox.prototype);et=function(n){this._self=n;this._updating=!1;this.update=function(n){if(!this._updating)try{this._updating=!0;n.apply(this._self)}finally{this._updating=!1}}},function(n){var i=/^([0-1]?[0-9]|2[0-3]):[0-5][0-9] [ap][m]$/i;return classCreatorEx({name:"WebAtoms.AtomTimeEditor",base:n,start:function(n){$(n).addClass("atom-time-editor");this._updater=new et(this)},properties:{time:"10:00",ap:"AM",value:"10:00 AM"},methods:{get_hours24:function(){var t=this._time.split(":"),n=parseInt(t[0]||"0");return this._ap=="PM"&&n!=12&&(n+=12),n},set_hours24:function(n){this.setTime(n,this.get_minutes())},get_hours:function(){var n=this._time.split(":");return parseInt(n[0]||"0")},get_minutes:function(){var n=this._time.split(":");return parseInt(n[1]||"0")},setTime:function(n,t,i){var r=this.get_ap();i&&n>12&&(n-=12,r="PM");n=""+n;n.length==1&&(n="0"+n);t=t+"";t.length==1&&(t="0"+t);AtomBinder.setValue(this,"value",n+":"+t+" "+r)},set_hours:function(n){this.setTime(n,this.get_minutes())},set_minutes:function(n){this.setTime(this.get_hours(),n)},set_value:function(n){this._updater.update(function(){if(this._value!=n){if(!i.test(n))throw new Error("Unknown time format, expecting ##:## AM");this._value=n;n=n.split(" ");this._time=n[0];this._ap=n[1].toUpperCase();this.refreshProperties()}})},refreshProperties:function(){t.refresh(this,"value");t.refresh(this,"time");t.refresh(this,"ap");t.refresh(this,"hours");t.refresh(this,"hours24");t.refresh(this,"minutes")},set_time:function(n){this.set_value(n+" "+this._ap)},set_ap:function(n){this.set_value(this._time+" "+n)},get_value:function(){return this._time+" "+this._ap}}})}(WebAtoms.AtomControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomUploadButton",base:n,start:function(n){if(/input/gi.test(n.nodeName)&&/file/gi.test(AtomUI.attr(n,"type"))){this._filePresenter=n;return}var t=this._filePresenter=u.createElement("input");AtomUI.attr(t,"type","file");$(t).css({left:"-500px",position:"absolute",top:"0"});u.body.appendChild(this._filePresenter)},properties:{fileTypes:undefined,accept:"*/*",capture:"",progress:0},methods:{set_accept:function(n){if(this._accept=n,n){var t=this._filePresenter;t&&AtomUI.attr(t,"accept",n)}},set_capture:function(n){if(this._capture=n,n){var t=this._filePresenter;t&&AtomUI.attr(t,"capture",n)}},onClickHandler:function(n){(!this._confirm||confirm(this._confirmMessage))&&this._postUrl&&this._filePresenter!=this._element&&($(this._filePresenter).trigger("click"),AtomUI.cancelEvent(n))},onFileSelected:function(){var t=this.get_postData(),r,o,n,u,f,e;if(t!==null&&t!==undefined){if(r=this._mergeData,r)for(o in r)t[o]=r[o];if(n=this._xhr,!n){n=new XMLHttpRequest;u=n.upload;try{n.timeout=36e5}catch(s){}this.bindEvent(u,"progress","onProgress");this.bindEvent(u,"timeout","onError");this.bindEvent(u,"error","onError");this.bindEvent(n,"load","onComplete");this.bindEvent(n,"error","onError");this.bindEvent(n,"timeout","onError");this._xhr=n}for(f=new FormData,e=new i(this._filePresenter.files);e.next();)f.append("file"+e.currentIndex(),e.current());f.append("formModel",JSON.stringify(AtomBinder.getClone(t)));n.open("POST",this._postUrl);n.send(f);atomApplication.setBusy(!0,"Uploading...")}},set_progress:function(n){this._progress=n;n&&AtomBinder.setValue(atomApplication,"progress",n)},onError:function(n){atomApplication.setBusy(!1,"Uploading...");this.unbindEvent(this._xhr);this._xhr=null;this._lastError=n;t.alert("Upload failed")},onProgress:function(n){if(n.lengthComputable){var t=Math.round(n.loaded*100/n.total);AtomBinder.setValue(this,"progress",t)}},onComplete:function(n){atomApplication.setBusy(!1,"Uploading...");if(n.target)if(n.target.status==200)this._value=n.target.responseText;else{t.alert(n.target.statusText);return}else this._value=n.result;this.unbindEvent(this._xhr);this._xhr=null;AtomBinder.refreshValue(this,"value");this.invokeAction(this._next,n)},init:function(){n.init.call(this);var t=this._filePresenter;this.bindEvent(t,"change","onFileSelected")}}})}(WebAtoms.AtomPostButton.prototype),function(n,t){return classCreatorEx({name:"WebAtoms.AtomViewBox",base:t,start:function(){this._layout=n.AtomViewBoxLayout.defaultInstance},methods:{}})}(WebAtoms,WebAtoms.AtomControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomWizard",base:n,start:function(){this._presenters=["viewPresenter"]},properties:{currentStep:null,nextLabel:"Next",nextClass:"",buttons:null,prevLabel:"Back",finishLabel:"Finish",canMoveBack:!0,canMoveNext:!0,steps:0,isLastStep:!1},methods:{set_currentStep:function(n){var t,i;this._currentStep=n;t=this._buttons;t&&t.length&&(i=t[n],AtomBinder.setValue(this,"nextLabel",i.label),AtomBinder.setValue(this,"nextClass",i.styleClass));AtomBinder.refreshValue(this,"isLastStep")},get_isLastStep:function(){return this._currentStep==this._steps-1},createWizard:function(){var r=this._viewPresenter,n,t,f,e;this.disposeChildren(r);for(var o=this._viewTemplate,i=0,u=new ChildEnumerator(o);u.next();)i++,n=AtomUI.cloneNode(u.current()),r.appendChild(n),t=AtomUI.getAtomType(n),t||(t="AtomViewBox",AtomUI.attr(n,"data-atom-type",t)),f=AtomUI.getAtomType(n)||WebAtoms.AtomControl,e=AtomUI.createControl(n,f),e.init();AtomBinder.setValue(this,"steps",i);i&&AtomBinder.setValue(this,"currentStep",0)},init:function(){$(this._element).addClass("atom-wizard");n.init.call(this);var t=this,i=this._viewPresenter;this.goNextCommand=function(n,i,r){t.get_isLastStep()?(t.invokeAction(t._next,r),AtomBinder.setValue(t,"canMoveBack",!1)):AtomBinder.setValue(t,"currentStep",t._currentStep+1)};this.goPrevCommand=function(){AtomBinder.setValue(t,"currentStep",t._currentStep-1)};this.resetCommand=function(){t.createWizard();AtomBinder.setValue(t,"currentStep",0);AtomBinder.setValue(t,"canMoveBack",!0)};this.createWizard();this.nextCommand=function(n,r,u){var f=i.atomControl.get_selectedChild().atomControl;if(f._next){f.invokeAction(f._next);return}t.goNextCommand(n,r,u)}}}})}(WebAtoms.AtomDockPanel.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomYesNoControl",base:n,start:function(){this._allowSelectFirst=!1;this._items=[{label:"Yes",value:!0},{label:"No",value:!1}]},methods:{}})}(WebAtoms.AtomToggleButtonBar.prototype),function(t){return classCreatorEx({name:"WebAtoms.AtomYesNoCustom",base:t,start:function(){this._presenters=["yesNo","input"];this._hasValue=!1},properties:{hasValue:!1,placeholder:null},methods:{set_hasValue:function(n){this._hasValue=n;n||AtomBinder.setValue(this,"value","")},set_value:function(n){this._value=n;AtomBinder.setValue(this,"hasValue",n?!0:!1);this._onUIChanged||$(this._input).val(n)},onValueChange:function(){this._onUIChanged=!0;var n=$(this._input).val();AtomBinder.setValue(this,"value",n);this._onUIChanged=!1},onUpdateUI:function(){if($(this._input).addClass("atom-yes-no-custom-input"),this._placeholder){AtomUI.attr(this._input,"placeholder",this._placeholder);var t=n.placeHolderFixer;t&&t.refresh()}},init:function(){t.init.call(this);this._yesNo=this._yesNo.atomControl;var n=this._input;this.bindEvent(n,"change","onValueChange")}}})}(WebAtoms.AtomControl.prototype);n.appScope=n.appScope||{};this.atomApplication=null,function(i){return classCreator("WebAtoms.AtomApplication",i,function(t){var f,r,i,e,u,o;if($(t).removeClass("atom-dock-panel"),$(t).addClass("atom-application"),this._scope=new p(this,null,this),n.model&&(n.appScope.model=n.model,this._data=n.model),n.appScope){f=this._scope;i=n.appScope;for(u in i)f[u]=i[u]}if(n.appScope=this._scope,n.atomApplication=this,this.busyCount=0,r=location.hash,r=r?r.substr(1):r,r){i=AtomUI.parseUrl(r);this._hash=location.hash;e=this._scope;this._defaultHash=i;for(u in i)o=i[u],e[u]=o}else this._hash=location.hash;this._defaultScope={}},{get_title:function(){return u.title},set_title:function(n){u.title=n},get_isBusy:function(){return this.busyCount},setBusy:function(n,t){n?this.busyCount++:this.busyCount--;t!==undefined?(t||(t=""),AtomBinder.setValue(this,"busyMessage",t)):AtomBinder.setValue(this,"busyMessage","Loading...");AtomBinder.refreshValue(this,"isBusy")},updateUI:function(){i.updateUI.call(this);AtomBinder.refreshValue(this,"appWidth");AtomBinder.refreshValue(this,"appHeight");AtomBinder.refreshValue(this,"bodyWidth");AtomBinder.refreshValue(this,"bodyHeight")},onUpdateUI:function(){this._renderAsPage||i.onUpdateUI.call(this)},get_appWidth:function(){return $(this._element).width()},get_appHeight:function(){return $(this._element).height()},get_bodyWidth:function(){return $(u.body).width()},get_bodyHeight:function(){return $(u.body).height()},onHashChanged:function(){var u,i,r,f,o,n,e;if(!this._noHashRefresh){if(u=this._scope,i=location.hash,i||(i="#"),this._noHashRefresh=!0,i=i.substr(1),r=AtomUI.parseUrl(i),this._created){f=this._defaultScope;for(n in f)o=f[n],r[n]===undefined&&(r[n]=o);for(n in r)e=r[n],u[n]!=e&&AtomBinder.setValue(u,n,e)}else t.merge(u,r);this._noHashRefresh=!1}},invokeUpdateUI:function(){var i=this,t=this;n.setTimeout(function(){return t.updateUI()},5)},onRefreshValue:function(){var f,n,t,i;if(!this._noHashRefresh&&this._ready){var e=this._defaultScope,r=AtomBinder.getClone(this._defaultHash||{}),o=this._scope;for(n in o)if(t=o[n],e.hasOwnProperty(n)){if(t==e[n])continue;r[n]=t}else{if(n.indexOf("_")==0)continue;if(t===undefined||t===null)continue;if(!/string|number|boolean/i.test(typeof t))continue;r[n]=t}f=[];for(n in r)t=r[n],f.push({key:n,value:t});(i="#"+f.map(function(n){return n.key+"="+encodeURIComponent(n.value)}).join("&"),i!=location.hash)&&(i!="#"||location.hash)&&(this._noHashRefresh=!0,history&&history.pushState?history.pushState({},u.title,location.href.split("#")[0]+i):location.href=i,this._noHashRefresh=!1)}},onInitialized:function(){var t,r;this._ready=!0;i.onInitialized.call(this);this._renderAsPage||$(this._element).addClass("atom-dock-application");o.isIE&&o.majorVersion<8?(t=this,setInterval(function(){t.onCheckHash()},1e3),this._lastHash=location.hash):(r=n.onhashchange?"onhashchange":"hashchange",this.bindEvent(n,r,"onHashChanged"))},createChildren:function(){if(i.createChildren.call(this),this.getTemplate("busyTemplate"),this._busyTemplate){this._element.appendChild(this._busyTemplate);this.onCreateChildren(this._busyTemplate)}},onCreated:function(){i.onCreated.call(this);this._next&&WebAtoms.dispatcher.callLater(function(){n.atomApplication.invokeAction(n.atomApplication._next)})},onCheckHash:function(){this._lastHash!=location.hash&&(this.onHashChanged(),this._lastHash=location.hash)},onCloseCommand:function(){if(parent){var n=frameElement.atomWindow;n._value=this._value;n.onCloseCommand()}},setup:function(){this.createChildren();this.init()},init:function(){this.bindEvent(n,"resize","invokeUpdateUI");var t=this;this._onRefreshValue=st(function(){t.onRefreshValue.apply(t,arguments)});this._scope._$_watcher=this;i.init.call(this);this.closeCommand=function(){t.onCloseCommand.apply(t,arguments)}}},{renderAsPage:!1,busyMessage:"",progress:0})}(WebAtoms.AtomDockPanel.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomAutoPostForm",base:n,start:function(){},properties:{isBusy:!1,postError:null},methods:{pushPost:function(n){if(!this._isBusy){this._pushPostTimeout&&clearTimeout(this._pushPostTimeout);n||(n=1e3);var t=this;this._pushPostTimeout=setTimeout(function(){WebAtoms.dispatcher.callLater(function(){t.onSubmit()})},n)}},onSubmit:function(){var i,u;if((this._pushPostTimeout=0,!this._isBusy)&&this.isValid()&&(i=this.preparePostData(),i)&&(u=JSON.stringify(AtomBinder.getClone(i)),!this._cachedData||u!=this._cachedData)){this._cachedData=u;var n=this,f=r.getUrl(this._postUrl),t=r.json(f,null,{type:"POST",data:i}).then(n._success);t.failed(function(){n._isBusy=!1;n._postError=t.error.msg;AtomBinder.refreshValue(n,"isBusy");AtomBinder.refreshValue(n,"postError")});t.showProgress(!1);t.showError(!1);t.invoke()}},onCreated:function(){n.onCreated.apply(this,arguments);var t=this.preparePostData();t&&(this._cachedData=JSON.stringify(AtomBinder.getClone(t)))},onSuccess:function(){n.onSuccess.apply(this,arguments);this._isBusy=!1;AtomBinder.refreshValue(this,"isBusy")},onKeyUp:function(n){(this.pushPost(),n.target&&n.target.nodeName&&/textarea/gi.test(n.target.nodeName))||n.keyCode==13&&this.onSubmit()},init:function(){n.init.call(this);var t=this;this.pushPostHandler=function(){t.pushPost(1e3)};this.bindEvent(this._element,"click",this.pushPostHandler);$(this._element).find("input,select,textarea").bind("change",null,this.pushPostHandler)}}})}(WebAtoms.AtomForm.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomFormField",base:n,start:function(){this._presenters=["contentPresenter"]},properties:{error:undefined,dataType:null,label:undefined,fieldClass:undefined,required:!1,isValid:undefined,regex:null,fieldValue:undefined,field:null,requiredMessage:"Required",invalidMessage:"Invalid",fieldVisible:!0,validate:!1,isValidSet:!1},methods:{set_fieldVisible:function(n){this._fieldVisible=n;$(this._element).css("display",n?"":"none")},set_fieldClass:function(n){this._fieldClass=n;this.setLocalValue("class",n,this._element)},set_dataType:function(n){this._dataType=n;this.setup()},set_fieldValue:function(n){(this._fieldValue=n,this._validate)&&this.validate()},set_isValid:function(n){var t=this;this._isValid=n;AtomProperties.validate({value:!n,key:"valid",valueFunction:function(){return t.get_isValid()},validator:function(n){return n?"":"Invalid"},control:this,element:this._element})},set_regex:function(n){this._regex=n;this.setup()},set_required:function(n){this._required=n;this.setup()},validateChildren:function(n){for(var i=new ChildEnumerator(n),t;i.next();)t=i.current(),t.atomControl?this.validateValue(AtomBinder.getValue(t.atomControl,"value")):/input|select|textarea/gi.test(t.nodeName)?this.validateValue($(t).val()):this.validateChildren(t)},getInputErrors:function(){var t=[],i=this._element,n,r;return this._fieldValue===undefined?getInputErrors(i,!0):this._isValidSet?this._isValid?t:[{label:this.get_invalidMessage(),value:i}]:(n={},this._required&&(n["atom-required"]={msg:this.get_requiredMessage()}),this._dataType&&(n["atom-data-type"]={value:this._dataType,msg:this.get_invalidMessage()}),this._regex&&(n["atom-regex"]={value:this._regex,msg:this.get_invalidMessage()}),r=getInputError(i,n,this._fieldValue),r?(this.set_error(r.label),t.push({label:r,value:i}),this._isValid=!1):this._isValid=!0,AtomBinder.refreshValue(this,"isValid"),t.length)?t:null},clearInputErrors:function(){this._error=null;this._isValid=!0;AtomBinder.refreshValue(this,"error");AtomBinder.refreshValue(this,"isValid")},validateValue:function(v){if(this._required){if(!v){AtomBinder.setValue(this,"error",this._requiredMessage);this._isValid=!1;return}}else if(!v){this._isValid=!0;return}var re=null;if(/email/gi.test(this._dataType)?re=/^(([^<>()\[\]\\.,;:\s@\"]+(\.[^<>()\[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/:this._regex&&(re=eval("("+this._regex+")")),re&&!re.test(v)){AtomBinder.setValue(this,"error",this._invalidMessage);this._isValid=!1;return}},validate:function(){return(this._validate=!0,!(this._required||this._regex||this._dataType))?this._isValid===undefined?!0:this._isValid:this._isValid&&(AtomBinder.setValue(this,"error",""),this._isValidSet)?!0:(this._isValid=!0,this._fieldValue!==undefined?this.validateValue(this._fieldValue):this.validateChildren(this._element),this._isValid&&AtomBinder.setValue(this,"error",""),this._isValid)},onCreated:function(){this.setup()},onFocusOut:function(){this._validate=!0;this.validate()},setup:function(){var r,n,t;if(this._created){for(r=this._element,this._contentPresenter&&this._contentPresenter.appendChild(this._element.contentElement),n=new i($(r).find("input,select,textarea"));n.next();)t=n.current(),this.bindEvent(t,"blur","onFocusOut"),this.bindEvent(t,"change","onFocusOut");AtomBinder.refreshValue(this,"fieldClass")}}}})}(WebAtoms.AtomControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomFormGridLayout",base:n,start:function(){},properties:{minLabelWidth:100,cellSpacing:5,label:""},methods:{onUpdateUI:function(){AtomBinder.refreshValue(this,"controlWidth");AtomBinder.refreshValue(this,"controlHeight");n.onUpdateUI.apply(this,arguments)},get_controlWidth:function(){return $(this._element.parentNode).innerWidth()},get_controlHeight:function(){return $(this._element.parentNode).innerHeight()},createChildren:function(){var e=this._element,v,n,nt,r,s,h,y,p,o,f,w,t,c,l,a,g;for($(e).addClass("atom-form-grid"),o=$(e).children(),v=new i(o),AtomUI.removeAllChildren(e),n=u.createElement("DIV"),$(n).addClass("atom-form-grid-container"),e.appendChild(n),nt=AtomUI.attr(this._element,"atom-min-label-width"),this.getTemplate("fieldTemplate");v.next();){if(r=v.current(),s=AtomUI.attr(r,"atom-type"),s=="AtomFormRow"){for(h=u.createElement("TABLE"),n.appendChild(h),$(h).addClass("atom-form-grid-row"),y=u.createElement("TBODY"),h.appendChild(y),p=u.createElement("TR"),y.appendChild(p),o=$(r).children(),f=new i(o);f.next();)w=u.createElement("TD"),p.appendChild(w),this.createField(w,f.current());continue}if(s=="AtomFormTabControl"||s=="AtomTabControl"){t=u.createElement("ul");t.setAttribute("atom-type","AtomToggleButtonBar");c=AtomUI.assignID(t);t.setAttribute("atom-name",c);t.setAttribute("atom-show-tabs","true");l=u.createElement("li");t.appendChild(l);l.setAttribute("atom-text","{$data.label}");l.setAttribute("atom-template","itemTemplate");this.createField(n,t);for(var tt=b[c],f=new ChildEnumerator(r),k=[],d=0;f.next();)a=f.current(),$(a).remove(),a.setAttribute("style-display","[$scope."+c+".selectedIndex == "+d+" ? '' : 'none']"),g=this.createField(n,a),k.push(g),d++;tt.set_items(k);continue}this.createField(n,r)}}}})}(WebAtoms.AtomFormLayout.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomFormTab",base:n,start:function(){},methods:{}})}(WebAtoms.AtomFormGridLayout.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomFormNoLayout",base:n,start:function(){},methods:{}})}(WebAtoms.AtomForm.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomFormVerticalLayout",base:n,start:function(){},methods:{}})}(WebAtoms.AtomFormLayout.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomTableLayout",base:n,start:function(n,t,i){this._cellWidth=t;this._cellHeight=i;this._columns=n},methods:{doLayout:function(n){var u=new i($(n).children()),t,o=0,f=0,r=Math.ceil(u._array.length/this._columns)-1,e=r,s=this._columns*this._cellWidth,h=this._cellHeight*(r+1);for(n.style.position="relative",n.style.width=s+"px",n.style.height=h+"px",n.maxRows=r;u.next();)t=u.current(),t.style.position="absolute",t.style.left=o+"px",t.style.top=f+"px",t.style.width=this._cellWidth+"px",e<=0?(e=r,o+=this._cellWidth+10,f=0):(e--,f+=this._cellHeight)}}})}(WebAtoms.AtomLayout.prototype);tt=function(n){return classCreatorEx({name:"WebAtoms.AtomViewBoxLayout",base:n,start:function(){},methods:{doLayout:function(n){for(var i={width:$(n).innerWidth()+"px",height:$(n).innerHeight()+"px"},r=new ChildEnumerator(n),t;r.next();)t=r.current(),t.style.width=i.width,t.style.height=i.height,t.atomControl&&t.atomControl.updateUI()}}})}(WebAtoms.AtomLayout.prototype);tt.defaultInstance=new tt;t.confirm=function(n,t){var f={Message:n,ConfirmValue:!1,Confirm:t?!0:!1},r=u.createElement("DIV"),i;u.body.appendChild(r);i=AtomUI.createControl(r,WebAtoms.AtomWindow,f);i.set_windowWidth(380);i.set_windowHeight(120);i.set_windowTemplate(i.getTemplate("alertTemplate"));i.set_title(t?"Message":"Confirm");i.set_next(function(){i.dispose();$(r).remove();f.ConfirmValue&&t&&t()});i.refresh()};t.alert=n.__chromeCSP?function(n){t.confirm(n,null)}:function(n){alert(n)};$(u).ready(function(){var n=WebAtoms.dispatcher;n.setupControls();n.start()});$(n).unload(function(){function n(t){if(t)if(t.atomControl)t.atomControl.dispose();else for(var i=new ChildEnumerator(t);i.next();)n(i.current())}n(u.body)})}(window);
//# sourceMappingURL=atoms.min.js.map
